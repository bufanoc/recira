/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ItemList"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ItemList"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ItemList");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("nox.ext.apps.commonui.coreui._ItemSort");dojo.require("dojox.dtl.Context");dojo.declare("nox.ext.apps.commonui.coreui.ItemList",[dijit._Widget,dijit._Templated,nox.ext.apps.commonui.coreui._ItemSort],{templateString:"<span dojoAttachPoint=\"item_list\" class=\"item-list-container\"></span>\n",DTLTemplatePath:dojo.moduleUrl("nox.ext.apps.commonui.coreui","templates/ItemListDTL.html"),editableDTLTemplatePath:dojo.moduleUrl("nox.ext.apps.commonui.coreui","templates/EditableItemListDTL.html"),deleteIcon:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images/itemClose.png"),widgetsInTemplate:false,store:null,labelAttr:null,get:null,sort:null,ignoreNullValues:false,delimiter:", ",editable:false,constructor:function(_1){this.id_base=dijit.getUniqueId("ItemList");},_get_item_id:function(_2){return this.id_base+"-"+this.store.getIdentity(_2);},_get_item_value:function(_3){if(this.get!=null){var _4=this.get(_3);}else{if(this.labelAttr!=null&&this.labelAttr!=""){_4=this.store.getValue(_3,this.labelAttr,null);}else{_4=this.store.getLabel(_3);}}if(_4==null){_4=document.createTextNode((this.ignoreNullValues)?"":"?");}else{if(typeof (_4)=="number"){_4=document.createTextNode(String(_4));}}return _4;},_create_span:function(_5){var s=document.createElement("span");s.id=this._get_item_id(_5);s.appendChild(this._get_item_value(_5));return s;},_get_item_dom_node:function(_7){return dojo.byId(this._get_item_id(_7));},_get_dom_node_item:function(_8){var id=_8.id.substr(this.id_base.length+1);return this.store.fetchItemByIdentity(id);},_get_num_item_dom_nodes:function(){return this.item_list.childNodes.length;},_get_item_dom_node_idx:function(_a){return this.item_list.childNodes[_a];},_get_store:function(){return this.store;},_reset_delimiters:function(){for(var i=0;i<this._get_num_item_dom_nodes();i++){var _c=this._get_item_dom_node_idx(i);for(j=0;j<_c.childNodes.length;j++){var _d=_c.childNodes[j];if(_d.id==this.id_base+"_delimiter"){_c.removeChild(_d);}}}var b=this._get_num_item_dom_nodes()-1;for(z=0;z<b;z++){var _c=this._get_item_dom_node_idx(z);var _d=document.createElement("span");_d.id=this.id_base+"_delimiter";_d.appendChild(document.createTextNode(this.delimiter));_c.appendChild(_d);}},_onNewItem:function(_f){this._refresh();},_onItemChange:function(_10,_11,_12,_13){},_onDeleteItem:function(_14){this._refresh();},_refresh:function(){this.store.fetch({query:{},onComplete:dojo.hitch(this,function(_15){dojo.forEach(_15,function(_16){_16.displayText=this._get_item_value(_16);},this);var _17=this.editable?this.editableDTLTemplatePath:this.DTLTemplatePath;var _18=new dojox.dtl.Template(_17);var _19=new dojox.dtl.Context({items:_15,iconURL:this.deleteIcon});this.domNode.innerHTML=_18.render(_19);var i=0;var _1b=this.onDelete;dojo.query("img",this.domNode).forEach(function(_1c){var _1d=_15[i];i++;dojo.connect(_1c,"onclick",function(){_1b(_1d);});});})});},postCreate:function(){dojo.connect(this.store,"onNew",this,"_onNewItem");dojo.connect(this.store,"onSet",this,"_onItemChange");dojo.connect(this.store,"onDelete",this,"_onDeleteItem");this._refresh();},onDelete:function(_1e){}});}