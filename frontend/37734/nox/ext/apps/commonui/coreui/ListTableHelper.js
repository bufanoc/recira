/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ListTableHelper"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ListTableHelper"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ListTableHelper");dojo.require("nox.ext.apps.commonui.directory.Directories");var dmws=nox.ext.apps.commonui.directory;var coreui=nox.ext.apps.commonui.coreui;dojo.declare("nox.ext.apps.commonui.coreui.ListTableHelper",[],{filters:[],dir_boxes:[],append_params:"",constructor:function(_1){dojo.forEach(["filters","dir_boxes","append_params"],dojo.hitch(this,function(x){if(_1[x]!=null){this[x]=_1[x];}}));dojo.forEach(this.filters,dojo.hitch(this,function(f){var d=dojo.byId(f.id);if(d){dojo.connect(d,"onchange",dojo.hitch(this,function(){this.change_page(0);}));}}));var _5=dijit.byId("clear_btn");if(_5!=null){dojo.connect(_5,"onClick",dojo.hitch(this,"_clear_filter"));}dmws.Directories.datastore.update({onComplete:dojo.hitch(this,"_fill_dir_boxes")});},_fill_dir_boxes:function(){dojo.forEach(this.dir_boxes,function(db){var _7=dojo.byId(db.id);var _8="";if(_7.selectedIndex!=null){_8=_7[_7.selectedIndex].value;}_7.length=0;var _9=""==_8;_7.options[0]=new Option("","",_9);var q={};q[db.query]=true;nox.ext.apps.commonui.directory.Directories.datastore.fetch({query:q,onItem:function(x){_9=x._data.name==_8;var o=new Option(x._data.name,x._data.name,_9);_7.options[_7.length]=o;}});});},_apply_filter:function(){var _d="";dojo.forEach(this.filters,function(f){var _f=dojo.byId(f.id);if(_f&&_f.value!=""){_d+=f.urlParam+"="+encodeURIComponent(_f.value)+"&";}});_d+=this.append_params;var l=document.location;var url=l.protocol+"//"+l.host+l.pathname+"?"+_d;document.location=url;},_clear_filter:function(){dojo.forEach(this.filters,function(f){if(f.id=="filter_sort_attr"||f.id=="filter_sort_desc"){return;}var d=dojo.byId(f.id);if(d){d.value="";}});this._apply_filter();},change_page:function(_14){var _15=dojo.byId("filter_start");if(_15!=null){_15.value=""+_14;}this._apply_filter();},change_page_size:function(_16){var _17=dojo.byId("filter_count");if(_17!=null){_17.value=""+_16;}this.change_page(0);},sort_clicked:function(_18){var _19=dojo.byId("filter_sort_attr");var _1a=dojo.byId("filter_sort_desc");if(_19==null||_1a==null){return;}if(_18==_19.value){_1a.value=(_1a.value=="true")?"false":"true";}else{_1a.value="false";_19.value=_18;}this.change_page(0);}});}