/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.commonui.coreui.PrincipalGridFilter"]){dojo._hasResource["nox.ext.apps.commonui.coreui.PrincipalGridFilter"]=true;dojo.provide("nox.ext.apps.commonui.coreui.PrincipalGridFilter");dojo.require("nox.ext.apps.commonui.directory.Directories");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.Button");dojo.require("dojox.form.DropDownSelect");dojo.declare("nox.ext.apps.commonui.coreui.PrincipalGridFilter",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"noxPrincipalGridFilter\">\n<table class=\"filterTable\" style=\"float: left;\">\n\t<tbody><tr>\n\t\t<td class=\"label\">Name:</td><td class=\"filterValue\"><div dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"name\"></div></td>\n\t\t<td class=\"label\">Directory:</td><td class=\"filterValue\"><select dojoType=\"dojox.form.DropDownSelect\" dojoAttachPoint=\"directories\"></select></td>\n\t\t<td class=\"label\">Status:</td><td class=\"filterValue\"><select dojoType=\"dojox.form.DropDownSelect\" dojoAttachPoint=\"status\">\n\t\t\t<option value=\"*\"> </option>\n\t\t\t<option value=\"active\">Active</option>\n\t\t\t<option value=\"inactive\">Inactive</option>\n\t\t</select></td>\n\t</tr></tbody>\n</table>\n<button dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick: clear\" style=\"float: right;\"><img src=\"${imageBasePathStr}/clearFilterButton.png\" alt=\"Clear Filters\" /></button>\n</div>\n",imageBasePathStr:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images").toString(),widgetsInTemplate:true,grid:null,principalType:"switch",directoryStore:nox.ext.apps.commonui.directory.Directories.datastore,constructor:function(){this._wconnects=[];this.directoryStore=nox.ext.apps.commonui.directory.Directories.datastore;},postCreate:function(){this.inherited(arguments);this._fillDirectories();this._connectWidgets();this.connect(this.directoryStore,"onNew","_onNewDirectory");this.connect(this.directoryStore,"onDelete","_onDeleteDirectory");},_fillDirectories:function(){this.directories.removeOption();this.directories.addOption({value:"*",label:"",selected:true});this.directoryStore.fetch({onComplete:dojo.hitch(this,function(_1,_2){var _3="read_"+this.principalType+"_enabled";dojo.forEach(_1,function(_4){this.directories.addOption({value:_4.name,label:_4.name});},this);})});},_onNewDirectory:function(_5){this.directories.addOption({value:_5.name,label:_5.name});},_onDeleteDirectory:function(_6){this.directories.removeOption(_6.name);},_connectWidgets:function(){this._wconnects=[];this._wconnects.push(this.connect(this.name,"onChange","filter"));this._wconnects.push(this.connect(this.directories,"onChange","filter"));this._wconnects.push(this.connect(this.status,"onChange","filter"));},_disconnectWidgets:function(){dojo.forEach(this._wconnects,function(c){this.disconnect(c);},this);},clear:function(){this._disconnectWidgets();this.name.attr("value","");this.directories.attr("value","*");this.filter();this._connectWidgets();},filter:function(){var _8=this.grid.attr("query");var _9=this.name.attr("value");var _a=this.directories.attr("value");var st=this.status.attr("value");if(_9){_9="*"+_9+"*";}else{_9="*";}_8={name:_9,directoryName:_a,"status":st};this.grid.filter(_8);}});}