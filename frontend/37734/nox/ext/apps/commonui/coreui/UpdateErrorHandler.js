/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateErrorHandler"]){dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateErrorHandler"]=true;dojo.provide("nox.ext.apps.commonui.coreui.UpdateErrorHandler");dojo.require("nox.ext.apps.commonui.coreui.base");dojo.require("dojo.i18n");dojo.requireLocalization("nox.ext.apps.commonui.coreui","UpdateErrors",null,"ROOT");(function(){var _1=null;var _2=nox.ext.apps.commonui.coreui.UpdateErrorHandler;var _3=false;_2.onError=function(_4,_5){};_2.showError=function(_6,_7){_2.onError(_6,_7);_3=true;};var _8=function(_9,_a){var _b=document.location;document.location="/login?last_page="+encodeURIComponent(_b.pathname+_b.search);};_2.defaultHandlers={0:function(_c,_d){_2.showError("HTTP connection to "+document.location.host+" failed.",{header_msg:"Server is Unreachable:",hide_dismiss:true});},400:function(_e,_f){e=dojo.fromJson(_e.responseText);_2.showError(e.displayError,{header_msg:"Request Error:"});},401:_8,403:_8,404:function(_10,_11){_2.showError("The current page/resource does not exist or is inactive",{header_msg:"Page Not Found:"});},409:function(_12,_13){e=dojo.fromJson(_12.responseText);_2.showError(e.displayError,{header_msg:"Server Conflict:"});},500:function(_14,_15){e=dojo.fromJson(_14.responseText);_2.showError(e.displayError,{header_msg:"Server Error:"});},"user-dismissed-error":function(_16,_17){return false;},timeout:function(_18,_19){_2.showError("Server at "+document.location.host+" is taking too "+"long to respond.",{header_msg:"Server Timeout:",hide_dismiss:true});},cancel:function(_1a,_1b){return;}};_2.get_error_type=function(_1c){var err=null;if(_1c.dojoType!=null){err=_1c.dojoType;}else{if(_1c.status!=null){err=_1c.status;}}return err;};_2.handler=function(){var _1e=arguments[0];var err=_2.get_error_type(_1e);if(err==null){console_log("unidentified error, arguments: ",arguments);_2.showError(_1e.toString(),{header_msg:"Browser Error:",hide_retry:true});return true;}if(this.customHandlers[err]!=null){this.customHandlers[err].apply(this.scope,arguments);}else{if(_2.defaultHandlers[err]!=null){_2.defaultHandlers[err].apply(this,arguments);}else{console_log("unhandled_error: ",err.toString());_2.showError(err.toString(),{header_msg:"Browser Error:",hide_retry:true});return true;}}if(_3){_3=false;return true;}return false;};_2.create=function(_20,_21){if(_1==null){_1=dojo.i18n.getLocalization("nox.ext.apps.commonui.coreui","UpdateErrors");}var _22={scope:_20,defaultHandlers:_2.defaultHandlers,customHandlers:(_21!=null)?_21:{}};return function(){return _2.handler.apply(_22,arguments);};};_2.kwCreate=function(_23){if(_23.errorHandlers!=undefined){return _2.create(_23.scope,_23.errorHandlers);}else{if(_23.onError!=undefined){return dojo.hitch(_23.scope,_23.onError);}else{return _2.create(_23.scope,{});}}};})();}