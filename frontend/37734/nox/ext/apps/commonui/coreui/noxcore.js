/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */
dojo.provide("nox.ext.apps.commonui.coreui.noxcore");if(!dojo._hasResource["nox.ext.apps.commonui.coreui.base"]){dojo._hasResource["nox.ext.apps.commonui.coreui.base"]=true;dojo.provide("nox.ext.apps.commonui.coreui.base");(function(){var b=nox.ext.apps.commonui.coreui.base;dojo.addOnLoad(function(){dojo.query("body").style("visibility","visible");});b.swap_elem=function(_2,_3){var p=dojo.byId(_2).parentNode;b.replace_elem_child_id(p,_2,_3);};b.replace_elem_child_id=function(e,_6,_7){var c=dojo.query("> #"+_6,e)[0];if(c){c.id="";_7.id=_6;e.replaceChild(_7,c);}return c;};function _9(){var _a=dojo.byId("pagetoolbar");if(_a){dojo.query("button",_a).forEach(function(_b){dijit.byId(_b.id).attr("checked",false);});}};b.set_pagetoolbar_button=function(_c){_9();var w=dijit.byId(_c+"Button");if(w!=null){w.attr("checked",true);}};b.highlight_current_section=function(){var _e=document.location.pathname.split("/")[1];b.set_pagetoolbar_button(_e);};b.highlight_current_sidebar_link=function(){dojo.query("div#lsidebar li > a").forEach(function(a){var li=a.parentNode;var _11=encodeURIComponent(document.location.pathname+document.location.search);var _12=encodeURIComponent(a.pathname+a.search);dojo.toggleClass(li,"active",_11.match("^"+_12)!=null);});};b.update_status_msg=function(msg,_14){var _15=dojo.byId("statusMsgArea");if(_15!=undefined){dojo.style(_15,"opacity",1);_15.innerHTML="<span class='"+_14+"'>"+msg+"</span>";}};b.update_status_msg_fadeout=function(msg,_17,_18){b.update_status_msg(msg,_17);var _19=dojo.byId("statusMsgArea");if(_19!=undefined){var _1a=dojo.fadeOut({node:_19,"duration":_18});_1a.play();}};b.changeHighlightFn=function(_1b){return dojo.animateProperty({node:_1b,duration:8000,properties:{backgroundColor:{start:"#fffec9",end:"#ffffe9"}},onEnd:function(){dojo.style(_1b,"backgroundColor","");}});};b.in_array=function(v,a){for(var i=0;i<a.length;i++){if(a[i]==v){return true;}}return false;};b.diffobj=function(_1f,_20,_21,_22){var _23=typeof _1f;var _24=typeof _20;if(!(_23=="object"&&_24=="object")){throw Error("diffobj only works on objects");}if(_21==null){_21=[];}if(_22==null){_22=[];}_21.push(_1f);_22.push(_20);var _25=[];for(var p in _1f){if(!_1f.hasOwnProperty(p)){continue;}if(!_20.hasOwnProperty(p)){_25.push([p]);continue;}_23=typeof _1f[p];_24=typeof _20[p];if((_23=="object"&&_24=="object")||(_23=="array"&&_24=="array")){if((_1f[p]==null&&_20[p]!=null)||(_1f[p]!=null&&_20[p]==null)){_25.push([p]);continue;}var _27=b.in_array(_1f[p],_21);var _28=b.in_array(_20[p],_22);if(_27&&_28){continue;}else{if(!(_27||_28)){var l=b.diffobj(_1f[p],_20[p],_21,_22);for(var i=0;i<l.length;i++){l[i].unshift(p);}_25=_25.concat(l);}else{_25.push([p]);}}}else{if(_20[p]!=_1f[p]){_25.push([p]);}}}for(p in _20){if((!_20.hasOwnProperty(p))||_1f.hasOwnProperty(p)){continue;}_25.push([p]);p;}return _25;};b.equivDomTrees=function(n1,n2){if(n1!=null&&n2!=null&&n1.nodeType==n2.nodeType&&n1.nodeName==n2.nodeName){if(n1.nodeType===1){if(n1.attributes.length==n2.attributes.length&&n1.childNodes.length==n2.childNodes.length){for(var i=0;i<n1.attributes.length;i++){if(!b.equivDomTrees(n1.attributes[i],n2.attributes[i])){return false;}}for(i=0;i<n1.childNodes.length;i++){if(!b.equivDomTrees(n1.childNodes[i],n2.childNodes[i])){return false;}}}else{return false;}}else{if(n1.nodeType===3||n1.nodeType===4){return n1.data==n2.data;}else{if(n1.nodeType===2){return n1.value==n2.value;}}}return true;}else{return false;}};b.createLink=function(_2e,_2f){var a=document.createElement("a");a.href=_2e;a.appendChild(document.createTextNode(_2f));return a;};dojo.global.console_log=function(){if(console!=null&&console.log!=null){console.log.apply(console,arguments);}};b.update_page_title=function(str,_32){if(_32==null){_32=document.createTextNode(str);}document.title=dojo.byId("network_name").value+" Network "+str;var n=dojo.byId("page-title");dojo.query(n).empty();n.appendChild(_32);};b.set_nav_title=function(_34){if(_34==null||_34.length==0){return;}var _35="";var _36=document.createDocumentFragment();for(var i=0;i<_34.length-1;i++){var o=_34[i];if(o.title_text!=null){if(o.title_text!=""){_35=_35+o.title_text+" ";}}else{_35=_35+o.nav_text+" ";}if(o.nav_url!=null){var n=document.createElement("a");n.href=o.nav_url;n.appendChild(document.createTextNode(o.nav_text));}else{var n=document.createTextNode(o.nav_text);}_36.appendChild(n);_36.appendChild(document.createTextNode(" << "));}var o=_34[_34.length-1];if(o.title_text!=null){_35=_35+o.title_text;}else{_35=_35+o.nav_text;}_36.appendChild(document.createTextNode(o.nav_text));b.update_page_title(_35,_36);};b.get_url_param=function(_3a){_3a=_3a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var _3b="[\\?&]"+_3a+"=([^&#]*)";var _3c=new RegExp(_3b);var _3d=_3c.exec(window.location.href);if(_3d==null){return "";}else{return _3d[1];}};b.remove_all_children=function(_3e){while(_3e.hasChildNodes()){_3e.removeChild(_3e.childNodes[0]);}};})();}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.Search"]){dojo._hasResource["nox.ext.apps.commonui.coreui.Search"]=true;dojo.provide("nox.ext.apps.commonui.coreui.Search");dojo.declare("nox.ext.apps.commonui.coreui.Search",[dijit._Widget,dijit._Templated],{templateString:"<form class=\"noxSearch\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onreset: onReset, onsubmit: onSubmit\"\n        action=\"${action}\" method=\"${method}\">\n    <div class=\"searchInput\">\n        <img src=\"${imageBasePathStr}/searchIcon.gif\").toString()} alt=\"Filter your Search\" class=\"searchIcon\"\n            dojoAttachPoint=\"changeFilterNode\" dojoAttachEvent=\"onclick: onChangeFilter\" />\n        <input type=\"text\" name=\"${search}\" dojoAttachPoint=\"searchString\" />\n        <img src=\"${imageBasePathStr}/searchClearIcon.gif\" alt=\"Clear your Search\" class=\"searchClear\"\n            dojoAttachEvent=\"onclick: onReset\" />\n        <input type=\"hidden\" name=\"${subset}\" dojoAttachPoint=\"subsetString\" />\n    </div>\n</form>\n",imageBasePathStr:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images").toString(),widgetsInTemplate:true,search:"search",subset:"subset",action:"/Monitors/Search",method:"GET",prompt:"Search ",_fillContent:function(_3f){this._source=_3f;},startup:function(){if(this._started){return;}if(!this.dropDown){var _40=dojo.query("[widgetId]",this._source)[0];this.dropDown=dijit.byNode(_40);delete this._source;}dijit.popup.prepare(this.dropDown.domNode);this.reflectState(true);this.events=[dojo.connect(this.searchString,"onfocus",this,"onSearchFocus"),dojo.connect(this.searchString,"onblur",this,"onSearchBlur")];this.inherited(arguments);},destroyDescendants:function(){dojo.forEach(this.events,dojo.disconnect);if(this.dropDown){this.dropDown.destroyRecursive();delete this.dropDown;}this.inherited(arguments);},onBlur:function(){this._closeDropDown();this.inherited(arguments);},_toggleDropDown:function(){dijit.focus(this.changeFilterNode);if(!this.dropDown){return;}this[this._opened?"_closeDropDown":"_openDropDown"]();},_openDropDown:function(){if(this._opened){return;}this._opened=dojo.map(this.dropDown.getDescendants(),function(x){return x.checked;});dijit.popup.open({parent:this,popup:this.dropDown,around:this.changeFilterNode,orient:this.isLeftToRight()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"},onExecute:dojo.hitch(this,"onExecute"),onCancel:dojo.hitch(this,"_closeDropDown"),onClose:dojo.hitch(this,function(){this._opened=null;})});if(typeof this.dropDown.focus=="function"){this.dropDown.focus();}},_closeDropDown:function(){if(this._opened){dijit.popup.close(this.dropDown);this._opened=null;}},reflectState:function(_42){this.isEmpty=_42;if(_42){dojo.addClass(this.domNode,"empty");dojo.some(this.dropDown.getDescendants(),function(_43){if(_43.attr("checked")){this.searchString.value=this.prompt+_43.attr("label");return true;}return false;},this);}else{dojo.removeClass(this.domNode,"empty");this.searchString.value="";}},onExecute:function(){var _44=this.dropDown.getDescendants(),_45,_46=dojo.map(_44,function(_47,i){return _47.attr("checked")^this._opened[i];},this);dojo.forEach(_44,function(_49,i){_49.attr("checked",_46[i]);if(_46[i]){_45=_49.attr("label");}});this._closeDropDown();if(this.isEmpty){this.searchString.value=this.prompt+_45;}},onChangeFilter:function(){this._toggleDropDown();},onSearchFocus:function(){if(this.isEmpty){this.reflectState(false);}},onSearchBlur:function(){if(this.searchString.value){this.isEmpty=false;}else{this.reflectState(true);}},onReset:function(){this.reflectState(true);},onSubmit:function(){if(this.isEmpty){this.searchString.value="";}var _4b=this.dropDown.getDescendants(),_4c;dojo.some(_4b,function(_4d){if(_4d.attr("checked")){this.subsetString.value=_4d.attr("label");return true;}return false;},this);return true;},submit:function(){if(!(this.onSubmit()===false)){this.containerNode.submit();}}});}if(!dojo._hasResource["dijit.form.CheckBox"]){dojo._hasResource["dijit.form.CheckBox"]=true;dojo.provide("dijit.form.CheckBox");dojo.declare("dijit.form.CheckBox",dijit.form.ToggleButton,{templateString:"<div class=\"dijitReset dijitInline\" waiRole=\"presentation\"\n\t><input\n\t \t${nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdojoAttachPoint=\"focusNode\"\n\t \tdojoAttachEvent=\"onmouseover:_onMouse,onmouseout:_onMouse,onclick:_onClick\"\n/></div>\n",baseClass:"dijitCheckBox",type:"checkbox",value:"on",_setValueAttr:function(_4e){if(typeof _4e=="string"){this.value=_4e;dojo.attr(this.focusNode,"value",_4e);_4e=true;}if(this._created){this.attr("checked",_4e);}},_getValueAttr:function(){return (this.checked?this.value:false);},postMixInProperties:function(){if(this.value==""){this.value="on";}this.checkedAttrSetting=this.checked?"checked":"";this.inherited(arguments);},_fillContent:function(_4f){},reset:function(){this._hasBeenBlurred=false;this.attr("checked",this.params.checked||false);this.value=this.params.value||"on";dojo.attr(this.focusNode,"value",this.value);},_onFocus:function(){if(this.id){dojo.query("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}},_onBlur:function(){if(this.id){dojo.query("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}}});dojo.declare("dijit.form.RadioButton",dijit.form.CheckBox,{type:"radio",baseClass:"dijitRadio",_setCheckedAttr:function(_50){this.inherited(arguments);if(!this._created){return;}if(_50){var _51=this;dojo.query("INPUT[type=radio]",this.focusNode.form||dojo.doc).forEach(function(_52){if(_52.name==_51.name&&_52!=_51.focusNode&&_52.form==_51.focusNode.form){var _53=dijit.getEnclosingWidget(_52);if(_53&&_53.checked){_53.attr("checked",false);}}});}},_clicked:function(e){if(!this.checked){this.attr("checked",true);}}});}if(!dojo._hasResource["dojox.html.metrics"]){dojo._hasResource["dojox.html.metrics"]=true;dojo.provide("dojox.html.metrics");(function(){var dhm=dojox.html.metrics;dhm.getFontMeasurements=function(){var _56={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(dojo.isIE){dojo.doc.documentElement.style.fontSize="100%";}var div=dojo.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.border="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";dojo.body().appendChild(div);for(var p in _56){ds.fontSize=p;_56[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}dojo.body().removeChild(div);div=null;return _56;};var _5a=null;dhm.getCachedFontMeasurements=function(_5b){if(_5b||!_5a){_5a=dhm.getFontMeasurements();}return _5a;};var _5c=null,_5d={};dhm.getTextBox=function(_5e,_5f,_60){var m;if(!_5c){m=_5c=dojo.doc.createElement("div");m.style.position="absolute";m.style.left="-10000px";m.style.top="0";dojo.body().appendChild(m);}else{m=_5c;}m.className="";m.style.border="0";m.style.margin="0";m.style.padding="0";m.style.outline="0";if(arguments.length>1&&_5f){for(var i in _5f){if(i in _5d){continue;}m.style[i]=_5f[i];}}if(arguments.length>2&&_60){m.className=_60;}m.innerHTML=_5e;return dojo.marginBox(m);};var _63={w:16,h:16};dhm.getScrollbar=function(){return {w:_63.w,h:_63.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_64){var f=dhm._fontResizeNode=dojo.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";if(dojo.isIE){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");dojo.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};dojo.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(dojo.isIE&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});dojo.addOnLoad(function(){try{var n=dojo.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";dojo.body().appendChild(n);_63.w=n.offsetWidth-n.clientWidth;_63.h=n.offsetHeight-n.clientHeight;dojo.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in dojo.config&&!!dojo.config.fontSizeWatch){dhm.initOnFontResize();}});})();}if(!dojo._hasResource["dojox.grid.util"]){dojo._hasResource["dojox.grid.util"]=true;dojo.provide("dojox.grid.util");(function(){var dgu=dojox.grid.util;dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,_6c){var fn=ob&&ev&&ob[ev];return fn&&(_6c?fn.apply(ob,_6c):ob[ev]());};dgu.setStyleHeightPx=function(_6e,_6f){if(_6f>=0){var s=_6e.style;var v=_6f+"px";if(_6e&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_72,_73,_74,_75){var _76=(_75?_75:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=_76.length;i<l;i++){_73.connect(_72,"on"+_76[i],_74);}},dgu.removeNode=function(_79){_79=dojo.byId(_79);_79&&_79.parentNode&&_79.parentNode.removeChild(_79);return _79;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_7e,_7f,_80){if(_7e.length<=_7f){_7e[_7f]=_80;}else{_7e.splice(_7f,0,_80);}};dgu.arrayRemove=function(_81,_82){_81.splice(_82,1);};dgu.arraySwap=function(_83,inI,inJ){var _86=_83[inI];_83[inI]=_83[inJ];_83[inJ]=_86;};})();}if(!dojo._hasResource["dojox.grid._Scroller"]){dojo._hasResource["dojox.grid._Scroller"]=true;dojo.provide("dojox.grid._Scroller");(function(){var _87=function(_88){var i=0,n,p=_88.parentNode;while((n=p.childNodes[i++])){if(n==_88){return i-1;}}return -1;};var _8c=function(_8d){if(!_8d){return;}var _8e=function(inW){return inW.domNode&&dojo.isDescendant(inW.domNode,_8d,true);};var ws=dijit.registry.filter(_8e);for(var i=0,w;(w=ws[i]);i++){w.destroy();}delete ws;};var _93=function(_94){var _95=dojo.byId(_94);return (_95&&_95.tagName?_95.tagName.toLowerCase():"");};var _96=function(_97,_98){var _99=[];var i=0,n;while((n=_97.childNodes[i++])){if(_93(n)==_98){_99.push(n);}}return _99;};var _9c=function(_9d){return _96(_9d,"div");};dojo.declare("dojox.grid._Scroller",null,{constructor:function(_9e){this.setContentNodes(_9e);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_9f,_a0,_a1){switch(arguments.length){case 3:this.rowsPerPage=_a1;case 2:this.keepRows=_a0;case 1:this.rowCount=_9f;}this.defaultPageHeight=this.defaultRowHeight*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=dojo.hitch(this,"onscroll");}},_getPageCount:function(_a2,_a3){return _a2?(Math.ceil(_a2/_a3)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_a4){this.keepRows=_a4;this.keepPages=!this.keepRows?this.keepRows:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_a5){this.contentNodes=_a5;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();},updateRowCount:function(_a7){this.invalidateNodes();this.rowCount=_a7;var _a8=this.pageCount;if(_a8===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_a8){for(var i=_a8-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_a8){this.height+=this.defaultPageHeight*(this.pageCount-_a8-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_aa){return Boolean(this.getDefaultPageNode(_aa));},measurePage:function(_ab){var n=this.getDefaultPageNode(_ab);return (n&&n.innerHTML)?n.offsetHeight:0;},positionPage:function(_ad,_ae){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_ad].style.top=_ae+"px";}},repositionPages:function(_b0){var _b1=this.getDefaultNodes();var _b2=0;for(var i=0;i<this.stack.length;i++){_b2=Math.max(this.stack[i],_b2);}var n=_b1[_b0];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_b0):0);for(var p=_b0+1;p<=_b2;p++){n=_b1[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_b7){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_b7]);}},preparePage:function(_b9,_ba){var p=(_ba?this.popPage():null);for(var i=0;i<this.colCount;i++){var _bd=this.pageNodes[i];var _be=(p===null?this.createPageNode():this.invalidatePageNode(p,_bd));_be.pageIndex=_b9;_be.id=(this._pageIdPrefix||"")+"page-"+_b9;_bd[_b9]=_be;}},renderPage:function(_bf){var _c0=[];for(var i=0;i<this.colCount;i++){_c0[i]=this.pageNodes[i][_bf];}for(var i=0,j=_bf*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_c0);}},removePage:function(_c3){for(var i=0,j=_c3*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_c6){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_c6,this.pageNodes[i]);if(n){dojo.destroy(n);}}},pacify:function(_c9){},pacifying:false,pacifyTicks:200,setPacifying:function(_ca){if(this.pacifying!=_ca){this.pacifying=_ca;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _cb=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _cb;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){dojox.grid.util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}this.needPage(this.page,this.pageTop);var _cd=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _ce=this.getPageHeight(this.page);this.averageRowHeight=(_ce>0&&_cd>0)?(_ce/_cd):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _cf=this.pageCount-1;var _d0=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_cf]=_d0;return _d0;},updateContentHeight:function(_d1){this.height+=_d1;this.resize();},updatePageHeight:function(_d2){if(this.pageExists(_d2)){var oh=this.getPageHeight(_d2);var h=(this.measurePage(_d2))||(oh);this.pageHeights[_d2]=h;if((h)&&(oh!=h)){this.updateContentHeight(h-oh);this.repositionPages(_d2);}}},rowHeightChanged:function(_d5){this.updatePageHeight(Math.floor(_d5/this.rowsPerPage));},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");dojo.attr(p,"role","presentation");p.style.position="absolute";p.style[dojo._isBodyLtr()?"left":"right"]="0";return p;},getPageHeight:function(_d7){var ph=this.pageHeights[_d7];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_d9){return this.stack.push(_d9);},popPage:function(){return this.stack.shift();},findPage:function(_da){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_da){break;}}this.page=i;this.pageTop=h;},buildPage:function(_de,_df,_e0){this.preparePage(_de,_df);this.positionPage(_de,_e0);this.installPage(_de);this.renderPage(_de);this.pushPage(_de);},needPage:function(_e1,_e2){var h=this.getPageHeight(_e1),oh=h;if(!this.pageExists(_e1)){this.buildPage(_e1,this.keepPages&&(this.stack.length>=this.keepPages),_e2);h=this.measurePage(_e1)||h;this.pageHeights[_e1]=h;if(h&&(oh!=h)){this.updateContentHeight(h-oh);}}else{this.positionPage(_e1,_e2);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_e5){this.grid.scrollTop=_e5;if(this.colCount){this.startPacify();this.findPage(_e5);var h=this.height;var b=this.getScrollBottom(_e5);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_e5);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_ea){return (this.windowHeight>=0?_ea+this.windowHeight:-1);},processNodeEvent:function(e,_ec){var t=e.target;while(t&&(t!=_ec)&&t.parentNode&&(t.parentNode.parentNode!=_ec)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_ec)){return false;}var _ee=t.parentNode;e.topRowIndex=_ee.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_87(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_f0,_f1){},removeRow:function(_f2){},getDefaultPageNode:function(_f3){return this.getDefaultNodes()[_f3];},positionPageNode:function(_f4,_f5){},getPageNodePosition:function(_f6){return _f6.offsetTop;},invalidatePageNode:function(_f7,_f8){var p=_f8[_f7];if(p){delete _f8[_f7];this.removePage(_f7,p);_8c(p);p.innerHTML="";}return p;},getPageRow:function(_fa){return _fa*this.rowsPerPage;},getLastPageRow:function(_fb){return Math.min(this.rowCount,this.getPageRow(_fb+1))-1;},getFirstVisibleRow:function(_fc,_fd,_fe){if(!this.pageExists(_fc)){return 0;}var row=this.getPageRow(_fc);var _100=this.getDefaultNodes();var rows=_9c(_100[_fc]);for(var i=0,l=rows.length;i<l&&_fd<_fe;i++,row++){_fd+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_104,_105,_106){if(!this.pageExists(_104)){return 0;}var _107=this.getDefaultNodes();var row=this.getLastPageRow(_104);var rows=_9c(_107[_104]);for(var i=rows.length-1;i>=0&&_105>_106;i--,row--){_105-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_10b){var _10c=this.getDefaultNodes();var rows=_9c(_10c[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_10b){this.offset=h-(t-_10b);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_112){var _113=Math.floor(_112/this.rowsPerPage);var t=0;for(var i=0;i<_113;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.needPage(_113,this.pageTop);var _116=this.getDefaultNodes();var rows=_9c(_116[_113]);var r=_112-this.rowsPerPage*_113;for(var i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});})();}if(!dojo._hasResource["dojox.grid.cells._base"]){dojo._hasResource["dojox.grid.cells._base"]=true;dojo.provide("dojox.grid.cells._base");(function(){var _11a=function(_11b){try{dojox.grid.util.fire(_11b,"focus");dojox.grid.util.fire(_11b,"select");}catch(e){}};var _11c=function(){setTimeout(dojo.hitch.apply(dojo,arguments),0);};var dgc=dojox.grid.cells;dojo.declare("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,_valueProp:"value",_formatPending:false,constructor:function(_11e){this._props=_11e||{};dojo.mixin(this,_11e);},format:function(_11f,_120){var f,i=this.grid.edit.info,d=this.get?this.get(_11f,_120):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_11f&&i.cell==this))){return this.formatEditing(d,_11f);}else{var v=(d!=this.defaultValue&&(f=this.formatter))?f.call(this,d,_11f):d;return (typeof v=="undefined"?this.defaultValue:v);}},formatEditing:function(_125,_126){},getNode:function(_127){return this.view.getCellNode(_127,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_128){return (this.getNode(_128)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&dojo.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_12b,_12c){this.grid.edit.applyCellEdit(_12b,this,_12c);},cancelEdit:function(_12d){this.grid.doCancelEdit(_12d);},_onEditBlur:function(_12e){if(this.grid.edit.isEditCell(_12e,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_12f,_130){if(this.commitOnBlur){dojo.connect(_12f,"onblur",function(e){setTimeout(dojo.hitch(this,"_onEditBlur",_130),250);});}},needFormatNode:function(_132,_133){this._formatPending=true;_11c(this,"_formatNode",_132,_133);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_134,_135){if(this._formatPending){this._formatPending=false;dojo.setSelectable(this.grid.domNode,true);this.formatNode(this.getEditNode(_135),_134,_135);}},formatNode:function(_136,_137,_138){if(dojo.isIE){_11c(this,"focus",_138,_136);}else{this.focus(_138,_136);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_13b){return this.getEditNode(_13b)[this._valueProp];},setValue:function(_13c,_13d){var n=this.getEditNode(_13c);if(n){n[this._valueProp]=_13d;}},focus:function(_13f,_140){_11a(_140||this.getEditNode(_13f));},save:function(_141){this.value=this.value||this.getValue(_141);},restore:function(_142){this.setValue(_142,this.value);},_finish:function(_143){dojo.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_144){this.applyEdit(this.getValue(_144),_144);this._finish(_144);},cancel:function(_145){this.cancelEdit(_145);this._finish(_145);}});dgc._Base.markupFactory=function(node,_147){var d=dojo;var _149=d.trim(d.attr(node,"formatter")||"");if(_149){_147.formatter=dojo.getObject(_149);}var get=d.trim(d.attr(node,"get")||"");if(get){_147.get=dojo.getObject(get);}var _14b=function(attr){var _14d=d.trim(d.attr(node,attr)||"");return _14d?!(_14d.toLowerCase()=="false"):undefined;};_147.sortDesc=_14b("sortDesc");_147.editable=_14b("editable");_147.alwaysEditing=_14b("alwaysEditing");_147.noresize=_14b("noresize");var _14e=d.trim(d.attr(node,"loadingText")||d.attr(node,"defaultValue")||"");if(_14e){_147.defaultValue=_14e;}var _14f=function(attr){return d.trim(d.attr(node,attr)||"")||undefined;};_147.styles=_14f("styles");_147.headerStyles=_14f("headerStyles");_147.cellStyles=_14f("cellStyles");_147.classes=_14f("classes");_147.headerClasses=_14f("headerClasses");_147.cellClasses=_14f("cellClasses");};dojo.declare("dojox.grid.cells.Cell",dgc._Base,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_151,_152){this.needFormatNode(_151,_152);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_151+"\">";},formatNode:function(_153,_154,_155){this.inherited(arguments);this.registerOnBlur(_153,_155);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){dojo.stopEvent(e);}}},_finish:function(_158){this.inherited(arguments);var n=this.getEditNode(_158);try{dojox.grid.util.fire(n,"blur");}catch(e){}}});dgc.Cell.markupFactory=function(node,_15b){dgc._Base.markupFactory(node,_15b);var d=dojo;var _15d=d.trim(d.attr(node,"keyFilter")||"");if(_15d){_15b.keyFilter=new RegExp(_15d);}};dojo.declare("dojox.grid.cells.RowIndex",dgc.Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_15e){return _15e+1;}});dgc.RowIndex.markupFactory=function(node,_160){dgc.Cell.markupFactory(node,_160);};dojo.declare("dojox.grid.cells.Select",dgc.Cell,{options:null,values:null,returnIndex:-1,constructor:function(_161){this.values=this.values||this.options;},formatEditing:function(_162,_163){this.needFormatNode(_162,_163);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){h.push("<option",(_162==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},getValue:function(_168){var n=this.getEditNode(_168);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});dgc.Select.markupFactory=function(node,cell){dgc.Cell.markupFactory(node,cell);var d=dojo;var _16f=d.trim(d.attr(node,"options")||"");if(_16f){var o=_16f.split(",");if(o[0]!=_16f){cell.options=o;}}var _171=d.trim(d.attr(node,"values")||"");if(_171){var v=_171.split(",");if(v[0]!=_171){cell.values=v;}}};dojo.declare("dojox.grid.cells.AlwaysEdit",dgc.Cell,{alwaysEditing:true,_formatNode:function(_173,_174){this.formatNode(this.getEditNode(_174),_173,_174);},applyStaticValue:function(_175){var e=this.grid.edit;e.applyCellEdit(this.getValue(_175),this,_175);e.start(this,_175,true);}});dgc.AlwaysEdit.markupFactory=function(node,cell){dgc.Cell.markupFactory(node,cell);};dojo.declare("dojox.grid.cells.Bool",dgc.AlwaysEdit,{_valueProp:"checked",formatEditing:function(_179,_17a){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_179?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});dgc.Bool.markupFactory=function(node,cell){dgc.AlwaysEdit.markupFactory(node,cell);};})();}if(!dojo._hasResource["dojox.grid.cells"]){dojo._hasResource["dojox.grid.cells"]=true;dojo.provide("dojox.grid.cells");}if(!dojo._hasResource["dojo.dnd.common"]){dojo._hasResource["dojo.dnd.common"]=true;dojo.provide("dojo.dnd.common");dojo.dnd._isMac=navigator.appVersion.indexOf("Macintosh")>=0;dojo.dnd._copyKey=dojo.dnd._isMac?"metaKey":"ctrlKey";dojo.dnd.getCopyKeyState=function(e){return e[dojo.dnd._copyKey];};dojo.dnd._uniqueId=0;dojo.dnd.getUniqueId=function(){var id;do{id=dojo._scopeName+"Unique"+(++dojo.dnd._uniqueId);}while(dojo.byId(id));return id;};dojo.dnd._empty={};dojo.dnd.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};dojo.dnd._lmb=dojo.isIE?1:0;dojo.dnd._isLmbPressed=dojo.isIE?function(e){return e.button&1;}:function(e){return e.button===0;};}if(!dojo._hasResource["dojo.dnd.autoscroll"]){dojo._hasResource["dojo.dnd.autoscroll"]=true;dojo.provide("dojo.dnd.autoscroll");dojo.dnd.getViewport=function(){var d=dojo.doc,dd=d.documentElement,w=window,b=dojo.body();if(dojo.isMozilla){return {w:dd.clientWidth,h:w.innerHeight};}else{if(!dojo.isOpera&&w.innerWidth){return {w:w.innerWidth,h:w.innerHeight};}else{if(!dojo.isOpera&&dd&&dd.clientWidth){return {w:dd.clientWidth,h:dd.clientHeight};}else{if(b.clientWidth){return {w:b.clientWidth,h:b.clientHeight};}}}}return null;};dojo.dnd.V_TRIGGER_AUTOSCROLL=32;dojo.dnd.H_TRIGGER_AUTOSCROLL=32;dojo.dnd.V_AUTOSCROLL_VALUE=16;dojo.dnd.H_AUTOSCROLL_VALUE=16;dojo.dnd.autoScroll=function(e){var v=dojo.dnd.getViewport(),dx=0,dy=0;if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=-dojo.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=dojo.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=-dojo.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=dojo.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};dojo.dnd._validNodes={"div":1,"p":1,"td":1};dojo.dnd._validOverflow={"auto":1,"scroll":1};dojo.dnd.autoScrollNodes=function(e){for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){var s=dojo.getComputedStyle(n);if(s.overflow.toLowerCase() in dojo.dnd._validOverflow){var b=dojo._getContentBox(n,s),t=dojo._abs(n,true);var w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2),h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2),rx=e.pageX-t.x,ry=e.pageY-t.y,dx=0,dy=0;if(dojo.isWebKit||dojo.isOpera){rx+=dojo.body().scrollLeft,ry+=dojo.body().scrollTop;}if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}}if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}}var _197=n.scrollLeft,_198=n.scrollTop;n.scrollLeft=n.scrollLeft+dx;n.scrollTop=n.scrollTop+dy;if(_197!=n.scrollLeft||_198!=n.scrollTop){return;}}}try{n=n.parentNode;}catch(x){n=null;}}dojo.dnd.autoScroll(e);};}if(!dojo._hasResource["dojo.dnd.Mover"]){dojo._hasResource["dojo.dnd.Mover"]=true;dojo.provide("dojo.dnd.Mover");dojo.declare("dojo.dnd.Mover",null,{constructor:function(node,e,host){this.node=dojo.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=this.host=host,d=node.ownerDocument,_19e=dojo.connect(d,"onmousemove",this,"onFirstMove");this.events=[dojo.connect(d,"onmousemove",this,"onMouseMove"),dojo.connect(d,"onmouseup",this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent),_19e];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY});dojo.stopEvent(e);},onMouseUp:function(e){if(dojo.isWebKit&&dojo.dnd._isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}dojo.stopEvent(e);},onFirstMove:function(){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left));t=Math.round(parseFloat(s.top));break;default:s.position="absolute";var m=dojo.marginBox(this.node);var b=dojo.doc.body;var bs=dojo.getComputedStyle(b);var bm=dojo._getMarginBox(b,bs);var bc=dojo._getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this);}dojo.disconnect(this.events.pop());},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});}if(!dojo._hasResource["dojo.dnd.Moveable"]){dojo._hasResource["dojo.dnd.Moveable"]=true;dojo.provide("dojo.dnd.Moveable");dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:false,constructor:function(node,_1ad){this.node=dojo.byId(node);if(!_1ad){_1ad={};}this.handle=_1ad.handle?dojo.byId(_1ad.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_1ad.delay>0?_1ad.delay:0;this.skip=_1ad.skip;this.mover=_1ad.mover?_1ad.mover:dojo.dnd.Mover;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];},markupFactory:function(_1ae,node){return new dojo.dnd.Moveable(node,_1ae);},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dojo.dnd.isFormElement(e)){return;}if(this.delay){this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove"),dojo.connect(this.handle,"onmouseup",this,"onMouseUp"));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}dojo.stopEvent(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}dojo.stopEvent(e);},onMouseUp:function(e){for(var i=0;i<2;++i){dojo.disconnect(this.events.pop());}dojo.stopEvent(e);},onSelectStart:function(e){if(!this.skip||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_1b6){dojo.publish("/dnd/move/start",[_1b6]);dojo.addClass(dojo.body(),"dojoMove");dojo.addClass(this.node,"dojoMoveItem");},onMoveStop:function(_1b7){dojo.publish("/dnd/move/stop",[_1b7]);dojo.removeClass(dojo.body(),"dojoMove");dojo.removeClass(this.node,"dojoMoveItem");},onFirstMove:function(_1b8){},onMove:function(_1b9,_1ba){this.onMoving(_1b9,_1ba);var s=_1b9.node.style;s.left=_1ba.l+"px";s.top=_1ba.t+"px";this.onMoved(_1b9,_1ba);},onMoving:function(_1bc,_1bd){},onMoved:function(_1be,_1bf){}});}if(!dojo._hasResource["dojox.grid._Builder"]){dojo._hasResource["dojox.grid._Builder"]=true;dojo.provide("dojox.grid._Builder");(function(){var dg=dojox.grid;var _1c1=function(td){return td.cellIndex>=0?td.cellIndex:dojo.indexOf(td.parentNode.cells,td);};var _1c3=function(tr){return tr.rowIndex>=0?tr.rowIndex:dojo.indexOf(tr.parentNode.childNodes,tr);};var _1c5=function(_1c6,_1c7){return _1c6&&((_1c6.rows||0)[_1c7]||_1c6.childNodes[_1c7]);};var _1c8=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _1cb=function(_1cc,_1cd){for(var n=_1cc;n&&_1cd(n);n=n.parentNode){}return n;};var _1cf=function(_1d0){var name=_1d0.toUpperCase();return function(node){return node.tagName!=name;};};var _1d3=dojox.grid.util.rowIndexTag;var _1d4=dojox.grid.util.gridViewTag;dg._Builder=dojo.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\""+(dojo.isFF<3?"wairole:":"")+"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_1d7,_1d8,_1d9,_1da){var _1db=[],html;var _1dd=dojo.isFF<3?"wairole:":"";if(_1da){var _1de=_1d7.index!=_1d7.grid.getSortIndex()?"":_1d7.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";html=["<th tabIndex=\"-1\" role=\"",_1dd,"columnheader\"",_1de];}else{html=["<td tabIndex=\"-1\" role=\"",_1dd,"gridcell\""];}_1d7.colSpan&&html.push(" colspan=\"",_1d7.colSpan,"\"");_1d7.rowSpan&&html.push(" rowspan=\"",_1d7.rowSpan,"\"");html.push(" class=\"dojoxGridCell ");_1d7.classes&&html.push(_1d7.classes," ");_1d9&&html.push(_1d9," ");_1db.push(html.join(""));_1db.push("");html=["\" idx=\"",_1d7.index,"\" style=\""];if(_1d8&&_1d8[_1d8.length-1]!=";"){_1d8+=";";}html.push(_1d7.styles,_1d8||"",_1d7.hidden?"display:none;":"");_1d7.unitWidth&&html.push("width:",_1d7.unitWidth,";");_1db.push(html.join(""));_1db.push("");html=["\""];_1d7.attrs&&html.push(" ",_1d7.attrs);html.push(">");_1db.push(html.join(""));_1db.push("");_1db.push(_1da?"</th>":"</td>");return _1db;},isCellNode:function(_1df){return Boolean(_1df&&_1df!=dojo.doc&&dojo.attr(_1df,"idx"));},getCellNodeIndex:function(_1e0){return _1e0?Number(dojo.attr(_1e0,"idx")):-1;},getCellNode:function(_1e1,_1e2){for(var i=0,row;row=_1c5(_1e1.firstChild,i);i++){for(var j=0,cell;cell=row.cells[j];j++){if(this.getCellNodeIndex(cell)==_1e2){return cell;}}}},findCellTarget:function(_1e7,_1e8){var n=_1e7;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_1d4 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_1d4]!=this.view.id))&&(n!=_1e8)){n=n.parentNode;}return n!=_1e8?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_1eb,_1ec){var n=_1eb;while(n&&(n!=this.domNode)&&(!(_1ec in n)||(_1d4 in n&&n[_1d4]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_1ee){return this.findTarget(_1ee,_1d3);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&dojo.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});dg._ContentBuilder=dojo.extend(function(view){dg._Builder.call(this,view);},dg._Builder.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _1f7=this.grid.get,_1f8=this.view.structure.cells;for(var j=0,row;(row=_1f8[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_1f7;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);}}},generateHtml:function(_1fd,_1fe){var html=this.getTableArray(),v=this.view,_201=v.structure.cells,item=this.grid.getItem(_1fe);dojox.grid.util.fire(this.view,"onBeforeRow",[_1fe,_201]);for(var j=0,row;(row=_201[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup,cc=cell.customClasses=[],cs=cell.customStyles=[];m[5]=cell.format(_1fe,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_1d3];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});dg._HeaderBuilder=dojo.extend(function(view){this.moveable=null;dg._Builder.call(this,view);},dg._Builder.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_20c,_20d){var html=this.getTableArray(),_20f=this.view.structure.cells;dojox.grid.util.fire(this.view,"onBeforeRow",[-1,_20f]);for(var j=0,row;(row=_20f[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_214;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_214=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_214[5]=(_20d!=undefined?_20d:_20c(cell));_214[3]=cell.customStyles.join(";");_214[1]=cell.customClasses.join(" ");html.push(_214.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var x=e.layerX;if(dojo.isMoz){var n=_1cb(e.target,_1cf("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!dojo._isBodyLtr()&&e.sourceView.headerNode.scrollLeft<t){x-=t;}}var n=_1cb(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=_1c1(e.cellNode);e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(dojo.isIE){var tN=e.target;if(dojo.hasClass(tN,"dojoxGridArrowButtonNode")||dojo.hasClass(tN,"dojoxGridArrowButtonChar")){return false;}}if(dojo._isBodyLtr()){return (e.cellIndex>0)&&(e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(dojo.isIE){var tN=e.target;if(dojo.hasClass(tN,"dojoxGridArrowButtonNode")||dojo.hasClass(tN,"dojoxGridArrowButtonChar")){return false;}}if(dojo._isBodyLtr()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"e-resize":(this.overLeftResizeArea(e)?"w-resize":""));if(c&&!this.canResize(e)){c="not-allowed";}if(dojo.isIE){var t=e.sourceView.headerNode.scrollLeft;e.sourceView.headerNode.style.cursor=c||"";e.sourceView.headerNode.scrollLeft=t;}else{e.sourceView.headerNode.style.cursor=c||"";}if(c){dojo.stopEvent(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){dojo.stopEvent(e);return true;}},beginColumnResize:function(e){this.moverDiv=document.createElement("div");dojo.style(this.moverDiv,{position:"absolute",left:0});dojo.body().appendChild(this.moverDiv);var m=this.moveable=new dojo.dnd.Moveable(this.moverDiv);var _22b=[],_22c=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_22c[i]);i++){_22b.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=dojo._isBodyLtr()?1:-1;var _231=e.grid.views.views;var _232=[];for(var i=view.idx+adj,_233;(_233=_231[i]);i=i+adj){_232.push({node:_233.headerNode,left:window.parseInt(_233.headerNode.style.left)});}var _234=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:dojo.contentBox(e.cellNode).w,vw:dojo.contentBox(view.headerNode).w,table:_234,tw:dojo.contentBox(_234).w,spanners:_22b,followers:_232};m.onMove=dojo.hitch(this,"doResizeColumn",drag);dojo.connect(m,"onMoveStop",dojo.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;}));view.convertColPctToFixed();if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_236,_237,_238){var _239=dojo._isBodyLtr();var _23a=_239?_238.l:-_238.l;var w=_236.w+_23a;var vw=_236.vw+_23a;var tw=_236.tw+_23a;if(w>=this.minColWidth){for(var i=0,s,sw;(s=_236.spanners[i]);i++){sw=s.width+_23a;s.node.style.width=sw+"px";_236.view.setColWidth(s.index,sw);}for(var i=0,f,fl;(f=_236.followers[i]);i++){fl=f.left+_23a;f.node.style.left=fl+"px";}_236.node.style.width=w+"px";_236.view.setColWidth(_236.index,w);_236.view.headerNode.style.width=vw+"px";_236.view.setColumnsWidth(tw);if(!_239){_236.view.headerNode.scrollLeft=_236.scrollLeft+_23a;}}if(_236.view.flexCells&&!_236.view.testFlexCells()){var t=_1c8(_236.node);t&&(t.style.width="");}},endResizeColumn:function(_244){dojo.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;var conn=dojo.connect(_244.view,"update",this,function(){dojo.disconnect(conn);this._skipBogusClicks=false;});setTimeout(dojo.hitch(_244.view,"update"),50);}});dg._TableMap=dojo.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_247){var _248=_247.length;if(!_248){return;}this.map=[];for(var j=0,row;(row=_247[j]);j++){this.map[j]=[];}for(var j=0,row;(row=_247[j]);j++){for(var i=0,x=0,cell,_24e,_24f;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_24f=cell.rowSpan||1;_24e=cell.colSpan||1;for(var y=0;y<_24f;y++){for(var s=0;s<_24e;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_24e;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_257,_258){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_258&&cell.r==_257){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_25d,_25e,_25f){var row=_25d&&_25d.rows[_25e];return row&&row.cells[_25f];},_findOverlappingNodes:function(_261,_262,_263){var _264=[];var m=this.getMapCoords(_262,_263);var row=this.map[m.j];for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_261,rw.r,rw.c):null);if(n){_264.push(n);}}return _264;},findOverlappingNodes:function(_26a){return this._findOverlappingNodes(_1c8(_26a),_1c3(_26a.parentNode),_1c1(_26a));}});})();}if(!dojo._hasResource["dojo.dnd.Container"]){dojo._hasResource["dojo.dnd.Container"]=true;dojo.provide("dojo.dnd.Container");dojo.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(node,_26c){this.node=dojo.byId(node);if(!_26c){_26c={};}this.creator=_26c.creator||null;this.skipForm=_26c.skipForm;this.parent=_26c.dropParent&&dojo.byId(_26c.dropParent);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");if(!(_26c&&_26c._skipStartup)){this.startup();}this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||dojo.global;var m=this.map,e=dojo.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dojo.dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_27c,_27d){if(!this.parent.firstChild){_27d=null;}else{if(_27c){if(!_27d){_27d=this.parent.firstChild;}}else{if(_27d){_27d=_27d.nextSibling;}}}if(_27d){for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_27d);}}else{for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_280,node){_280._skipStartup=true;return new dojo.dnd.Container(node,_280);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_289){var _28a="dojoDnd"+type;var _28b=type.toLowerCase()+"State";dojo.removeClass(this.node,_28a+this[_28b]);dojo.addClass(this.node,_28a+_289);this[_28b]=_289;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _292=node.parentNode;_292;node=_292,_292=node.parentNode){if(_292==this.parent&&dojo.hasClass(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!dojo.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dojo.dnd.getUniqueId();}dojo.addClass(t.node,"dojoDndItem");return t;}});dojo.dnd._createNode=function(tag){if(!tag){return dojo.dnd._createSpan;}return function(text){return dojo.create(tag,{innerHTML:text});};};dojo.dnd._createTrTd=function(text){var tr=dojo.create("tr");dojo.create("td",{innerHTML:text},tr);return tr;};dojo.dnd._createSpan=function(text){return dojo.create("span",{innerHTML:text});};dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dojo.dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);return function(item,hint){var _2a0=item&&dojo.isObject(item),data,type,n;if(_2a0&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_2a0&&item.data)?item.data:item;type=(_2a0&&item.type)?item.type:["text"];n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));}n.id=dojo.dnd.getUniqueId();return {node:n,data:data,type:type};};};}if(!dojo._hasResource["dojo.dnd.Selector"]){dojo._hasResource["dojo.dnd.Selector"]=true;dojo.provide("dojo.dnd.Selector");dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_2a5){if(!_2a5){_2a5={};}this.singular=_2a5.singular;this.autoSync=_2a5.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new dojo.NodeList();var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dojo.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dojo.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dojo.byId(i);this.delItem(i);dojo.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||dojo.global;var s=this.selection,e=dojo.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){dojo.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}dojo.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_2b7,data,_2b9,_2ba){var _2bb=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_2bb.call(this,item,hint);if(_2b7){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};dojo.dnd.Selector.superclass.insertNodes.call(this,data,_2b9,_2ba);this._normalizedCreator=_2bb;return this;},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},markupFactory:function(_2bf,node){_2bf._skipStartup=true;return new dojo.dnd.Selector(node,_2bf);},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dojo.dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===dojo.dnd._lmb){dojo.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!dojo.dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dojo.dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dojo.dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}dojo.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dojo.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});}if(!dojo._hasResource["dojo.dnd.Avatar"]){dojo._hasResource["dojo.dnd.Avatar"]=true;dojo.provide("dojo.dnd.Avatar");dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_2ca){this.manager=_2ca;this.construct();},construct:function(){var a=dojo.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),b=dojo.create("tbody",null,a),tr=dojo.create("tr",null,b),td=dojo.create("td",{innerHTML:this._generateText()},tr),k=Math.min(5,this.manager.nodes.length),i=0,_2d1=this.manager.source,node;dojo.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_2d1.creator){node=_2d1._normalizedCreator(_2d1.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _2d3=dojo.create("table"),_2d4=dojo.create("tbody",null,_2d3);_2d4.appendChild(node);node=_2d3;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){dojo.destroy(this.node);this.node=false;},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");dojo.query("tr.dojoDndAvatarHeader td",this.node).forEach(function(node){node.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});}if(!dojo._hasResource["dojo.dnd.Manager"]){dojo._hasResource["dojo.dnd.Manager"]=true;dojo.provide("dojo.dnd.Manager");dojo.declare("dojo.dnd.Manager",null,{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_2d6){if(this.avatar){this.target=(_2d6&&_2d6.targetState!="Disabled")?_2d6:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_2d6]);},outSource:function(_2d7){if(this.avatar){if(this.target==_2d7){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_2d8,_2d9,copy){this.source=_2d8;this.nodes=_2d9;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_2d8,_2d9,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _2dd=Boolean(this.target&&flag);if(this.canDropFlag!=_2dd){this.canDropFlag=_2dd;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),"dojoDndCopy");dojo.removeClass(dojo.body(),"dojoDndMove");dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new dojo.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e))),_2e4=[this.source,this.nodes,copy,this.target];dojo.publish("/dnd/drop/before",_2e4);dojo.publish("/dnd/drop",_2e4);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.removeClass(dojo.body(),"dojoDnd"+(this.copy?"Move":"Copy"));dojo.addClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new dojo.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["dojo.dnd.Source"]){dojo._hasResource["dojo.dnd.Source"]=true;dojo.provide("dojo.dnd.Source");dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],constructor:function(node,_2eb){dojo.mixin(this,dojo.mixin({},_2eb));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){dojo.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){dojo.addClass(this.node,"dojoDndTarget");}if(this.horizontal){dojo.addClass(this.node,"dojoDndHorizontal");}this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_2ee,_2ef){if(this==_2ee){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_2ef.length;++i){var type=_2ee.getItem(_2ef[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_2f4,self){if(_2f4){return true;}if(arguments.length<2){self=this==dojo.dnd.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this);dojo.forEach(this.topics,dojo.unsubscribe);this.targetAnchor=null;},markupFactory:function(_2f6,node){_2f6._skipStartup=true;return new dojo.dnd.Source(node,_2f6);},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=dojo.dnd.manager();if(this.isDragging){var _2fa=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox={xy:dojo.coords(this.current,true),w:this.current.offsetWidth,h:this.current.offsetHeight};}if(this.horizontal){_2fa=(e.pageX-this.targetBox.xy.x)<(this.targetBox.w/2);}else{_2fa=(e.pageY-this.targetBox.xy.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_2fa!=this.before){this._markTargetAnchor(_2fa);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}else{if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _2fb=this.getSelectedNodes();if(_2fb.length){m.startDrag(this,_2fb,this.copyState(dojo.dnd.getCopyKeyState(e),true));}}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;dojo.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;dojo.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_2fe){if(this!=_2fe){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=dojo.dnd.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_300,_301,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_300?(copy?"Copied":"Moved"):"");}var _303=this.accept&&this.checkAcceptance(_300,_301);this._changeState("Target",_303?"":"Disabled");if(this==_300){dojo.dnd.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_304,_305,copy,_307){if(this==_307){this.onDrop(_304,_305,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_308,_309,copy){if(this!=_308){this.onDropExternal(_308,_309,copy);}else{this.onDropInternal(_309,copy);}},onDropExternal:function(_30b,_30c,copy){var _30e=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _30e.call(this,_30b.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node,hint){var t=_30b.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node,hint){var t=_30b.getItem(node.id);_30b.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_30b.selectNone();}this.insertNodes(true,_30c,this.before,this.current);if(!copy&&this.creator){_30b.deleteSelectedNodes();}this._normalizedCreator=_30e;},onDropInternal:function(_318,copy){var _31a=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _31a.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_318,this.before,this.current);this._normalizedCreator=_31a;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this);dojo.dnd.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this);dojo.dnd.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_324){if(this.current==this.targetAnchor&&this.before==_324){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_324;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(!dojo.dnd._isLmbPressed(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(dojo.hasClass(node,"dojoDndHandle")){return true;}if(dojo.hasClass(node,"dojoDndItem")){break;}}return false;}});dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(node,_329){this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},markupFactory:function(_32a,node){_32a._skipStartup=true;return new dojo.dnd.Target(node,_32a);}});dojo.declare("dojo.dnd.AutoSource",dojo.dnd.Source,{constructor:function(node,_32d){this.autoSync=true;},markupFactory:function(_32e,node){_32e._skipStartup=true;return new dojo.dnd.AutoSource(node,_32e);}});}if(!dojo._hasResource["dojox.grid._View"]){dojo._hasResource["dojox.grid._View"]=true;dojo.provide("dojox.grid._View");(function(){var _330=function(_331,_332){return _331.style.cssText==undefined?_331.getAttribute("style"):_331.style.cssText;};dojo.declare("dojox.grid._View",[dijit._Widget,dijit._Templated],{defaultWidth:"18em",viewWidth:"",templateString:"<div class=\"dojoxGridView\" wairole=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" wairole=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" wairole=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" wairole=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" wairole=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" wairole=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" wairole=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" wairole=\"presentation\"></div>\n\t</div>\n</div>\n",themeable:false,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,postMixInProperties:function(){this.rowNodes=[];},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");dojox.grid.util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);dojox.grid.util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new dojox.grid._ContentBuilder(this);this.header=new dojox.grid._HeaderBuilder(this);if(!dojo._isBodyLtr()){this.headerNodeContainer.style.width="";}},destroy:function(){dojo.destroy(this.headerNode);delete this.headerNode;dojo.forEach(this.rowNodes,dojo.destroy);this.rowNodes=[];if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(dojo.isWebKit||dojo.isOpera){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_333){var vs=(this.structure=_333);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this.onBeforeRow=vs.onBeforeRow;this.onAfterRow=vs.onAfterRow;this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _339=this.hasVScrollbar();var _33a=dojo.style(this.scrollboxNode,"overflow");if(this.noscroll||!_33a||_33a=="hidden"){_339=false;}else{if(_33a=="scroll"){_339=true;}}return (_339?dojox.html.metrics.getScrollbar().w:0);},getColumnsWidth:function(){return this.headerContentNode.firstChild.offsetWidth;},setColumnsWidth:function(_33b){this.headerContentNode.firstChild.style.width=_33b+"px";if(this.viewWidth){this.viewWidth=_33b+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,dojo._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _33c=this.grid.layout.cells;var _33d=dojo.hitch(this,function(node,_33f){var inc=_33f?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_33c[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_33c[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}this.source=new dojo.dnd.Source(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,onMouseDown:dojo.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(dojo.isIE?1:0)){dojo.dnd.Source.prototype.onMouseDown.call(this.source,e);}}}),_markTargetAnchor:dojo.hitch(this,function(_344){var src=this.source;if(src.current==src.targetAnchor&&src.before==_344){return;}if(src.targetAnchor&&_33d(src.targetAnchor,src.before)){src._removeItemClass(_33d(src.targetAnchor,src.before),src.before?"After":"Before");}dojo.dnd.Source.prototype._markTargetAnchor.call(src,_344);if(src.targetAnchor&&_33d(src.targetAnchor,src.before)){src._addItemClass(_33d(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:dojo.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_33d(src.targetAnchor,src.before)){src._removeItemClass(_33d(src.targetAnchor,src.before),src.before?"After":"Before");}dojo.dnd.Source.prototype._unmarkTargetAnchor.call(src);}),destroy:dojo.hitch(this,function(){dojo.disconnect(this._source_conn);dojo.unsubscribe(this._source_sub);dojo.dnd.Source.prototype.destroy.call(this.source);})});this._source_conn=dojo.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=dojo.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_onDndDropBefore:function(_347,_348,copy){if(dojo.dnd.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _34a=this.grid.views.views;var _34b=_34a[_347.viewIndex];var _34c=_34a[this.index];if(_34c!=_34b){var s=_34b.convertColPctToFixed();var t=_34c.convertColPctToFixed();if(s||t){setTimeout(function(){_34b.update();_34c.update();},50);}}},_onDndDrop:function(_34f,_350,copy){if(dojo.dnd.manager().target!==this.source){if(dojo.dnd.manager().source===this.source){this._removingColumn=true;}return;}var _352=function(n){return n?dojo.attr(n,"idx"):null;};var w=dojo.marginBox(_350[0]).w;if(_34f.viewIndex!==this.index){var _355=this.grid.views.views;var _356=_355[_34f.viewIndex];var _357=_355[this.index];if(_356.viewWidth&&_356.viewWidth!="auto"){_356.setColumnsWidth(_356.getColumnsWidth()-w);}if(_357.viewWidth&&_357.viewWidth!="auto"){_357.setColumnsWidth(_357.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;var _35a=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;window.setTimeout(function(){_35a.moveColumn(_34f.viewIndex,idx,_352(_350[0]),_352(stn),stb);},1);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}dojox.grid.util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_35c){var n=_35c.name||_35c.grid.getCellName(_35c);var ret=["<div class=\"dojoxGridSortNode"];if(_35c.index!=_35c.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_35c.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_35c.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\""+(dojo.isFF<3?"wairole:":"")+"presentation\"></div>"]);}ret=ret.concat([n,"</div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_35f){if(this._hasHScroll==undefined||_35f){if(this.noscroll){this._hasHScroll=false;}else{var _360=dojo.style(this.scrollboxNode,"overflow");if(_360=="hidden"){this._hasHScroll=false;}else{if(_360=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth<this.contentNode.offsetWidth);}}}}return this._hasHScroll;},hasVScrollbar:function(_361){if(this._hasVScroll==undefined||_361){if(this.noscroll){this._hasVScroll=false;}else{var _362=dojo.style(this.scrollboxNode,"overflow");if(_362=="hidden"){this._hasVScroll=false;}else{if(_362=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.offsetHeight<this.contentNode.offsetHeight);}}}}return this._hasVScroll;},convertColPctToFixed:function(){var _363=false;var _364=dojo.query("th",this.headerContentNode);var _365=dojo.map(_364,function(c,vIdx){var w=c.style.width;dojo.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_363=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return dojo.contentBox(c).w;});if(_363){dojo.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _36b=cell.view.getHeaderCellNode(cell.index);if(_36b&&dojo.hasAttr(_36b,"vIdx")){var vIdx=window.parseInt(dojo.attr(_36b,"vIdx"));this.setColWidth(idx,_365[vIdx]);_364[vIdx].style.width=cell.unitWidth;dojo.removeAttr(_36b,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_36d){if(!this.grid._autoHeight){var h=this.domNode.clientHeight;if(_36d){h-=dojox.html.metrics.getScrollbar().h;}dojox.grid.util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_375){var _376=this.createRowNode(_375);this.buildRow(_375,_376);this.grid.edit.restore(this,_375);if(this._pendingUpdate){window.clearTimeout(this._pendingUpdate);}this._pendingUpdate=window.setTimeout(dojo.hitch(this,function(){window.clearTimeout(this._pendingUpdate);delete this._pendingUpdate;this.grid._resize();}),50);return _376;},createRowNode:function(_377){var node=document.createElement("div");node.className=this.classTag+"Row";dojo.attr(node,"role","row");node[dojox.grid.util.gridViewTag]=this.id;node[dojox.grid.util.rowIndexTag]=_377;this.rowNodes[_377]=node;return node;},buildRow:function(_379,_37a){this.buildRowContent(_379,_37a);this.styleRow(_379,_37a);},buildRowContent:function(_37b,_37c){_37c.innerHTML=this.content.generateHtml(_37b,_37b);if(this.flexCells&&this.contentWidth){_37c.firstChild.style.width=this.contentWidth;}dojox.grid.util.fire(this,"onAfterRow",[_37b,this.structure.cells,_37c]);},rowRemoved:function(_37d){this.grid.edit.save(this,_37d);delete this.rowNodes[_37d];},getRowNode:function(_37e){return this.rowNodes[_37e];},getCellNode:function(_37f,_380){var row=this.getRowNode(_37f);if(row){return this.content.getCellNode(row,_380);}},getHeaderCellNode:function(_382){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_382);}},styleRow:function(_383,_384){_384._style=_330(_384);this.styleRowNode(_383,_384);},styleRowNode:function(_385,_386){if(_386){this.doStyleRowNode(_385,_386);}},doStyleRowNode:function(_387,_388){this.grid.styleRowNode(_387,_388);},updateRow:function(_389){var _38a=this.getRowNode(_389);if(_38a){_38a.style.height="";this.buildRow(_389,_38a);}return _38a;},updateRowStyles:function(_38b){this.styleRowNode(_38b,this.getRowNode(_38b));},lastTop:0,firstScroll:0,doscroll:function(_38c){var _38d=dojo._isBodyLtr();if(this.firstScroll<2){if((!_38d&&this.firstScroll==1)||(_38d&&this.firstScroll==0)){var s=dojo.marginBox(this.headerNodeContainer);if(dojo.isIE){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(dojo.isMoz){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_38d?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!=this.lastTop){this.grid.scrollTo(top);}},setScrollTop:function(_390){this.lastTop=_390;this.scrollboxNode.scrollTop=_390;return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_395,_396){this.grid.setCellWidth(_395,_396+"px");},update:function(){this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});dojo.declare("dojox.grid._GridAvatar",dojo.dnd.Avatar,{construct:function(){var dd=dojo.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _39e=this.manager.source,node;if(_39e.creator){node=_39e._normailzedCreator(_39e.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _3a0=dd.createElement("table"),_3a1=dd.createElement("tbody");_3a1.appendChild(node);_3a0.appendChild(_3a1);node=_3a0;}else{if(node.tagName.toLowerCase()=="th"){var _3a0=dd.createElement("table"),_3a1=dd.createElement("tbody"),r=dd.createElement("tr");_3a0.cellPadding=_3a0.cellSpacing="0";r.appendChild(node);_3a1.appendChild(r);_3a0.appendChild(_3a1);node=_3a0;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);dojo.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=dojo.dnd.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){dojo.dnd.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _3a4=dojo.dnd.manager().makeAvatar;dojo.dnd.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined){return new dojox.grid._GridAvatar(this);}return _3a4.call(dojo.dnd.manager());};})();}if(!dojo._hasResource["dojox.grid._RowSelector"]){dojo._hasResource["dojox.grid._RowSelector"]=true;dojo.provide("dojox.grid._RowSelector");dojo.declare("dojox.grid._RowSelector",dojox.grid._View,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_3a6,_3a7){var w=this.contentNode.offsetWidth-this.padBorderWidth;_3a7.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\""+(dojo.isFF<3?"wairole:":"")+"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){},doStyleRowNode:function(_3a9,_3aa){var n=["dojoxGridRowbar"];if(this.grid.rows.isOver(_3a9)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_3a9)){n.push("dojoxGridRowbarSelected");}_3aa.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});}if(!dojo._hasResource["dojox.grid._Layout"]){dojo._hasResource["dojox.grid._Layout"]=true;dojo.provide("dojox.grid._Layout");dojo.declare("dojox.grid._Layout",null,{constructor:function(_3ae){this.grid=_3ae;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_3af,_3b0,_3b1,_3b2,_3b3){var _3b4=this.structure[_3af].cells[0];var _3b5=this.structure[_3b0].cells[0];var cell=null;var _3b7=0;var _3b8=0;for(var i=0,c;c=_3b4[i];i++){if(c.index==_3b1){_3b7=i;break;}}cell=_3b4.splice(_3b7,1)[0];cell.view=this.grid.views.views[_3b0];for(i=0,c=null;c=_3b5[i];i++){if(c.index==_3b2){_3b8=i;break;}}if(!_3b3){_3b8+=1;}_3b5.splice(_3b8,0,cell);var _3bb=this.grid.getCell(this.grid.getSortIndex());if(_3bb){_3bb._currentlySorted=this.grid.getSortAsc();}this.cells=[];var _3b1=0;for(var i=0,v;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0,c;c=cs[k];k++){c.index=_3b1;this.cells.push(c);if("_currentlySorted" in c){var si=_3b1+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_3b1++;}}}this.grid.setupHeaderMenu();},setColumnVisibility:function(_3c1,_3c2){var cell=this.cells[_3c1];if(cell.hidden==_3c2){cell.hidden=!_3c2;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=dojo.marginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_3c6,_3c7,_3c8){var self=this;var _3ca=function(_3cb){var w=0;if(_3cb.colSpan>1){w=0;}else{w=_3cb.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _3cd={grid:this.grid,subrow:_3c6,layoutIndex:_3c7,index:this.cells.length};if(_3c8&&_3c8 instanceof dojox.grid.cells._Base){var _3ce=dojo.clone(_3c8);_3cd.unitWidth=_3ca(_3ce._props);_3ce=dojo.mixin(_3ce,this._defaultCellProps,_3c8._props,_3cd);return _3ce;}var _3cf=_3c8.type||this._defaultCellProps.type||dojox.grid.cells.Cell;_3cd.unitWidth=_3ca(_3c8);return new _3cf(dojo.mixin({},this._defaultCellProps,_3c8,_3cd));},addRowDef:function(_3d0,_3d1){var _3d2=[];var _3d3=0,_3d4=0,_3d5=true;for(var i=0,def,cell;(def=_3d1[i]);i++){cell=this.addCellDef(_3d0,i,def);_3d2.push(cell);this.cells.push(cell);if(_3d5&&cell.relWidth){_3d3+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_3d4+=window.parseInt(w,10);}else{if(w=="auto"){_3d5=false;}}}}}if(_3d3&&_3d5){dojo.forEach(_3d2,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_3d3)*(100-_3d4))+"%";}});}return _3d2;},addRowsDef:function(_3db){var _3dc=[];if(dojo.isArray(_3db)){if(dojo.isArray(_3db[0])){for(var i=0,row;_3db&&(row=_3db[i]);i++){_3dc.push(this.addRowDef(i,row));}}else{_3dc.push(this.addRowDef(0,_3db));}}return _3dc;},addViewDef:function(_3df){this._defaultCellProps=_3df.defaultCell||{};if(_3df.width&&_3df.width=="auto"){delete _3df.width;}return dojo.mixin({},_3df,{cells:this.addRowsDef(_3df.rows||_3df.cells)});},setStructure:function(_3e0){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:dojox._scopeName+".grid._RowSelector"};if(dojo.isString(this.grid.rowSelector)){var _3e3=this.grid.rowSelector;if(_3e3=="false"){sel=null;}else{if(_3e3!="true"){sel["width"]=_3e3;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _3e4=function(def){return ("name" in def||"field" in def||"get" in def);};var _3e6=function(def){if(dojo.isArray(def)){if(dojo.isArray(def[0])||_3e4(def[0])){return true;}}return false;};var _3e8=function(def){return (def!=null&&dojo.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_3e4(def))));};if(dojo.isArray(_3e0)){var _3ea=false;for(var i=0,st;(st=_3e0[i]);i++){if(_3e8(st)){_3ea=true;break;}}if(!_3ea){s.push(this.addViewDef({cells:_3e0}));}else{for(var i=0,st;(st=_3e0[i]);i++){if(_3e6(st)){s.push(this.addViewDef({cells:st}));}else{if(_3e8(st)){s.push(this.addViewDef(st));}}}}}else{if(_3e8(_3e0)){s.push(this.addViewDef(_3e0));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});}if(!dojo._hasResource["dojox.grid._ViewManager"]){dojo._hasResource["dojox.grid._ViewManager"]=true;dojo.provide("dojox.grid._ViewManager");dojo.declare("dojox.grid._ViewManager",null,{constructor:function(_3ed){this.grid=_3ed;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_3ee){_3ee.idx=this.views.length;this.views.push(_3ee);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _3f1=[];for(var i=0,v;v=this.views[i];i++){_3f1.push(v.contentNode);}return _3f1;},forEach:function(_3f4){for(var i=0,v;v=this.views[i];i++){_3f4(v,i);}},onEach:function(_3f7,_3f8){_3f8=_3f8||[];for(var i=0,v;v=this.views[i];i++){if(_3f7 in v){v[_3f7].apply(v,_3f8);}}},normalizeHeaderNodeHeight:function(){var _3fb=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_3fb.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_3fb);},normalizeRowNodeHeights:function(_3fe){var h=0;for(var i=0,n,o;(n=_3fe[i]);i++){h=Math.max(h,dojo.marginBox(n.firstChild).h);}h=(h>=0?h:0);for(var i=0,n;(n=_3fe[i]);i++){dojo.marginBox(n.firstChild,{h:h});}if(_3fe&&_3fe[0]&&_3fe[0].parentNode){_3fe[0].parentNode.offsetHeight;}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_406){var _407=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_406));i++){n.firstChild.style.height="";_407.push(n);}this.normalizeRowNodeHeights(_407);},getViewWidth:function(_40b){return this.views[_40b].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_40c){_40c.headerContentNode.style.height="";});var h=0;this.forEach(function(_40e){h=Math.max(_40e.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_410){h=Math.max(_410.domNode.offsetHeight,h);});return h;},findClient:function(_411){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length;var c=(w<=0?len:this.findClient());var _41c=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!dojo._isBodyLtr()){ds.right=l+"px";hs.right=l+"px";}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_41c(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_41c(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_41c(v,l);}return l;},renderRow:function(_423,_424){var _425=[];for(var i=0,v,n,_429;(v=this.views[i])&&(n=_424[i]);i++){_429=v.renderRow(_423);n.appendChild(_429);_425.push(_429);}this.normalizeRowNodeHeights(_425);},rowRemoved:function(_42a){this.onEach("rowRemoved",[_42a]);},updateRow:function(_42b){for(var i=0,v;v=this.views[i];i++){v.updateRow(_42b);}this.renormalizeRow(_42b);},updateRowStyles:function(_42e){this.onEach("updateRowStyles",[_42e]);},setScrollTop:function(_42f){var top=_42f;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_42f);if(dojo.isIE&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}}});}if(!dojo._hasResource["dojox.grid._RowManager"]){dojo._hasResource["dojox.grid._RowManager"]=true;dojo.provide("dojox.grid._RowManager");(function(){var _435=function(_436,_437){if(_436.style.cssText==undefined){_436.setAttribute("style",_437);}else{_436.style.cssText=_437;}};dojo.declare("dojox.grid._RowManager",null,{constructor:function(_438){this.grid=_438;},linesToEms:2,overRow:-2,prepareStylingRow:function(_439,_43a){return {index:_439,node:_43a,odd:Boolean(_439&1),selected:this.grid.selection.isSelected(_439),over:this.isOver(_439),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_43b,_43c){var row=this.prepareStylingRow(_43b,_43c);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_43e){var i=_43e;i.node.className=i.customClasses;var h=i.node.style.height;_435(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_441){this.grid.updateRowStyles(_441);},setOverRow:function(_442){var last=this.overRow;this.overRow=_442;if((last!=this.overRow)&&(last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_444){return (this.overRow==_444);}});})();}if(!dojo._hasResource["dojox.grid._FocusManager"]){dojo._hasResource["dojox.grid._FocusManager"]=true;dojo.provide("dojox.grid._FocusManager");dojo.declare("dojox.grid._FocusManager",null,{constructor:function(_445){this.grid=_445;this.cell=null;this.rowIndex=-1;this._connects=[];this._connects.push(dojo.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(dojo.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(dojo.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(dojo.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(dojo.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(dojo.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){dojo.forEach(this._connects,dojo.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView;this._initColumnHeaders();},isFocusCell:function(_446,_447){return (this.cell==_446)&&(this.rowIndex==_447);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex==0)&&(this.cell.index==0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return dojo.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_448){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){dojo.toggleClass(n,this.focusClass,_448);if(_448){var sl=this.scrollIntoView();try{if(!this.grid.edit.isEditing()){dojox.grid.util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){dojo.toggleClass(n,this.focusClass,true);dojox.grid.util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){this._connects.push(dojo.connect(this.grid.viewsHeaderNode,"onblur",this,"doBlurHeader"));var _44c=this._findHeaderCells();for(var i=0;i<_44c.length;i++){this._connects.push(dojo.connect(_44c[i],"onfocus",this,"doColHeaderFocus"));this._connects.push(dojo.connect(_44c[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _44e=dojo.query("th",this.grid.viewsHeaderNode);var _44f=[];for(var i=0;i<_44e.length;i++){var _451=_44e[i];var _452=dojo.hasAttr(_451,"tabindex");var _453=dojo.attr(_451,"tabindex");if(_452&&_453<0){_44f.push(_451);}}return _44f;},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_457){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_457?_457:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_45c){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_45c);info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _45f=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_45f){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(dojo.isIE<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},styleRow:function(_460){return;},setFocusIndex:function(_461,_462){this.setFocusCell(this.grid.getCell(_462),_461);},setFocusCell:function(_463,_464){if(_463&&!this.isFocusCell(_463,_464)){this.tabbingOut=false;this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_463;this.rowIndex=_464;this._focusifyCellNode(true);}if(dojo.isOpera){setTimeout(dojo.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _469=this.grid.getCell(col);if(!this.isLastFocusCell()&&!_469.editable){this.cell=_469;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _46c=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_46c.editable){this.cell=_46c;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_46d,_46e){if(this.isNavHeader()){var _46f=this._findHeaderCells();var _470=dojo.indexOf(_46f,this._colHeadNode);_470+=_46e;if((_470>=0)&&(_470<_46f.length)){this._colHeadNode=_46f[_470];this._colHeadFocusIdx=_470;this._scrollHeader(_470);this._colHeadNode.focus();}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_46d));if(_46d){if(_46d>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_46d<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_46e));this.setFocusIndex(row,col);if(_46d){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){dojo.stopEvent(e);this.previous();}else{if(!this.isNavHeader()){this.focusHeader();dojo.stopEvent(e);}else{this.tabOut(this.grid.domNode);}}},nextKey:function(e){var _47a=this.grid.rowCount==0;if(e.target===this.grid.domNode){this.focusHeader();dojo.stopEvent(e);}else{if(this.isNavHeader()){this._colHeadNode=this._colHeadFocusIdx=null;if(this.isNoFocusCell()&&!_47a){this.setFocusIndex(0,0);}else{if(this.cell&&!_47a){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{this.tabOut(this.grid.lastFocusNode);}}}else{if(this.grid.edit.isEditing()){dojo.stopEvent(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_47b){this.tabbingOut=true;_47b.focus();},focusGridView:function(){dojox.grid.util.fire(this.focusView,"focus");},focusGrid:function(_47c){this.focusGridView();this._focusifyCellNode(true);},focusHeader:function(){var _47d=this._findHeaderCells();if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}this._colHeadNode=_47d[this._colHeadFocusIdx];if(this._colHeadNode){dojox.grid.util.fire(this._colHeadNode,"focus");this._focusifyCellNode(false);}},doFocus:function(e){if(e&&e.target!=e.currentTarget){dojo.stopEvent(e);return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;dojo.stopEvent(e);},doBlur:function(e){dojo.stopEvent(e);},doBlurHeader:function(e){dojo.stopEvent(e);},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;dojo.stopEvent(e);},doLastNodeBlur:function(e){dojo.stopEvent(e);},doColHeaderFocus:function(e){dojo.toggleClass(e.target,this.focusClass,true);this._scrollHeader(this.getHeaderIndex());},doColHeaderBlur:function(e){dojo.toggleClass(e.target,this.focusClass,false);}});}if(!dojo._hasResource["dojox.grid._EditManager"]){dojo._hasResource["dojox.grid._EditManager"]=true;dojo.provide("dojox.grid._EditManager");dojo.declare("dojox.grid._EditManager",null,{constructor:function(_485){this.grid=_485;this.connections=[];if(dojo.isIE){this.connections.push(dojo.connect(document.body,"onfocus",dojo.hitch(this,"_boomerangFocus")));}},info:{},destroy:function(){dojo.forEach(this.connections,dojo.disconnect);},cellFocus:function(_486,_487){if(this.grid.singleClickEdit||this.isEditRow(_487)){this.setEditCell(_486,_487);}else{this.apply();}if(this.isEditing()||(_486&&_486.editable&&_486.alwaysEditing)){this._focusEditor(_486,_487);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_489){if(_489.index==this.info.rowIndex){_489.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_48d,_48e){return (this.info.rowIndex===_48d)&&(this.info.cell.index==_48e);},isEditRow:function(_48f){return this.info.rowIndex===_48f;},setEditCell:function(_490,_491){if(!this.isEditCell(_491,_490.index)&&this.grid.canEdit&&this.grid.canEdit(_490,_491)){this.start(_490,_491,this.isEditRow(_491)||_490.editable);}},_focusEditor:function(_492,_493){dojox.grid.util.fire(_492,"focus",[_493]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(dojo.isIE){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_494,_495,_496){this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_495)){this.applyRowEdit();this.grid.updateRow(_495);}if(_496){this.info={cell:_494,rowIndex:_495};this.grid.doStartEdit(_494,_495);this.grid.updateRow(_495);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_494,_495);this._doCatchBoomerang();},_editorDo:function(_497){var c=this.info.cell;c&&c.editable&&c[_497](this.info.rowIndex);},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_499,_49a,_49b){if(this.grid.canEdit(_49a,_49b)){this.grid.doApplyCellEdit(_499,_49b,_49a.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_49c,_49d){var c=this.info.cell;if(this.isEditRow(_49c)&&(!_49d||c.view==_49d)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_49f,_4a0){var c=this.info.cell;if(this.isEditRow(_4a0)&&c.view==_49f&&c.editable){c.restore(c,this.info.rowIndex);}}});}if(!dojo._hasResource["dojox.grid.Selection"]){dojo._hasResource["dojox.grid.Selection"]=true;dojo.provide("dojox.grid.Selection");dojo.declare("dojox.grid.Selection",null,{constructor:function(_4a2){this.grid=_4a2;this.selected=[];this.setMode(_4a2.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_4a4){return this.grid.onCanSelect(_4a4);},onCanDeselect:function(_4a5){return this.grid.onCanDeselect(_4a5);},onSelected:function(_4a6){},onDeselected:function(_4a7){},onChanging:function(){},onChanged:function(){},isSelected:function(_4a8){if(this.mode=="none"){return false;}return this.selected[_4a8];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_4ab){if(this.mode=="none"){return -1;}for(var i=_4ab+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _4ae=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_4ae.push(i);}}return _4ae;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating==0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating==0){this.onChanged();}},select:function(_4b3){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_4b3);this.addToSelection(_4b3);}else{this.toggleSelect(_4b3);}},addToSelection:function(_4b4){if(this.mode=="none"){return;}_4b4=Number(_4b4);if(this.selected[_4b4]){this.selectedIndex=_4b4;}else{if(this.onCanSelect(_4b4)!==false){this.selectedIndex=_4b4;this._beginUpdate();this.selected[_4b4]=true;this.onSelected(_4b4);this._endUpdate();}}},deselect:function(_4b5){if(this.mode=="none"){return;}_4b5=Number(_4b5);if(this.selectedIndex==_4b5){this.selectedIndex=-1;}if(this.selected[_4b5]){if(this.onCanDeselect(_4b5)===false){return;}this._beginUpdate();delete this.selected[_4b5];this.onDeselected(_4b5);this._endUpdate();}},setSelected:function(_4b6,_4b7){this[(_4b7?"addToSelection":"deselect")](_4b6);},toggleSelect:function(_4b8){this.setSelected(_4b8,!this.selected[_4b8]);},_range:function(_4b9,inTo,func){var s=(_4b9>=0?_4b9:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_4bf,inTo){this._range(_4bf,inTo,dojo.hitch(this,"addToSelection"));},deselectRange:function(_4c1,inTo){this._range(_4c1,inTo,dojo.hitch(this,"deselect"));},insert:function(_4c3){this.selected.splice(_4c3,0,false);if(this.selectedIndex>=_4c3){this.selectedIndex++;}},remove:function(_4c4){this.selected.splice(_4c4,1);if(this.selectedIndex>=_4c4){this.selectedIndex--;}},deselectAll:function(_4c5){for(var i in this.selected){if((i!=_4c5)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_4c7,_4c8,_4c9){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_4c7);}else{var _4ca=this.selectedIndex;if(!_4c8){this.deselectAll(_4c7);}if(_4c9){this.selectRange(_4ca,_4c7);}else{if(_4c8){this.toggleSelect(_4c7);}else{this.addToSelection(_4c7);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.dnd.getCopyKeyState(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});}if(!dojo._hasResource["dojox.grid._Events"]){dojo._hasResource["dojox.grid._Events"]=true;dojo.provide("dojox.grid._Events");dojo.declare("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_4cf){var i=_4cf;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_4cf);this.edit.styleRow(_4cf);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var dk=dojo.keys;switch(e.keyCode){case dk.ESCAPE:this.edit.cancel();break;case dk.ENTER:if(!this.edit.isEditing()){var _4d3=this.focus.getHeaderIndex();if(_4d3>=0){this.setSortIndex(_4d3);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.dnd.getCopyKeyState(e),e.shiftKey);}dojo.stopEvent(e);}if(!e.shiftKey){var _4d4=this.edit.isEditing();this.edit.apply();if(!_4d4){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _4d5=this.focus.focusView||this.views.views[0];_4d5.content.decorateEvent(e);this.onRowClick(e);}break;case dk.SPACE:if(!this.edit.isEditing()){var _4d3=this.focus.getHeaderIndex();if(_4d3>=0){this.setSortIndex(_4d3);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.dnd.getCopyKeyState(e),e.shiftKey);}dojo.stopEvent(e);}break;case dk.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case dk.LEFT_ARROW:case dk.RIGHT_ARROW:if(!this.edit.isEditing()){dojo.stopEvent(e);var _4d6=(e.keyCode==dk.LEFT_ARROW)?1:-1;if(dojo._isBodyLtr()){_4d6*=-1;}this.focus.move(0,_4d6);}break;case dk.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!=0){dojo.stopEvent(e);this.focus.move(-1,0);}break;case dk.DOWN_ARROW:if(!this.edit.isEditing()&&this.store&&this.focus.rowIndex+1!=this.rowCount){dojo.stopEvent(e);this.focus.move(1,0);}break;case dk.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!=0){dojo.stopEvent(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case dk.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){dojo.stopEvent(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){dojo.addClass(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){dojo.removeClass(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}this.onRowClick(e);},onCellDblClick:function(e){if(dojo.isIE){this.edit.setEditCell(this._click[1].cell,this._click[1].rowIndex);}else{if(this._click[0].rowIndex!=this._click[1].rowIndex){this.edit.setEditCell(this._click[0].cell,this._click[0].rowIndex);}else{this.edit.setEditCell(e.cell,e.rowIndex);}}this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_4e3,_4e4){this.edit.cellFocus(_4e3,_4e4);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){dojo.stopEvent(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){dojo.addClass(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){dojo.removeClass(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){dojo.stopEvent(e);}},onStartEdit:function(_4f6,_4f7){},onApplyCellEdit:function(_4f8,_4f9,_4fa){},onCancelEdit:function(_4fb){},onApplyEdit:function(_4fc){},onCanSelect:function(_4fd){return true;},onCanDeselect:function(_4fe){return true;},onSelected:function(_4ff){this.updateRowStyles(_4ff);},onDeselected:function(_500){this.updateRowStyles(_500);},onSelectionChanged:function(){}});}if(!dojo._hasResource["dojox.grid._Grid"]){dojo._hasResource["dojox.grid._Grid"]=true;dojo.provide("dojox.grid._Grid");(function(){var jobs={cancel:function(_502){if(_502){clearTimeout(_502);}},jobs:[],job:function(_503,_504,_505){jobs.cancelJob(_503);var job=function(){delete jobs.jobs[_503];_505();};jobs.jobs[_503]=setTimeout(job,_504);},cancelJob:function(_507){jobs.cancel(jobs.jobs[_507]);}};dojo.declare("dojox.grid._Grid",[dijit._Widget,dijit._Templated,dojox.grid._Events],{templateString:"<div class=\"dojoxGrid\" hidefocus=\"hidefocus\" wairole=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" tabindex=\"-1\" wairole=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" wairole=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n",classTag:"dojoxGrid",get:function(_508){},rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,autoHeight:"",autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,sortInfo:0,themeable:true,_placeholders:null,buildRendering:function(){this.inherited(arguments);if(this.get==dojox.grid._Grid.prototype.get){this.get=null;}if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");dojox.html.metrics.initOnFontResize();this.connect(dojox.html.metrics,"onFontResize","textSizeChanged");dojox.grid.util.funnelEvents(this.domNode,this,"doKeyEvent",dojox.grid.util.keyEvents);this.connect(this,"onShow","renderOnIdle");},postMixInProperties:function(){this.inherited(arguments);var _509=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=dojo.string.substitute(this.loadingMessage,_509);this.errorMessage=dojo.string.substitute(this.errorMessage,_509);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);},postCreate:function(){this.styleChanged=this._styleChanged;this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.scroller){this.scroller.destroy();delete this.scroller;}if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){dojo.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_50c){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.attr("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_50c){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},styleChanged:function(){this.setStyledClass(this.domNode,"");},_styleChanged:function(){this.styleChanged();this.update();},textSizeChanged:function(){setTimeout(dojo.hitch(this,"_textSizeChanged"),1);},_textSizeChanged:function(){if(this.domNode){this.views.forEach(function(v){v.content.update();});this.render();}},sizeChange:function(){jobs.job(this.id+"SizeChange",50,dojo.hitch(this,"update"));},renderOnIdle:function(){setTimeout(dojo.hitch(this,"render"),1);},createManagers:function(){this.rows=new dojox.grid._RowManager(this);this.focus=new dojox.grid._FocusManager(this);this.edit=new dojox.grid._EditManager(this);},createSelection:function(){this.selection=new dojox.grid.Selection(this);},createScroller:function(){this.scroller=new dojox.grid._Scroller();this.scroller.grid=this;this.scroller._pageIdPrefix=this.id+"-";this.scroller.renderRow=dojo.hitch(this,"renderRow");this.scroller.removeRow=dojo.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new dojox.grid._Layout(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.render();this._resize();},createViews:function(){this.views=new dojox.grid._ViewManager(this);this.views.createView=dojo.hitch(this,"createView");},createView:function(_50e,idx){var c=dojo.getObject(_50e);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||dojox._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_514){var s=_514;if(s&&dojo.isString(s)){dojo.deprecated("dojox.grid._Grid.attr('structure', 'objVar')","use dojox.grid._Grid.attr('structure', objVar) instead","2.0");s=dojo.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_516){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.attr('structure', obj) instead.","2.0");this._setStructureAttr(_516);},getColumnTogglingItems:function(){return dojo.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new dijit.CheckedMenuItem({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_51a){if(self.layout.setColumnVisibility(this._gridCell.index,_51a)){var _51b=this._gridCell.menuItems;if(_51b.length>1){dojo.forEach(_51b,function(item){if(item!==this){item.setAttribute("checked",_51a);}},this);}var _51a=dojo.filter(self.layout.cells,function(c){if(c.menuItems.length>1){dojo.forEach(c.menuItems,"item.attr('disabled', false);");}else{c.menuItems[0].attr("disabled",false);}return !c.hidden;});if(_51a.length==1){dojo.forEach(_51a[0].menuItems,"item.attr('disabled', true);");}}},destroy:function(){var _51e=dojo.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_51e,1);delete this._gridCell;dijit.CheckedMenuItem.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);return item;},this);},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){dojo.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.attr('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){dojo.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_523){this.setScrollTop(0);},getItem:function(_524){return null;},showMessage:function(_525){if(_525){this.messagesNode.innerHTML=_525;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_526,_527){this._resize(_526,_527);this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||dojo._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_52a,_52b){var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _52d=this._getPadBorder();var hh=0;if(this._autoHeight){this.domNode.style.height="auto";this.viewsNode.style.height="";}else{if(typeof this.autoHeight=="number"){var h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.flex>0){}else{if(this.domNode.clientHeight<=_52d.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}}if(_52b){_52a=_52b;}if(_52a){dojo.marginBox(this.domNode,_52a);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){var h=dojo._getContentBox(pn).h;dojo.marginBox(this.domNode,{h:Math.max(0,h)});}}var h=dojo._getContentBox(this.domNode).h;if(h==0&&!this._autoHeight){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";hh=this._getHeaderHeight();}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var w=this.autoWidth?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(this.autoWidth){this.domNode.style.width=vw+"px";}},adaptHeight:function(_532){var t=_532||this._getHeaderHeight();var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _535=0,_536=0;var _537=dojo.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_535++;}else{_536++;}return (!has);});if(_535>0&&_536>0){dojo.forEach(_537,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.attr("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.attr("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();dojo.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_53c,_53d){this.views.renderRow(_53c,_53d);},rowRemoved:function(_53e){this.views.rowRemoved(_53e);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=null;},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}var _541=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(_541);this.postrender();},update:function(){this.render();},updateRow:function(_542){_542=Number(_542);if(this.updating){this.invalidated[_542]=true;}else{this.views.updateRow(_542);this.scroller.rowHeightChanged(_542);}},updateRows:function(_543,_544){_543=Number(_543);_544=Number(_544);if(this.updating){for(var i=0;i<_544;i++){this.invalidated[i+_543]=true;}}else{for(var i=0;i<_544;i++){this.views.updateRow(i+_543);}this.scroller.rowHeightChanged(_543);}},updateRowCount:function(_546){if(this.updating){this.invalidated.rowCount=_546;}else{this.rowCount=_546;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_546);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_547){this.views.updateRowStyles(_547);},rowHeightChanged:function(_548){this.views.renormalizeRow(_548);this.scroller.rowHeightChanged(_548);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(dojo.isIE?100:50),scrollTo:function(_549){if(!this.fastScroll){this.setScrollTop(_549);return;}var _54a=Math.abs(this.lastScrollTop-_549);this.lastScrollTop=_549;if(_54a>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_549;this.views.setScrollTop(_549);jobs.job("dojoxGridScroll",200,dojo.hitch(this,"finishScrollJob"));}else{this.setScrollTop(_549);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_54b){this.scroller.scroll(this.views.setScrollTop(_54b));},scrollToRow:function(_54c){this.setScrollTop(this.scroller.findScrollTop(_54c)+1);},styleRowNode:function(_54d,_54e){if(_54e){this.rows.styleRowNode(_54d,_54e);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_550){return this.layout.cells[_550];},setCellWidth:function(_551,_552){this.getCell(_551).unitWidth=_552;},getCellName:function(_553){return "Cell "+_553.index;},canSort:function(_554){},sort:function(){},getSortAsc:function(_555){_555=_555==undefined?this.sortInfo:_555;return Boolean(_555>0);},getSortIndex:function(_556){_556=_556==undefined?this.sortInfo:_556;return Math.abs(_556)-1;},setSortIndex:function(_557,_558){var si=_557+1;if(_558!=undefined){si*=(_558?1:-1);}else{if(this.getSortIndex()==_557){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_55a){if(this.canSort(_55a)){this.sortInfo=_55a;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_568,_569){this.onStartEdit(_568,_569);},doApplyCellEdit:function(_56a,_56b,_56c){this.onApplyCellEdit(_56a,_56b,_56c);},doCancelEdit:function(_56d){this.onCancelEdit(_56d);},doApplyEdit:function(_56e){this.onApplyEdit(_56e);},addRow:function(){this.updateRowCount(this.attr("rowCount")+1);},removeSelectedRows:function(){this.updateRowCount(Math.max(0,this.attr("rowCount")-this.selection.getSelected().length));this.selection.clear();}});dojox.grid._Grid.markupFactory=function(_56f,node,ctor,_572){var d=dojo;var _574=function(n){var w=d.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w)+"px";}return w;};if(!_56f.structure&&node.nodeName.toLowerCase()=="table"){_56f.structure=d.query("> colgroup",node).map(function(cg){var sv=d.attr(cg,"span");var v={noscroll:(d.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv):1),cells:[]};if(d.hasAttr(cg,"width")){v.width=_574(cg);}return v;});if(!_56f.structure.length){_56f.structure.push({__span:Infinity,cells:[]});}d.query("thead > tr",node).forEach(function(tr,_57b){var _57c=0;var _57d=0;var _57e;var _57f=null;d.query("> th",tr).map(function(th){if(!_57f){_57e=0;_57f=_56f.structure[0];}else{if(_57c>=(_57e+_57f.__span)){_57d++;_57e+=_57f.__span;var _581=_57f;_57f=_56f.structure[_57d];}}var cell={name:d.trim(d.attr(th,"name")||th.innerHTML),colSpan:parseInt(d.attr(th,"colspan")||1,10),type:d.trim(d.attr(th,"cellType")||"")};_57c+=cell.colSpan;var _583=d.attr(th,"rowspan");if(_583){cell.rowSpan=_583;}if(d.hasAttr(th,"width")){cell.width=_574(th);}if(d.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(dojo.attr(th,"relWidth"),10);}if(d.hasAttr(th,"hidden")){cell.hidden=d.attr(th,"hidden")=="true";}if(_572){_572(th,cell);}cell.type=cell.type?dojo.getObject(cell.type):dojox.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_57f.cells[_57b]){_57f.cells[_57b]=[];}_57f.cells[_57b].push(cell);});});}return new ctor(_56f,node);};})();}if(!dojo._hasResource["dojox.grid.DataSelection"]){dojo._hasResource["dojox.grid.DataSelection"]=true;dojo.provide("dojox.grid.DataSelection");dojo.declare("dojox.grid.DataSelection",dojox.grid.Selection,{getFirstSelected:function(){var idx=dojox.grid.Selection.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_585){var _586=this.grid.getItemIndex(_585);var idx=dojox.grid.Selection.prototype.getNextSelected.call(this,_586);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _588=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_588.push(this.grid.getItem(i));}}return _588;},addToSelection:function(_58b){if(this.mode=="none"){return;}var idx=null;if(typeof _58b=="number"||typeof _58b=="string"){idx=_58b;}else{idx=this.grid.getItemIndex(_58b);}dojox.grid.Selection.prototype.addToSelection.call(this,idx);},deselect:function(_58d){if(this.mode=="none"){return;}var idx=null;if(typeof _58d=="number"||typeof _58d=="string"){idx=_58d;}else{idx=this.grid.getItemIndex(_58d);}dojox.grid.Selection.prototype.deselect.call(this,idx);},deselectAll:function(_58f){var idx=null;if(_58f||typeof _58f=="number"){if(typeof _58f=="number"||typeof _58f=="string"){idx=_58f;}else{idx=this.grid.getItemIndex(_58f);}dojox.grid.Selection.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});}if(!dojo._hasResource["dojox.grid.DataGrid"]){dojo._hasResource["dojox.grid.DataGrid"]=true;dojo.provide("dojox.grid.DataGrid");dojo.declare("dojox.grid.DataGrid",dojox.grid._Grid,{store:null,query:null,queryOptions:null,fetchText:"...",items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},createSelection:function(){this.selection=new dojox.grid.DataSelection(this);},get:function(_591,_592){return (!_592?this.defaultValue:(!this.field?this.value:this.grid.store.getValue(_592,this.field)));},_onSet:function(item,_594,_595,_596){var idx=this.getItemIndex(item);if(idx>-1){this.updateRow(idx);}},_addItem:function(item,_599,_59a){var idty=this._hasIdentity?this.store.getIdentity(item):dojo.toJson(this.query)+":idx:"+_599+":sort:"+dojo.toJson(this.getSortProps());var o={idty:idty,item:item};this._by_idty[idty]=this._by_idx[_599]=o;if(!_59a){this.updateRow(_599);}},_onNew:function(item,_59e){var _59f=this.attr("rowCount");this._addingItem=true;this.updateRowCount(_59f+1);this._addingItem=false;this._addItem(item,_59f);this.showMessage();},_onDelete:function(item){var idx=this._getItemIndex(item,true);if(idx>=0){var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.attr("rowCount")-1);if(this.attr("rowCount")===0){this.showMessage(this.noDataMessage);}}},_onRevert:function(){this._refresh();},setStore:function(_5a3,_5a4,_5a5){this._setQuery(_5a4,_5a5);this._setStore(_5a3);this._refresh(true);},setQuery:function(_5a6,_5a7){this._setQuery(_5a6,_5a7);this._refresh(true);},setItems:function(_5a8){this.items=_5a8;this._setStore(this.store);this._refresh(true);},_setQuery:function(_5a9,_5aa){this.query=_5a9;this.queryOptions=_5aa||this.queryOptions;},_setStore:function(_5ab){if(this.store&&this._store_connects){dojo.forEach(this._store_connects,function(arr){dojo.forEach(arr,dojo.disconnect);});}this.store=_5ab;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(size,req){if(this.rowCount!=size){if(req.isRender){this.scroller.init(size,this.keepRows,this.rowsPerPage);this.rowCount=size;this._setAutoHeightAttr(this.autoHeight,true);this.prerender();}else{this.updateRowCount(size);}}},_onFetchComplete:function(_5b1,req){if(_5b1&&_5b1.length>0){dojo.forEach(_5b1,function(item,idx){this._addItem(item,req.start+idx,true);},this);this.updateRows(req.start,_5b1.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;if(!_5b1||!_5b1.length){this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_5b9,_5ba){var _5b9=_5b9||0;if(this.store&&!this._pending_requests[_5b9]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_5b9]=true;try{if(this.items){var _5bb=this.items;var _5bc=this.store;this.rowsPerPage=_5bb.length;var req={start:_5b9,count:this.rowsPerPage,isRender:_5ba};this._onFetchBegin(_5bb.length,req);var _5be=0;dojo.forEach(_5bb,function(i){if(!_5bc.isItemLoaded(i)){_5be++;}});if(_5be===0){this._onFetchComplete(_5bb,req);}else{var _5c0=function(item){_5be--;if(_5be===0){this._onFetchComplete(_5bb,req);}};dojo.forEach(_5bb,function(i){if(!_5bc.isItemLoaded(i)){_5bc.loadItem({item:i,onItem:_5c0,scope:this});}},this);}}else{this.store.fetch({start:_5b9,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_5ba,onBegin:dojo.hitch(this,"_onFetchBegin"),onComplete:dojo.hitch(this,"_onFetchComplete"),onError:dojo.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e);}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var data=this._by_idx[idx];if(!data||(data&&!data.item)){this._preparePage(idx);return null;}return data.item;},getItemIndex:function(item){return this._getItemIndex(item,false);},_getItemIndex:function(item,_5c7){if(!_5c7&&!this.store.isItem(item)){return -1;}var idty=this._hasIdentity?this.store.getIdentity(item):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((idty&&d.idty==idty)||(d.item===item))){return i;}}return -1;},filter:function(_5cc,_5cd){this.query=_5cc;if(_5cd){this._clearData();}this._fetch();},_getItemAttr:function(idx,attr){var item=this.getItem(idx);return (!item?this.fetchText:this.store.getValue(item,attr));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.attr("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_5d1){return this._pending_requests[_5d1];},_rowToPage:function(_5d2){return (this.rowsPerPage?Math.floor(_5d2/this.rowsPerPage):_5d2);},_pageToRow:function(_5d3){return (this.rowsPerPage?this.rowsPerPage*_5d3:_5d3);},_preparePage:function(_5d4){if((_5d4<this._bop||_5d4>=this._eop)&&!this._addingItem){var _5d5=this._rowToPage(_5d4);this._needPage(_5d5);this._bop=_5d5*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.attr("rowCount"));}},_needPage:function(_5d6){if(!this._pages[_5d6]){this._pages[_5d6]=true;this._requestPage(_5d6);}},_requestPage:function(_5d7){var row=this._pageToRow(_5d7);var _5d9=Math.min(this.rowsPerPage,this.attr("rowCount")-row);if(_5d9>0){this._requests++;if(!this._requestsPending(row)){setTimeout(dojo.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_5da){return _5da.field;},_refresh:function(_5db){this._clearData();this._fetch(0,_5db);},sort:function(){this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){return null;}else{var desc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof desc=="undefined"){desc=si;}else{desc=si?!desc:desc;}return [{attribute:c.field,descending:desc}];}},styleRowState:function(_5df){if(this.store&&this.store.getState){var _5e0=this.store.getState(_5df.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_5e0[s]){c=" dojoxGridRow-"+s;break;}}_5df.customClasses+=c;}},onStyleRow:function(_5e5){this.styleRowState(_5e5);this.inherited(arguments);},canEdit:function(_5e6,_5e7){return this._canEdit;},_copyAttr:function(idx,attr){var row={};var _5eb={};var src=this.getItem(idx);return this.store.getValue(src,attr);},doStartEdit:function(_5ed,_5ee){if(!this._cache[_5ee]){this._cache[_5ee]=this._copyAttr(_5ee,_5ed.field);}this.onStartEdit(_5ed,_5ee);},doApplyCellEdit:function(_5ef,_5f0,_5f1){this.store.fetchItemByIdentity({identity:this._by_idx[_5f0].idty,onItem:dojo.hitch(this,function(item){var _5f3=this.store.getValue(item,_5f1);if(typeof _5f3=="number"){_5ef=isNaN(_5ef)?_5ef:parseFloat(_5ef);}else{if(typeof _5f3=="boolean"){_5ef=_5ef=="true"?true:_5ef=="false"?false:_5ef;}else{if(_5f3 instanceof Date){var _5f4=new Date(_5ef);_5ef=isNaN(_5f4.getTime())?_5ef:_5f4;}}}this.store.setValue(item,_5f1,_5ef);this.onApplyCellEdit(_5ef,_5f0,_5f1);})});},doCancelEdit:function(_5f5){var _5f6=this._cache[_5f5];if(_5f6){this.updateRow(_5f5);delete this._cache[_5f5];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_5f7,_5f8){var _5f9=this._cache[_5f7];this.onApplyEdit(_5f7);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var _5fa=this.selection.getSelected();if(_5fa.length){dojo.forEach(_5fa,this.store.deleteItem,this.store);this.selection.clear();}}}});dojox.grid.DataGrid.markupFactory=function(_5fb,node,ctor,_5fe){return dojox.grid._Grid.markupFactory(_5fb,node,ctor,function(node,_600){var _601=dojo.trim(dojo.attr(node,"field")||"");if(_601){_600.field=_601;}_600.field=_600.field||_600.name;if(_5fe){_5fe(node,_600);}});};}if(!dojo._hasResource["dojo.data.ItemFileReadStore"]){dojo._hasResource["dojo.data.ItemFileReadStore"]=true;dojo.provide("dojo.data.ItemFileReadStore");dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(_602){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_602.url;this._jsonData=_602.data;this._datatypeMap=_602.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_603){return dojo.date.stamp.fromISOString(_603);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_602.urlPreventCache!==undefined){this.urlPreventCache=_602.urlPreventCache?true:false;}if(_602.clearOnClose){this.clearOnClose=true;}},url:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_605){if(typeof _605!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_607,_608){var _609=this.getValues(item,_607);return (_609.length>0)?_609[0]:_608;},getValues:function(item,_60b){this._assertIsItem(item);this._assertIsAttribute(_60b);return item[_60b]||[];},getAttributes:function(item){this._assertIsItem(item);var _60d=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_60d.push(key);}}return _60d;},hasAttribute:function(item,_610){return this.getValues(item,_610).length>0;},containsValue:function(item,_612,_613){var _614=undefined;if(typeof _613==="string"){_614=dojo.data.util.filter.patternToRegExp(_613,false);}return this._containsValue(item,_612,_613,_614);},_containsValue:function(item,_616,_617,_618){return dojo.some(this.getValues(item,_616),function(_619){if(_619!==null&&!dojo.isObject(_619)&&_618){if(_619.toString().match(_618)){return true;}}else{if(_617===_619){return true;}}});},isItem:function(_61a){if(_61a&&_61a[this._storeRefPropName]===this){if(this._arrayOfAllItems[_61a[this._itemNumPropName]]===_61a){return true;}}return false;},isItemLoaded:function(_61b){return this.isItem(_61b);},loadItem:function(_61c){this._assertIsItem(_61c.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_61f,_620,_621){var self=this;var _623=function(_624,_625){var _626=[];var i,key;if(_624.query){var _629;var _62a=_624.queryOptions?_624.queryOptions.ignoreCase:false;var _62b={};for(key in _624.query){_629=_624.query[key];if(typeof _629==="string"){_62b[key]=dojo.data.util.filter.patternToRegExp(_629,_62a);}}for(i=0;i<_625.length;++i){var _62c=true;var _62d=_625[i];if(_62d===null){_62c=false;}else{for(key in _624.query){_629=_624.query[key];if(!self._containsValue(_62d,key,_629,_62b[key])){_62c=false;}}}if(_62c){_626.push(_62d);}}_620(_626,_624);}else{for(i=0;i<_625.length;++i){var item=_625[i];if(item!==null){_626.push(item);}}_620(_626,_624);}};if(this._loadFinished){_623(_61f,this._getItemsArray(_61f.queryOptions));}else{if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_61f,filter:_623});}else{this._loadInProgress=true;var _62f={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache};var _630=dojo.xhrGet(_62f);_630.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_623(_61f,self._getItemsArray(_61f.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_621(e,_61f);}});_630.addErrback(function(_632){self._loadInProgress=false;_621(_632,_61f);});var _633=null;if(_61f.abort){_633=_61f.abort;}_61f.abort=function(){var df=_630;if(df&&df.fired===-1){df.cancel();df=null;}if(_633){_633.call(_61f);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_623(_61f,this._getItemsArray(_61f.queryOptions));}catch(e){_621(e,_61f);}}else{_621(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_61f);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _636=this._queuedFetches[i];var _637=_636.args;var _638=_636.filter;if(_638){_638(_637,this._getItemsArray(_637.queryOptions));}else{this.fetchItemByIdentity(_637);}}this._queuedFetches=[];}},_getItemsArray:function(_639){if(_639&&_639.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_63a){if(this.clearOnClose&&(this._jsonFileUrl!=="")){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_63b){var _63c=false;function _63d(_63e){var _63f=((_63e!==null)&&(typeof _63e==="object")&&(!dojo.isArray(_63e)||_63c)&&(!dojo.isFunction(_63e))&&(_63e.constructor==Object||dojo.isArray(_63e))&&(typeof _63e._reference==="undefined")&&(typeof _63e._type==="undefined")&&(typeof _63e._value==="undefined"));return _63f;};var self=this;function _641(_642){self._arrayOfAllItems.push(_642);for(var _643 in _642){var _644=_642[_643];if(_644){if(dojo.isArray(_644)){var _645=_644;for(var k=0;k<_645.length;++k){var _647=_645[k];if(_63d(_647)){_641(_647);}}}else{if(_63d(_644)){_641(_644);}}}}};this._labelAttr=_63b.label;var i;var item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_63b.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(dojo.isArray(item)){_63c=true;}_641(item);item[this._rootItemPropName]=true;}var _64a={};var key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _64c=item[key];if(_64c!==null){if(!dojo.isArray(_64c)){item[key]=[_64c];}}else{item[key]=[null];}}_64a[key]=key;}}while(_64a[this._storeRefPropName]){this._storeRefPropName+="_";}while(_64a[this._itemNumPropName]){this._itemNumPropName+="_";}while(_64a[this._reverseRefMap]){this._reverseRefMap+="_";}var _64d;var _64e=_63b.identifier;if(_64e){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_64e;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_64d=item[_64e];var _64f=_64d[0];if(!this._itemsByIdentity[_64f]){this._itemsByIdentity[_64f]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_64e+"].  Value collided: ["+_64f+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_64e+"].  Value collided: ["+_64f+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_64d=item[key];for(var j=0;j<_64d.length;++j){_64c=_64d[j];if(_64c!==null&&typeof _64c=="object"){if(_64c._type&&_64c._value){var type=_64c._type;var _652=this._datatypeMap[type];if(!_652){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(dojo.isFunction(_652)){_64d[j]=new _652(_64c._value);}else{if(dojo.isFunction(_652.deserialize)){_64d[j]=_652.deserialize(_64c._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_64c._reference){var _653=_64c._reference;if(!dojo.isObject(_653)){_64d[j]=this._itemsByIdentity[_653];}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _655=this._arrayOfAllItems[k];var _656=true;for(var _657 in _653){if(_655[_657]!=_653[_657]){_656=false;}}if(_656){_64d[j]=_655;}}}if(this.referenceIntegrity){var _658=_64d[j];if(this.isItem(_658)){this._addReferenceToMap(_658,item,key);}}}else{if(this.isItem(_64c)){if(this.referenceIntegrity){this._addReferenceToMap(_64c,item,key);}}}}}}}},_addReferenceToMap:function(_659,_65a,_65b){},getIdentity:function(item){var _65d=this._features["dojo.data.api.Identity"];if(_65d===Number){return item[this._itemNumPropName];}else{var _65e=item[_65d];if(_65e){return _65e[0];}}return null;},fetchItemByIdentity:function(_65f){var item;var _661;if(!this._loadFinished){var self=this;if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_65f});}else{this._loadInProgress=true;var _663={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache};var _664=dojo.xhrGet(_663);_664.addCallback(function(data){var _666=_65f.scope?_65f.scope:dojo.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_65f.identity);if(_65f.onItem){_65f.onItem.call(_666,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_65f.onError){_65f.onError.call(_666,error);}}});_664.addErrback(function(_667){self._loadInProgress=false;if(_65f.onError){var _668=_65f.scope?_65f.scope:dojo.global;_65f.onError.call(_668,_667);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_65f.identity);if(_65f.onItem){_661=_65f.scope?_65f.scope:dojo.global;_65f.onItem.call(_661,item);}}}}else{item=this._getItemByIdentity(_65f.identity);if(_65f.onItem){_661=_65f.scope?_65f.scope:dojo.global;_65f.onItem.call(_661,item);}}},_getItemByIdentity:function(_669){var item=null;if(this._itemsByIdentity){item=this._itemsByIdentity[_669];}else{item=this._arrayOfAllItems[_669];}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _66c=this._features["dojo.data.api.Identity"];if(_66c===Number){return null;}else{return [_66c];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl){var _66e={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,sync:true};var _66f=dojo.xhrGet(_66e);_66f.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_66f.addErrback(function(_671){throw _671;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["dojo.data.ItemFileWriteStore"]){dojo._hasResource["dojo.data.ItemFileWriteStore"]=true;dojo.provide("dojo.data.ItemFileWriteStore");dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(_672){this._features["dojo.data.api.Write"]=true;this._features["dojo.data.api.Notification"]=true;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap["Date"].serialize){this._datatypeMap["Date"].serialize=function(obj){return dojo.date.stamp.toISOString(obj,{zulu:true});};}if(_672&&(_672.referenceIntegrity===false)){this.referenceIntegrity=false;}this._saveInProgress=false;},referenceIntegrity:true,_assert:function(_674){if(!_674){throw new Error("assertion failed in ItemFileWriteStore");}},_getIdentifierAttribute:function(){var _675=this.getFeatures()["dojo.data.api.Identity"];return _675;},newItem:function(_676,_677){this._assert(!this._saveInProgress);if(!this._loadFinished){this._forceLoad();}if(typeof _676!="object"&&typeof _676!="undefined"){throw new Error("newItem() was passed something other than an object");}var _678=null;var _679=this._getIdentifierAttribute();if(_679===Number){_678=this._arrayOfAllItems.length;}else{_678=_676[_679];if(typeof _678==="undefined"){throw new Error("newItem() was not passed an identity for the new item");}if(dojo.isArray(_678)){throw new Error("newItem() was not passed an single-valued identity");}}if(this._itemsByIdentity){this._assert(typeof this._itemsByIdentity[_678]==="undefined");}this._assert(typeof this._pending._newItems[_678]==="undefined");this._assert(typeof this._pending._deletedItems[_678]==="undefined");var _67a={};_67a[this._storeRefPropName]=this;_67a[this._itemNumPropName]=this._arrayOfAllItems.length;if(this._itemsByIdentity){this._itemsByIdentity[_678]=_67a;_67a[_679]=[_678];}this._arrayOfAllItems.push(_67a);var _67b=null;if(_677&&_677.parent&&_677.attribute){_67b={item:_677.parent,attribute:_677.attribute,oldValue:undefined};var _67c=this.getValues(_677.parent,_677.attribute);if(_67c&&_67c.length>0){var _67d=_67c.slice(0,_67c.length);if(_67c.length===1){_67b.oldValue=_67c[0];}else{_67b.oldValue=_67c.slice(0,_67c.length);}_67d.push(_67a);this._setValueOrValues(_677.parent,_677.attribute,_67d,false);_67b.newValue=this.getValues(_677.parent,_677.attribute);}else{this._setValueOrValues(_677.parent,_677.attribute,_67a,false);_67b.newValue=_67a;}}else{_67a[this._rootItemPropName]=true;this._arrayOfTopLevelItems.push(_67a);}this._pending._newItems[_678]=_67a;for(var key in _676){if(key===this._storeRefPropName||key===this._itemNumPropName){throw new Error("encountered bug in ItemFileWriteStore.newItem");}var _67f=_676[key];if(!dojo.isArray(_67f)){_67f=[_67f];}_67a[key]=_67f;if(this.referenceIntegrity){for(var i=0;i<_67f.length;i++){var val=_67f[i];if(this.isItem(val)){this._addReferenceToMap(val,_67a,key);}}}}this.onNew(_67a,_67b);return _67a;},_removeArrayElement:function(_682,_683){var _684=dojo.indexOf(_682,_683);if(_684!=-1){_682.splice(_684,1);return true;}return false;},deleteItem:function(item){this._assert(!this._saveInProgress);this._assertIsItem(item);var _686=item[this._itemNumPropName];var _687=this.getIdentity(item);if(this.referenceIntegrity){var _688=this.getAttributes(item);if(item[this._reverseRefMap]){item["backup_"+this._reverseRefMap]=dojo.clone(item[this._reverseRefMap]);}dojo.forEach(_688,function(_689){dojo.forEach(this.getValues(item,_689),function(_68a){if(this.isItem(_68a)){if(!item["backupRefs_"+this._reverseRefMap]){item["backupRefs_"+this._reverseRefMap]=[];}item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(_68a),attr:_689});this._removeReferenceFromMap(_68a,item,_689);}},this);},this);var _68b=item[this._reverseRefMap];if(_68b){for(var _68c in _68b){var _68d=null;if(this._itemsByIdentity){_68d=this._itemsByIdentity[_68c];}else{_68d=this._arrayOfAllItems[_68c];}if(_68d){for(var _68e in _68b[_68c]){var _68f=this.getValues(_68d,_68e)||[];var _690=dojo.filter(_68f,function(_691){return !(this.isItem(_691)&&this.getIdentity(_691)==_687);},this);this._removeReferenceFromMap(item,_68d,_68e);if(_690.length<_68f.length){this._setValueOrValues(_68d,_68e,_690,true);}}}}}}this._arrayOfAllItems[_686]=null;item[this._storeRefPropName]=null;if(this._itemsByIdentity){delete this._itemsByIdentity[_687];}this._pending._deletedItems[_687]=item;if(item[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,item);}this.onDelete(item);return true;},setValue:function(item,_693,_694){return this._setValueOrValues(item,_693,_694,true);},setValues:function(item,_696,_697){return this._setValueOrValues(item,_696,_697,true);},unsetAttribute:function(item,_699){return this._setValueOrValues(item,_699,[],true);},_setValueOrValues:function(item,_69b,_69c,_69d){this._assert(!this._saveInProgress);this._assertIsItem(item);this._assert(dojo.isString(_69b));this._assert(typeof _69c!=="undefined");var _69e=this._getIdentifierAttribute();if(_69b==_69e){throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");}var _69f=this._getValueOrValues(item,_69b);var _6a0=this.getIdentity(item);if(!this._pending._modifiedItems[_6a0]){var _6a1={};for(var key in item){if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){_6a1[key]=item[key];}else{if(key===this._reverseRefMap){_6a1[key]=dojo.clone(item[key]);}else{_6a1[key]=item[key].slice(0,item[key].length);}}}this._pending._modifiedItems[_6a0]=_6a1;}var _6a3=false;if(dojo.isArray(_69c)&&_69c.length===0){_6a3=delete item[_69b];_69c=undefined;if(this.referenceIntegrity&&_69f){var _6a4=_69f;if(!dojo.isArray(_6a4)){_6a4=[_6a4];}for(var i=0;i<_6a4.length;i++){var _6a6=_6a4[i];if(this.isItem(_6a6)){this._removeReferenceFromMap(_6a6,item,_69b);}}}}else{var _6a7;if(dojo.isArray(_69c)){var _6a8=_69c;_6a7=_69c.slice(0,_69c.length);}else{_6a7=[_69c];}if(this.referenceIntegrity){if(_69f){var _6a4=_69f;if(!dojo.isArray(_6a4)){_6a4=[_6a4];}var map={};dojo.forEach(_6a4,function(_6aa){if(this.isItem(_6aa)){var id=this.getIdentity(_6aa);map[id.toString()]=true;}},this);dojo.forEach(_6a7,function(_6ac){if(this.isItem(_6ac)){var id=this.getIdentity(_6ac);if(map[id.toString()]){delete map[id.toString()];}else{this._addReferenceToMap(_6ac,item,_69b);}}},this);for(var rId in map){var _6af;if(this._itemsByIdentity){_6af=this._itemsByIdentity[rId];}else{_6af=this._arrayOfAllItems[rId];}this._removeReferenceFromMap(_6af,item,_69b);}}else{for(var i=0;i<_6a7.length;i++){var _6a6=_6a7[i];if(this.isItem(_6a6)){this._addReferenceToMap(_6a6,item,_69b);}}}}item[_69b]=_6a7;_6a3=true;}if(_69d){this.onSet(item,_69b,_69f,_69c);}return _6a3;},_addReferenceToMap:function(_6b0,_6b1,_6b2){var _6b3=this.getIdentity(_6b1);var _6b4=_6b0[this._reverseRefMap];if(!_6b4){_6b4=_6b0[this._reverseRefMap]={};}var _6b5=_6b4[_6b3];if(!_6b5){_6b5=_6b4[_6b3]={};}_6b5[_6b2]=true;},_removeReferenceFromMap:function(_6b6,_6b7,_6b8){var _6b9=this.getIdentity(_6b7);var _6ba=_6b6[this._reverseRefMap];var _6bb;if(_6ba){for(_6bb in _6ba){if(_6bb==_6b9){delete _6ba[_6bb][_6b8];if(this._isEmpty(_6ba[_6bb])){delete _6ba[_6bb];}}}if(this._isEmpty(_6ba)){delete _6b6[this._reverseRefMap];}}},_dumpReferenceMap:function(){var i;for(i=0;i<this._arrayOfAllItems.length;i++){var item=this._arrayOfAllItems[i];if(item&&item[this._reverseRefMap]){console.log("Item: ["+this.getIdentity(item)+"] is referenced by: "+dojo.toJson(item[this._reverseRefMap]));}}},_getValueOrValues:function(item,_6bf){var _6c0=undefined;if(this.hasAttribute(item,_6bf)){var _6c1=this.getValues(item,_6bf);if(_6c1.length==1){_6c0=_6c1[0];}else{_6c0=_6c1;}}return _6c0;},_flatten:function(_6c2){if(this.isItem(_6c2)){var item=_6c2;var _6c4=this.getIdentity(item);var _6c5={_reference:_6c4};return _6c5;}else{if(typeof _6c2==="object"){for(var type in this._datatypeMap){var _6c7=this._datatypeMap[type];if(dojo.isObject(_6c7)&&!dojo.isFunction(_6c7)){if(_6c2 instanceof _6c7.type){if(!_6c7.serialize){throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");}return {_type:type,_value:_6c7.serialize(_6c2)};}}else{if(_6c2 instanceof _6c7){return {_type:type,_value:_6c2.toString()};}}}}return _6c2;}},_getNewFileContentString:function(){var _6c8={};var _6c9=this._getIdentifierAttribute();if(_6c9!==Number){_6c8.identifier=_6c9;}if(this._labelAttr){_6c8.label=this._labelAttr;}_6c8.items=[];for(var i=0;i<this._arrayOfAllItems.length;++i){var item=this._arrayOfAllItems[i];if(item!==null){var _6cc={};for(var key in item){if(key!==this._storeRefPropName&&key!==this._itemNumPropName&&key!==this._reverseRefMap&&key!==this._rootItemPropName){var _6ce=key;var _6cf=this.getValues(item,_6ce);if(_6cf.length==1){_6cc[_6ce]=this._flatten(_6cf[0]);}else{var _6d0=[];for(var j=0;j<_6cf.length;++j){_6d0.push(this._flatten(_6cf[j]));_6cc[_6ce]=_6d0;}}}}_6c8.items.push(_6cc);}}var _6d2=true;return dojo.toJson(_6c8,_6d2);},_isEmpty:function(_6d3){var _6d4=true;if(dojo.isObject(_6d3)){var i;for(i in _6d3){_6d4=false;break;}}else{if(dojo.isArray(_6d3)){if(_6d3.length>0){_6d4=false;}}}return _6d4;},save:function(_6d6){this._assert(!this._saveInProgress);this._saveInProgress=true;var self=this;var _6d8=function(){self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};self._saveInProgress=false;if(_6d6&&_6d6.onComplete){var _6d9=_6d6.scope||dojo.global;_6d6.onComplete.call(_6d9);}};var _6da=function(err){self._saveInProgress=false;if(_6d6&&_6d6.onError){var _6dc=_6d6.scope||dojo.global;_6d6.onError.call(_6dc,err);}};if(this._saveEverything){var _6dd=this._getNewFileContentString();this._saveEverything(_6d8,_6da,_6dd);}if(this._saveCustom){this._saveCustom(_6d8,_6da);}if(!this._saveEverything&&!this._saveCustom){_6d8();}},revert:function(){this._assert(!this._saveInProgress);var _6de;for(_6de in this._pending._modifiedItems){var _6df=this._pending._modifiedItems[_6de];var _6e0=null;if(this._itemsByIdentity){_6e0=this._itemsByIdentity[_6de];}else{_6e0=this._arrayOfAllItems[_6de];}_6df[this._storeRefPropName]=this;_6e0[this._storeRefPropName]=null;var _6e1=_6e0[this._itemNumPropName];this._arrayOfAllItems[_6e1]=_6df;if(_6e0[this._rootItemPropName]){var i;for(i=0;i<this._arrayOfTopLevelItems.length;i++){var _6e3=this._arrayOfTopLevelItems[i];if(this.getIdentity(_6e3)==_6de){this._arrayOfTopLevelItems[i]=_6df;break;}}}if(this._itemsByIdentity){this._itemsByIdentity[_6de]=_6df;}}var _6e4;for(_6de in this._pending._deletedItems){_6e4=this._pending._deletedItems[_6de];_6e4[this._storeRefPropName]=this;var _6e5=_6e4[this._itemNumPropName];if(_6e4["backup_"+this._reverseRefMap]){_6e4[this._reverseRefMap]=_6e4["backup_"+this._reverseRefMap];delete _6e4["backup_"+this._reverseRefMap];}this._arrayOfAllItems[_6e5]=_6e4;if(this._itemsByIdentity){this._itemsByIdentity[_6de]=_6e4;}if(_6e4[this._rootItemPropName]){this._arrayOfTopLevelItems.push(_6e4);}}for(_6de in this._pending._deletedItems){_6e4=this._pending._deletedItems[_6de];if(_6e4["backupRefs_"+this._reverseRefMap]){dojo.forEach(_6e4["backupRefs_"+this._reverseRefMap],function(_6e6){var _6e7;if(this._itemsByIdentity){_6e7=this._itemsByIdentity[_6e6.id];}else{_6e7=this._arrayOfAllItems[_6e6.id];}this._addReferenceToMap(_6e7,_6e4,_6e6.attr);},this);delete _6e4["backupRefs_"+this._reverseRefMap];}}for(_6de in this._pending._newItems){var _6e8=this._pending._newItems[_6de];_6e8[this._storeRefPropName]=null;this._arrayOfAllItems[_6e8[this._itemNumPropName]]=null;if(_6e8[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,_6e8);}if(this._itemsByIdentity){delete this._itemsByIdentity[_6de];}}this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return true;},isDirty:function(item){if(item){var _6ea=this.getIdentity(item);return new Boolean(this._pending._newItems[_6ea]||this._pending._modifiedItems[_6ea]||this._pending._deletedItems[_6ea]).valueOf();}else{if(!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)){return true;}return false;}},onSet:function(item,_6ec,_6ed,_6ee){},onNew:function(_6ef,_6f0){},onDelete:function(_6f1){},close:function(_6f2){if(this.clearOnClose){if(!this.isDirty()){this.inherited(arguments);}else{if(this._jsonFileUrl!==""){throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");}}}}});}if(!dojo._hasResource["dojo.dnd.move"]){dojo._hasResource["dojo.dnd.move"]=true;dojo.provide("dojo.dnd.move");dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:false,markupFactory:function(_6f3,node){return new dojo.dnd.move.constrainedMoveable(node,_6f3);},constructor:function(node,_6f6){if(!_6f6){_6f6={};}this.constraints=_6f6.constraints;this.within=_6f6.within;},onFirstMove:function(_6f7){var c=this.constraintBox=this.constraints.call(this,_6f7);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=dojo.marginBox(_6f7.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(_6fa,_6fb){var c=this.constraintBox,s=_6fa.node.style;s.left=(_6fb.l<c.l?c.l:c.r<_6fb.l?c.r:_6fb.l)+"px";s.top=(_6fb.t<c.t?c.t:c.b<_6fb.t?c.b:_6fb.t)+"px";}});dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_6fe,node){return new dojo.dnd.move.boxConstrainedMoveable(node,_6fe);},constructor:function(node,_701){var box=_701&&_701.box;this.constraints=function(){return box;};}});dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_703,node){return new dojo.dnd.move.parentConstrainedMoveable(node,_703);},constructor:function(node,_706){var area=_706&&_706.area;this.constraints=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});dojo.dnd.move.constrainedMover=function(fun,_70d){dojo.deprecated("dojo.dnd.move.constrainedMover, use dojo.dnd.move.constrainedMoveable instead");var _70e=function(node,e,_711){dojo.dnd.Mover.call(this,node,e,_711);};dojo.extend(_70e,dojo.dnd.Mover.prototype);dojo.extend(_70e,{onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox,c=this.constraintBox,l=m.l+e.pageX,t=m.t+e.pageY;l=l<c.l?c.l:c.r<l?c.r:l;t=t<c.t?c.t:c.b<t?c.b:t;this.host.onMove(this,{l:l,t:t});},onFirstMove:function(){dojo.dnd.Mover.prototype.onFirstMove.call(this);var c=this.constraintBox=fun.call(this);c.r=c.l+c.w;c.b=c.t+c.h;if(_70d){var mb=dojo.marginBox(this.node);c.r-=mb.w;c.b-=mb.h;}}});return _70e;};dojo.dnd.move.boxConstrainedMover=function(box,_71a){dojo.deprecated("dojo.dnd.move.boxConstrainedMover, use dojo.dnd.move.boxConstrainedMoveable instead");return dojo.dnd.move.constrainedMover(function(){return box;},_71a);};dojo.dnd.move.parentConstrainedMover=function(area,_71c){dojo.deprecated("dojo.dnd.move.parentConstrainedMover, use dojo.dnd.move.parentConstrainedMoveable instead");var fun=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};return dojo.dnd.move.constrainedMover(fun,_71c);};dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;}if(!dojo._hasResource["dojo.dnd.TimedMoveable"]){dojo._hasResource["dojo.dnd.TimedMoveable"]=true;dojo.provide("dojo.dnd.TimedMoveable");(function(){var _722=dojo.dnd.Moveable.prototype.onMove;dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_724){if(!_724){_724={};}if(_724.timeout&&typeof _724.timeout=="number"&&_724.timeout>=0){this.timeout=_724.timeout;}},markupFactory:function(_725,node){return new dojo.dnd.TimedMoveable(node,_725);},onMoveStop:function(_727){if(_727._timer){clearTimeout(_727._timer);_722.call(this,_727,_727._leftTop);}dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);},onMove:function(_728,_729){_728._leftTop=_729;if(!_728._timer){var _t=this;_728._timer=setTimeout(function(){_728._timer=null;_722.call(_t,_728,_728._leftTop);},this.timeout);}}});})();}if(!dojo._hasResource["dojo.fx.Toggler"]){dojo._hasResource["dojo.fx.Toggler"]=true;dojo.provide("dojo.fx.Toggler");dojo.declare("dojo.fx.Toggler",null,{constructor:function(args){var _t=this;dojo.mixin(_t,args);_t.node=args.node;_t._showArgs=dojo.mixin({},args);_t._showArgs.node=_t.node;_t._showArgs.duration=_t.showDuration;_t.showAnim=_t.showFunc(_t._showArgs);_t._hideArgs=dojo.mixin({},args);_t._hideArgs.node=_t.node;_t._hideArgs.duration=_t.hideDuration;_t.hideAnim=_t.hideFunc(_t._hideArgs);dojo.connect(_t.showAnim,"beforeBegin",dojo.hitch(_t.hideAnim,"stop",true));dojo.connect(_t.hideAnim,"beforeBegin",dojo.hitch(_t.showAnim,"stop",true));},node:null,showFunc:dojo.fadeIn,hideFunc:dojo.fadeOut,showDuration:200,hideDuration:200,show:function(_72d){return this.showAnim.play(_72d||0);},hide:function(_72e){return this.hideAnim.play(_72e||0);}});}if(!dojo._hasResource["dojo.fx"]){dojo._hasResource["dojo.fx"]=true;dojo.provide("dojo.fx");(function(){var d=dojo,_730={_fire:function(evt,args){if(this[evt]){this[evt].apply(this,args||[]);}return this;}};var _733=function(_734){this._index=-1;this._animations=_734||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;d.forEach(this._animations,function(a){this.duration+=a.duration;if(a.delay){this.duration+=a.delay;}},this);};d.extend(_733,{_onAnimate:function(){this._fire("onAnimate",arguments);},_onEnd:function(){d.disconnect(this._onAnimateCtx);d.disconnect(this._onEndCtx);this._onAnimateCtx=this._onEndCtx=null;if(this._index+1==this._animations.length){this._fire("onEnd");}else{this._current=this._animations[++this._index];this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play(0,true);}},play:function(_736,_737){if(!this._current){this._current=this._animations[this._index=0];}if(!_737&&this._current.status()=="playing"){return this;}var _738=d.connect(this._current,"beforeBegin",this,function(){this._fire("beforeBegin");}),_739=d.connect(this._current,"onBegin",this,function(arg){this._fire("onBegin",arguments);}),_73b=d.connect(this._current,"onPlay",this,function(arg){this._fire("onPlay",arguments);d.disconnect(_738);d.disconnect(_739);d.disconnect(_73b);});if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");if(this._onEndCtx){d.disconnect(this._onEndCtx);}this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play.apply(this._current,arguments);return this;},pause:function(){if(this._current){var e=d.connect(this._current,"onPause",this,function(arg){this._fire("onPause",arguments);d.disconnect(e);});this._current.pause();}return this;},gotoPercent:function(_73f,_740){this.pause();var _741=this.duration*_73f;this._current=null;d.some(this._animations,function(a){if(a.duration<=_741){this._current=a;return true;}_741-=a.duration;return false;});if(this._current){this._current.gotoPercent(_741/this._current.duration,_740);}return this;},stop:function(_743){if(this._current){if(_743){for(;this._index+1<this._animations.length;++this._index){this._animations[this._index].stop(true);}this._current=this._animations[this._index];}var e=d.connect(this._current,"onStop",this,function(arg){this._fire("onStop",arguments);d.disconnect(e);});this._current.stop();}return this;},status:function(){return this._current?this._current.status():"stopped";},destroy:function(){if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}if(this._onEndCtx){d.disconnect(this._onEndCtx);}}});d.extend(_733,_730);dojo.fx.chain=function(_746){return new _733(_746);};var _747=function(_748){this._animations=_748||[];this._connects=[];this._finished=0;this.duration=0;d.forEach(_748,function(a){var _74a=a.duration;if(a.delay){_74a+=a.delay;}if(this.duration<_74a){this.duration=_74a;}this._connects.push(d.connect(a,"onEnd",this,"_onEnd"));},this);this._pseudoAnimation=new d._Animation({curve:[0,1],duration:this.duration});var self=this;d.forEach(["beforeBegin","onBegin","onPlay","onAnimate","onPause","onStop"],function(evt){self._connects.push(d.connect(self._pseudoAnimation,evt,function(){self._fire(evt,arguments);}));});};d.extend(_747,{_doAction:function(_74d,args){d.forEach(this._animations,function(a){a[_74d].apply(a,args);});return this;},_onEnd:function(){if(++this._finished==this._animations.length){this._fire("onEnd");}},_call:function(_750,args){var t=this._pseudoAnimation;t[_750].apply(t,args);},play:function(_753,_754){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this;},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this;},gotoPercent:function(_755,_756){var ms=this.duration*_755;d.forEach(this._animations,function(a){a.gotoPercent(a.duration<ms?1:(ms/a.duration),_756);});this._call("gotoPercent",arguments);return this;},stop:function(_759){this._doAction("stop",arguments);this._call("stop",arguments);return this;},status:function(){return this._pseudoAnimation.status();},destroy:function(){d.forEach(this._connects,dojo.disconnect);}});d.extend(_747,_730);dojo.fx.combine=function(_75a){return new _747(_75a);};dojo.fx.wipeIn=function(args){args.node=d.byId(args.node);var node=args.node,s=node.style,o;var anim=d.animateProperty(d.mixin({properties:{height:{start:function(){o=s.overflow;s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s.height="1px";s.display="";s.visibility="";return 1;}else{var _760=d.style(node,"height");return Math.max(_760,1);}},end:function(){return node.scrollHeight;}}}},args));d.connect(anim,"onEnd",function(){s.height="auto";s.overflow=o;});return anim;};dojo.fx.wipeOut=function(args){var node=args.node=d.byId(args.node),s=node.style,o;var anim=d.animateProperty(d.mixin({properties:{height:{end:1}}},args));d.connect(anim,"beforeBegin",function(){o=s.overflow;s.overflow="hidden";s.display="";});d.connect(anim,"onEnd",function(){s.overflow=o;s.height="auto";s.display="none";});return anim;};dojo.fx.slideTo=function(args){var node=args.node=d.byId(args.node),top=null,left=null;var init=(function(n){return function(){var cs=d.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=d.coords(n,true);top=ret.y;left=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=left+"px";}};})(node);init();var anim=d.animateProperty(d.mixin({properties:{top:args.top||0,left:args.left||0}},args));d.connect(anim,"beforeBegin",anim,init);return anim;};})();}if(!dojo._hasResource["dijit._DialogMixin"]){dojo._hasResource["dijit._DialogMixin"]=true;dojo.provide("dijit._DialogMixin");dojo.declare("dijit._DialogMixin",null,{attributeMap:dijit._Widget.prototype.attributeMap,execute:function(_770){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.attr("value"));},_getFocusItems:function(_771){var _772=dijit._getTabNavigable(dojo.byId(_771));this._firstFocusItem=_772.lowest||_772.first||_771;this._lastFocusItem=_772.last||_772.highest||this._firstFocusItem;if(dojo.isMoz&&this._firstFocusItem.tagName.toLowerCase()=="input"&&dojo.attr(this._firstFocusItem,"type").toLowerCase()=="file"){dojo.attr(_771,"tabindex","0");this._firstFocusItem=_771;}}});}if(!dojo._hasResource["dijit.DialogUnderlay"]){dojo._hasResource["dijit.DialogUnderlay"]=true;dojo.provide("dijit.DialogUnderlay");dojo.declare("dijit.DialogUnderlay",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' dojoAttachPoint='node'></div></div>",dialogId:"","class":"",attributeMap:{id:"domNode"},_setDialogIdAttr:function(id){dojo.attr(this.node,"id",id+"_underlay");},_setClassAttr:function(_774){this.node.className="dijitDialogUnderlay "+_774;},postCreate:function(){dojo.body().appendChild(this.domNode);this.bgIframe=new dijit.BackgroundIframe(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _777=dijit.getViewport();os.top=_777.t+"px";os.left=_777.l+"px";is.width=_777.w+"px";is.height=_777.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();if(this.bgIframe.iframe){this.bgIframe.iframe.style.display="block";}},hide:function(){this.domNode.style.display="none";if(this.bgIframe.iframe){this.bgIframe.iframe.style.display="none";}},uninitialize:function(){if(this.bgIframe){this.bgIframe.destroy();}}});}if(!dojo._hasResource["dijit.TooltipDialog"]){dojo._hasResource["dijit.TooltipDialog"]=true;dojo.provide("dijit.TooltipDialog");dojo.declare("dijit.TooltipDialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{title:"",doLayout:false,autofocus:true,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:null,templateString:"<div waiRole=\"presentation\">\n\t<div class=\"dijitTooltipContainer\" waiRole=\"presentation\">\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" tabindex=\"-1\" waiRole=\"dialog\"></div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\" waiRole=\"presentation\"></div>\n</div>\n",postCreate:function(){this.inherited(arguments);this.connect(this.containerNode,"onkeypress","_onKey");this.containerNode.title=this.title;},orient:function(node,_779,_77a){var c=this._currentOrientClass;if(c){dojo.removeClass(this.domNode,c);}c="dijitTooltipAB"+(_77a.charAt(1)=="L"?"Left":"Right")+" dijitTooltip"+(_77a.charAt(0)=="T"?"Below":"Above");dojo.addClass(this.domNode,c);this._currentOrientClass=c;},onOpen:function(pos){this.orient(this.domNode,pos.aroundCorner,pos.corner);this._onShow();if(this.autofocus){this._getFocusItems(this.containerNode);dijit.focus(this._firstFocusItem);}},_onKey:function(evt){var node=evt.target;var dk=dojo.keys;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.containerNode);}var _780=(this._firstFocusItem==this._lastFocusItem);if(evt.charOrCode==dk.ESCAPE){this.onCancel();dojo.stopEvent(evt);}else{if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_780){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_780){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{if(evt.charOrCode===dk.TAB){evt.stopPropagation();}}}}}});}if(!dojo._hasResource["dijit.Dialog"]){dojo._hasResource["dijit.Dialog"]=true;dojo.provide("dijit.Dialog");dojo.declare("dijit.Dialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{templateString:null,templateString:"<div class=\"dijitDialog\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel, onmouseenter: _onCloseEnter, onmouseleave: _onCloseLeave\" title=\"${buttonCancel}\">\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n",attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}]}),open:false,duration:dijit.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,_fixSizes:true,postMixInProperties:function(){var _781=dojo.i18n.getLocalization("dijit","common");dojo.mixin(this,_781);this.inherited(arguments);},postCreate:function(){dojo.style(this.domNode,{visibility:"hidden",position:"absolute",display:"",top:"-9999px"});dojo.body().appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();this.inherited(arguments);},_endDrag:function(e){if(e&&e.node&&e.node===this.domNode){var vp=dijit.getViewport();var p=e._leftTop||dojo.coords(e.node,true);this._relativePosition={t:p.t-vp.t,l:p.l-vp.l};}},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=(dojo.isIE==6)?new dojo.dnd.TimedMoveable(node,{handle:this.titleBar}):new dojo.dnd.Moveable(node,{handle:this.titleBar,timeout:0});dojo.subscribe("/dnd/move/stop",this,"_endDrag");}else{dojo.addClass(node,"dijitDialogFixed");}var _786={dialogId:this.id,"class":dojo.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" ")};var _788=dijit._underlay;if(!_788){_788=dijit._underlay=new dijit.DialogUnderlay(_786);}this._fadeIn=dojo.fadeIn({node:node,duration:this.duration,beforeBegin:function(){_788.attr(_786);_788.show();},onEnd:dojo.hitch(this,function(){if(this.autofocus){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}})});this._fadeOut=dojo.fadeOut({node:node,duration:this.duration,onEnd:function(){node.style.visibility="hidden";node.style.top="-9999px";dijit._underlay.hide();}});},uninitialize:function(){var _789=false;if(this._fadeIn&&this._fadeIn.status()=="playing"){_789=true;this._fadeIn.stop();}if(this._fadeOut&&this._fadeOut.status()=="playing"){_789=true;this._fadeOut.stop();}if(this.open||_789){dijit._underlay.hide();}if(this._moveable){this._moveable.destroy();}},_size:function(){var mb=dojo.marginBox(this.domNode);var _78b=dijit.getViewport();if(mb.w>=_78b.w||mb.h>=_78b.h){dojo.style(this.containerNode,{width:Math.min(mb.w,Math.floor(_78b.w*0.75))+"px",height:Math.min(mb.h,Math.floor(_78b.h*0.75))+"px",overflow:"auto",position:"relative"});}},_position:function(){if(!dojo.hasClass(dojo.body(),"dojoMove")){var node=this.domNode;var _78d=dijit.getViewport();var p=this._relativePosition;var mb=p?null:dojo.marginBox(node);dojo.style(node,{left:Math.floor(_78d.l+(p?p.l:(_78d.w-mb.w)/2))+"px",top:Math.floor(_78d.t+(p?p.t:(_78d.h-mb.h)/2))+"px"});}},_onKey:function(evt){if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _793=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_793){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_793){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode){if(evt.charOrCode==dk.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOut.status()=="playing"){this._fadeOut.stop();}this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _794=dijit.getViewport();if(!this._oldViewport||_794.h!=this._oldViewport.h||_794.w!=this._oldViewport.w){this.layout();this._oldViewport=_794;}}));this._modalconnects.push(dojo.connect(dojo.doc.documentElement,"onkeypress",this,"_onKey"));dojo.style(this.domNode,{opacity:0,visibility:""});if(this._fixSizes){dojo.style(this.containerNode,{width:"auto",height:"auto"});}this.open=true;this._onShow();this._size();this._position();this._fadeIn.play();this._savedFocus=dijit.getFocus(this);},hide:function(){if(!this._alreadyInitialized){return;}if(this._fadeIn.status()=="playing"){this._fadeIn.stop();}this._fadeOut.play();if(this._scrollConnected){this._scrollConnected=false;}dojo.forEach(this._modalconnects,dojo.disconnect);this._modalconnects=[];if(this.refocus){this.connect(this._fadeOut,"onEnd",dojo.hitch(dijit,"focus",this._savedFocus));}if(this._relativePosition){delete this._relativePosition;}this.open=false;},layout:function(){if(this.domNode.style.visibility!="hidden"){dijit._underlay.layout();this._position();}},destroy:function(){dojo.forEach(this._modalconnects,dojo.disconnect);if(this.refocus&&this.open){setTimeout(dojo.hitch(dijit,"focus",this._savedFocus),25);}this.inherited(arguments);},_onCloseEnter:function(){dojo.addClass(this.closeButtonNode,"dijitDialogCloseIcon-hover");},_onCloseLeave:function(){dojo.removeClass(this.closeButtonNode,"dijitDialogCloseIcon-hover");}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.NetworkStatusIndicator"]){dojo._hasResource["nox.ext.apps.commonui.coreui.NetworkStatusIndicator"]=true;dojo.provide("nox.ext.apps.commonui.coreui.NetworkStatusIndicator");dojo.declare("nox.ext.apps.commonui.coreui.NetworkStatusTooltip",dijit.TooltipDialog,{templateString:"<div waiRole=\"presentation\">\n\t<div class=\"dijitTooltipContainer\" waiRole=\"presentation\">\n\t\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t\t\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\">${title}</span>\n\t\t\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: _closeMe\" title=\"${buttonCancel}\">\n\t\t\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" tabindex=\"-1\" waiRole=\"dialog\"></div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\" waiRole=\"presentation\"></div>\n</div>\n",title:"Network Status Changed",autofocus:false,open:false,buttonCancel:"Cancel",_fadeOutTimeout:null,postCreate:function(){this.inherited(arguments);dojo.addClass(this.domNode,"networkStatusTooltip");this._fadeOut=dojo.fadeOut({node:this.domNode,duration:dijit.defaultDuration,onEnd:dojo.hitch(this,"_closeMe")});this._fadeIn=dojo.fadeIn({node:this.domNode,duration:dijit.defaultDuration});},onOpen:function(){this.inherited(arguments);this.open=true;},onClose:function(){this.open=false;this.attr("content","");},addMessage:function(msg){var _796="<div class=\"message "+msg["status"]+"\">"+"<span>"+msg.item_ui_monitor_link_text+"<span> "+msg.message+"</span></span><br />"+"<span class=\"dateTime\">"+msg.dateTime+"</span>"+"</div>";if(this.open){clearTimeout(this._fadeOutTimeout);if(this._fadeOut.status()=="playing"){this._fadeOut.stop();this._fadeIn.play();}var _797=this.attr("content");this.attr("content",_796+_797);}else{this.attr("content",_796);}dijit.popup.open({parent:this.parentWidget,popup:this,around:this.aroundNode,orient:{"TL":"BL"}});var self=this;this._fadeOutTimeout=setTimeout(function(){self._fadeOut.play();},5000);},_closeMe:function(){clearTimeout(this._fadeOutTimeout);if(this._fadeOut.status()=="playing"){this._fadeOut.stop();}dijit.popup.close(this);dojo.style(this.domNode,"opacity",1);delete this._fadeOutTimeout;}});dojo.declare("nox.ext.apps.commonui.coreui.NetworkStatusIndicator",[dijit.layout.BorderContainer,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\t<div dojoType=\"dijit.layout.ContentPane\" dojoAttachPoint=\"statusContainer\" region=\"top\" id=\"networkStatusType\">\n\t\t<table cellspacing=\"0\" class=\"networkStatusTitleBar\">\n\t\t\t<tr>\n\t\t\t\t<td class=\"collapseToggleContainer\" dojoAttachPoint=\"toggleContainer\" align=\"center\" dojoAttachEvent=\"onclick: onToggle\"><div class=\"collapseToggle\"></div></td>\n\t\t\t\t<td class=\"statusContainer\">Network Status: <span class=\"networkStatusTitle\" dojoAttachPoint=\"statusTextNode\">Good</span></td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t<div dojoType=\"dijit.layout.ContentPane\" region=\"bottom\" id=\"statusMessageToggle\">\n\t\t<input dojoType=\"dijit.form.CheckBox\" dojoAttachPoint=\"notificationCheck\" dojoAttachEvent=\"onChange: onNotificationsToggle\" value=\"showAleft\" checked=\"true\" />\n\t\t<span>Show notification on status change</span>\n\t</div>\n</div>\n",widgetsInTemplate:true,splitter:true,minSize:28,maxSize:350,store:null,tooltip:null,"status":"normal",status_map:{normal:["Good","Normal"],minor:["Minor Issue","Minor"],major:["Serious Issue","Major"]},state:{defaultSize:150,expanded:true,showNotifications:true},constructor:function(){var item={item_name:"Switch 0001",item_ui_monitor_link_text:"<a href=''>Switch 0001</a>",message:"cannot be reached. Error 40102","status":"major",solution:"Brief solution text",solution_link_text:"<a href=''>Action link here</a>",dateTime:null};var _79a=[];for(var i=0;i<50;i++){var st="normal";var m=i%3;if(m==0){st="normal";}else{if(m==1){st="minor";}else{if(m==2){st="major";}}}_79a.push(dojo.mixin(dojo.clone(item),{"status":st}));_79a[i].dateTime=(new Date()).toString();}this.store=new dojo.data.ItemFileWriteStore({data:{items:_79a}});if(dojo.cookie.isSupported()){var _79e=dojo.cookie("NOX_Network_Status_Indicator");if(_79e){dojo.mixin(this.state,dojo.fromJson(_79e));}}this._saveState();},postCreate:function(){this.inherited(arguments);var _79f=this.messages=new dojox.grid.DataGrid({store:this.store,query:{},region:"center",selectionMode:"none",getSortProps:function(){return [{attribute:"dateTime",descending:true}];},structure:[{name:"message",width:"auto",get:function(_7a0,item){if(!item){return null;}var _7a2=item.item_ui_monitor_link_text;var _7a3=item.message;var time=item.dateTime;return "<div class=\"message "+item["status"]+"\">"+"<span>"+_7a2+"<span> "+_7a3+"</span></span><br />"+"<span class=\"dateTime\">"+time+"</span>"+"</div>";}}]});this.addChild(_79f);_79f.startup();var _7a5=this.gridTooltip=new dijit._MasterTooltip();dojo.addClass(this.gridTooltip.domNode,"networkStatusGridTooltip");var _7a6=[];var _7a7=[];var self=this;var _7a9=[];var _7aa=function(_7ab){dojo.forEach(_7a9[_7ab],dojo.disconnect);_7a9[_7ab]=[];};var _7ac=function(_7ad,cell,e){clearTimeout(_7a7[_7ad]);_7a7[_7ad]=null;};var _7b0=function(_7b1,cell,e){_7a7[_7b1]=setTimeout(function(){_7a5.hide(cell);_7a7[_7b1]=null;_7aa(_7b1);},500);};var _7b4=function(e){if(_7a7[e.rowIndex]){clearTimeout(_7a7[e.rowIndex]);_7a7[e.rowIndex]=null;return;}var idx=e.rowIndex;var item=_79f.getItem(idx);var text=item.solution+"<br />"+item.solution_link_text;_7a6[idx]=setTimeout(function(){_7a5.show(text,e.cellNode,["above"]);if(!_7a9[idx]||!_7a9[idx].length){_7a9[idx]=[];_7a9[idx].push(dojo.connect(_7a5.domNode,"onmouseenter",dojo.partial(_7ac,idx,e.cellNode)));_7a9[idx].push(dojo.connect(_7a5.domNode,"onmouseleave",dojo.partial(_7b0,idx,e.cellNode)));}},500);};var _7b9=function(e){clearTimeout(_7a6[e.rowIndex]);_7a7[e.rowIndex]=setTimeout(function(){_7a5.hide(e.cellNode);_7a7[e.rowIndex]=null;_7aa(e.rowIndex);},500);};this.connect(_79f,"onCellMouseOver",_7b4);this.connect(_79f,"onCellMouseOut",_7b9);this.connect(this.store,"onNew","onNewStatus");this.store.fetch({query:{},count:1,sort:[{attribute:"dateTime",descending:true}],onComplete:dojo.hitch(this,function(_7bb){var item=_7bb[0];this.attr("status",item["status"]);})});var _7bd=this.minSize;if(this.state.expanded){_7bd=this.state.defaultSize;}dojo.style(this.domNode,{height:_7bd+"px"});this._setExpandedClass();this.notificationCheck.attr("checked",this.state.showNotifications);},_saveState:function(){if(dojo.cookie.isSupported()){var _7be=dojo.toJson(this.state);if(dojo.cookie("NOX_Network_Status_Indicator")!=_7be){dojo.cookie("NOX_Network_Status_Indicator",dojo.toJson(this.state),{expires:365,path:"/"});}}},_setExpandedClass:function(){dojo.addClass(this.domNode,this.state.expanded?"open":"closed");dojo.removeClass(this.domNode,this.state.expanded?"closed":"open");},resize:function(){this.inherited(arguments);var _7bf=dojo.marginBox(this.domNode).h;if(_7bf>30){this.state.expanded=true;this.state.defaultSize=_7bf;}else{this.state.expanded=false;}this._setExpandedClass();this._saveState();},onToggle:function(){if(this.state.expanded){this.state.defaultSize=dojo.marginBox(this.domNode).h;this.resize({h:this.minSize});}else{this.resize({h:this.state.defaultSize});}this.state.expanded=!this.state.expanded;this._setExpandedClass();this.getParent().resize();},onNotificationsToggle:function(){this.state.showNotifications=this.notificationCheck.attr("checked");this._saveState();},_setStatusAttr:function(st){if(!this.status_map[st]){var st="normal";}var stat=this.status_map[st];var _7c2=this.status_map[this["status"]];dojo.removeClass(this.statusContainer.domNode,"networkStatus"+_7c2[1]);dojo.addClass(this.statusContainer.domNode,"networkStatus"+stat[1]);this.statusTextNode.innerHTML=stat[0];this["status"]=st;return st;},onNewStatus:function(item){this.attr("status",item["status"]);if(this.state.showNotifications&&!this.state.expanded&&item["status"]!="normal"){if(!this.tooltip){this.tooltip=new nox.ext.apps.commonui.coreui.NetworkStatusTooltip({title:"Network Status Changed",autofocus:false,parentWidget:this,aroundNode:this.toggleContainer});dijit.popup.prepare(this.tooltip.domNode);}this.tooltip.addMessage(item);}this.messages.render();}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateErrorHandler"]){dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateErrorHandler"]=true;dojo.provide("nox.ext.apps.commonui.coreui.UpdateErrorHandler");(function(){var msgs=null;var ueh=nox.ext.apps.commonui.coreui.UpdateErrorHandler;var _7c6=false;ueh.onError=function(_7c7,args){};ueh.showError=function(_7c9,args){ueh.onError(_7c9,args);_7c6=true;};var _7cb=function(_7cc,_7cd){var loc=document.location;document.location="/login?last_page="+encodeURIComponent(loc.pathname+loc.search);};ueh.defaultHandlers={0:function(_7cf,_7d0){ueh.showError("HTTP connection to "+document.location.host+" failed.",{header_msg:"Server is Unreachable:",hide_dismiss:true});},400:function(_7d1,_7d2){e=dojo.fromJson(_7d1.responseText);ueh.showError(e.displayError,{header_msg:"Request Error:"});},401:_7cb,403:_7cb,404:function(_7d3,_7d4){ueh.showError("The current page/resource does not exist or is inactive",{header_msg:"Page Not Found:"});},409:function(_7d5,_7d6){e=dojo.fromJson(_7d5.responseText);ueh.showError(e.displayError,{header_msg:"Server Conflict:"});},500:function(_7d7,_7d8){e=dojo.fromJson(_7d7.responseText);ueh.showError(e.displayError,{header_msg:"Server Error:"});},"user-dismissed-error":function(_7d9,_7da){return false;},timeout:function(_7db,_7dc){ueh.showError("Server at "+document.location.host+" is taking too "+"long to respond.",{header_msg:"Server Timeout:",hide_dismiss:true});},cancel:function(_7dd,_7de){return;}};ueh.get_error_type=function(_7df){var err=null;if(_7df.dojoType!=null){err=_7df.dojoType;}else{if(_7df.status!=null){err=_7df.status;}}return err;};ueh.handler=function(){var _7e1=arguments[0];var err=ueh.get_error_type(_7e1);if(err==null){console_log("unidentified error, arguments: ",arguments);ueh.showError(_7e1.toString(),{header_msg:"Browser Error:",hide_retry:true});return true;}if(this.customHandlers[err]!=null){this.customHandlers[err].apply(this.scope,arguments);}else{if(ueh.defaultHandlers[err]!=null){ueh.defaultHandlers[err].apply(this,arguments);}else{console_log("unhandled_error: ",err.toString());ueh.showError(err.toString(),{header_msg:"Browser Error:",hide_retry:true});return true;}}if(_7c6){_7c6=false;return true;}return false;};ueh.create=function(_7e3,_7e4){if(msgs==null){msgs=dojo.i18n.getLocalization("nox.ext.apps.commonui.coreui","UpdateErrors");}var _7e5={scope:_7e3,defaultHandlers:ueh.defaultHandlers,customHandlers:(_7e4!=null)?_7e4:{}};return function(){return ueh.handler.apply(_7e5,arguments);};};ueh.kwCreate=function(_7e6){if(_7e6.errorHandlers!=undefined){return ueh.create(_7e6.scope,_7e6.errorHandlers);}else{if(_7e6.onError!=undefined){return dojo.hitch(_7e6.scope,_7e6.onError);}else{return ueh.create(_7e6.scope,{});}}};})();}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateMgr"]){dojo._hasResource["nox.ext.apps.commonui.coreui.UpdateMgr"]=true;dojo.provide("nox.ext.apps.commonui.coreui.UpdateMgr");var corui=nox.ext.apps.commonui.coreui;dojo.declare("nox.ext.apps.commonui.coreui.UpdateMgr",[],{dojo_xhr_functions:{"GET":dojo.xhrGet,"PUT":dojo.rawXhrPut,"POST":dojo.rawXhrPost,"DELETE":dojo.xhrDelete},constructor:function(){this.recurrence_period=10;this._suspended=false;this._period_remaining=null;this._current_timeout=null;this._pending_updates=[];this._current_update=null;this._pending_processing=[];this._recurring_updates=[];this._mousemove_timeout=null;this._retry_pending=false;var o=this;this._countdown_timeout_handler=function(){o._handle_countdown_timeout();};this._processing_timeout_handler=function(){o._handle_processing_timeout();};this._suspend_timeout_handler=function(){o._make_request();o._setup_timeout();};this._mousemove_timeout_handler=function(){o._mousemove_timeout=null;o.resume();};this._suspend_on_mousemove_handler=function(){o.suspend();if(o._mousemove_timeout!=null){clearTimeout(o._mousemove_timeout);}o._mousemove_timeout=setTimeout(o._mousemove_timeout_handler,500);};},_call_user_fn:function(args){if(typeof (args.fn)!="function"){throw Error("Call update method must provide function to call in the fn parameter");}if(typeof (args.purpose)!="string"){throw Error("Call update method must provide string describing reason for call in the purpose parameter");}var data=args.data;var _7ea=args.scope;if(_7ea==null){_7ea=dojo.global;}var _7eb=args.fn.call(_7ea,data);args.load.call(this,_7eb,args);},_make_request:function(){if(this._current_update!=null||this._pending_updates.length==0){return;}if(this._current_timeout!=null){clearTimeout(this._current_timeout);this._current_timeout=null;}if(this._suspended==true){return;}this._period_remaining=null;this._current_update=this._pending_updates.shift();with(this._current_update){if(request_method!="USERFN"){if(args.url_fn!=null){args.url=args.url_fn();}this.onMakeRequest(request_method,args.url);}else{this.onUserFunctionCall(args.purpose);}this._current_update.request=xhr_fn.call(this,args);}},_handle_countdown_timeout:function(){if(this._current_timeout==null||this._period_remaining==null){return;}this._current_timeout=null;this.onCountdownTick(--this._period_remaining);if(this._period_remaining==0){this._period_remaining=null;for(var i=0;i<this._recurring_updates.length;i++){this._pending_updates.push(this._recurring_updates[i]);}this._make_request();}this._setup_timeout();},_handle_processing_timeout:function(){var _7ed=100;this._current_timeout=null;if(this._suspended==false){var l=this._pending_processing;this._pending_processing=[];for(var i=0;i<l.length;i++){var c=l[i].work.next_fn(l[i].work.state);if(c!=null){if(c.progress==null||c.progress<0||c.progress>100){throw Error("Long-running processing didn't set progress correctly");l[i].work=c;this._pending_processing.push(l[i]);}else{if(c.progress<100){l[i].work=c;this._pending_processing.push(l[i]);}}_7ed=Math.min(_7ed,c.progress);}}if(this._current_update==null&&this._pending_updates.length==0){this.onResponseProcessingTick(this._pending_processing,_7ed);}}this._setup_timeout();},_setup_timeout:function(){if(this._current_timeout!=null){clearTimeout(this._current_timeout);this._current_timeout=null;this._period_remaining=null;}if(this._pending_processing.length>0){this._current_timeout=setTimeout(this._processing_timeout_handler,1);}else{if(this._current_update!=null){return;}else{if(this._pending_updates.length>0){if(!this._suspended){this._make_request();return;}this._current_timeout=setTimeout(this._suspend_timeout_handler,100);}else{if(this._recurring_updates.length>0){if(this._period_remaining==null){this.onCountdownStart(this.recurrence_period);this._period_remaining=this.recurrence_period;}this._current_timeout=setTimeout(this._countdown_timeout_handler,1000);}else{this.onUpdateComplete();}}}}},_initial_response_processing:function(_7f1){if(_7f1.cb_fn!=null){return _7f1.cb_fn.call(null,_7f1.response,_7f1.ioArgs);}return null;},_check_response_processing_start:function(){if(this._pending_processing.length>0){if(this._current_update==null&&this._pending_updates.length==0){this.onResponseProcessingStart(this._pending_processing);}this._handle_processing_timeout();}},_handle_response_callback:function(_7f2,_7f3,_7f4){this._pending_processing.push({update:this._current_update,work:{progress:0,next_fn:this._initial_response_processing,state:{"cb_fn":_7f4,"response":_7f2,"ioArgs":_7f3}}});this._current_update=null;this._make_request();this._check_response_processing_start();},_handle_error_callback:function(_7f5,_7f6,_7f7){if(!_7f7.call(null,_7f5,_7f6)){this._pending_processing.push({update:this._current_update,work:{progress:0,next_fn:function(_7f8){return null;},state:{}}});this._current_update=null;this._make_request();this._check_response_processing_start();}else{this._retry_pending=true;}},_wrap_callbacks:function(args){var o=this;var _7fb=args.load;args.load=function(rsp,_7fd){o._handle_response_callback(rsp,_7fd,_7fb);};var _7fe=args.error;args.error=function(rsp,_800){o._handle_error_callback(rsp,_800,_7fe);};return args;},retry_failed_request:function(){if(!this._retry_pending){return;}this._retry_pending=false;this._pending_updates.unshift(this._current_update);this._current_update=null;this._make_request();this._check_response_processing_start();},skip_failed_request:function(){if(!this._retry_pending){return;}if(this._current_update.args.error!=undefined){this._current_update.args.error.call(null,{status:"user-dismissed-error"},this._current_update.args);}this._retry_pending=false;this._current_update=null;this._setup_timeout();},xhr:function(_801,args){if(this._pending_updates.length==0&&this._pending_processing.length==0&&this._recurring_updates.length==0&&this._current_update==null){this.onUpdateStart();}var _803=_801.toUpperCase();if(_803=="USERFN"){var fn=this._call_user_fn;}else{fn=this.dojo_xhr_functions[_803];if(args.errorHandlers!=null){args.error=coreui.UpdateErrorHandler.create(null,args.errorHandlers);}if(args.error==null){console_log("FIXME: caller didn't install error handler for request: ",_801," ",args);args.error=coreui.UpdateErrorHandler.create();}}if(fn==null){throw Error("Unknown update method");}var _805={"request_method":_801.toUpperCase(),"xhr_fn":fn,"args":this._wrap_callbacks(args),"cancel":dojo.hitch(this,function(){this.cancelUpdate(_805);})};if(args.recur!=null&&args.recur==true){this._recurring_updates.push(_805);}this._pending_updates.push(_805);this._make_request();return _805;},xhrGet:function(args){return this.xhr("GET",args);},rawXhrPut:function(args){return this.xhr("PUT",args);},rawXhrPost:function(args){return this.xhr("POST",args);},xhrDelete:function(args){return this.xhr("DELETE",args);},userFnCall:function(args){return this.xhr("USERFN",args);},cancelUpdate:function(_80b){this._pending_updates=dojo.filter(this._pending_updates,function(i){return i!=_80b;});this._recurring_updates=dojo.filter(this._recurring_updates,function(i){return i!=_80b;});},cancelRecurring:function(){this._recurring_updates=[];},cancelPending:function(){if(this._current_update!=null){this._current_update.request.cancel();this._current_update=null;}this._pending_updates=[];},cancelProcessing:function(){this._pending_processing=[];},cancelAll:function(){this.cancelRecurring();this.cancelPending();this.cancelProcessing();},suspend:function(){if(this._suspended==false){this._suspended=true;this.onSuspend();}},resume:function(){if(this._suspended==true){this._suspended=false;this.onResume();}},suspendDuringMousemoveOn:function(e){dojo.connect(e,"mousemove",this,"_suspend_on_mousemove_handler");},updateNow:function(){if(this._period_remaining==null){if(this._pending_updates.length>0){return;}}if(this._current_timeout!=null){clearTimeout(this._current_timeout);}this._period_remaining=1;this._current_timeout=0;this._handle_countdown_timeout();},onUpdateStart:function(){},onUpdateComplete:function(){},onMakeRequest:function(_80f,uri){},onUserFunctionCall:function(_811){},onResponseProcessingStart:function(_812){},onResponseProcessingTick:function(_813,_814){},onCountdownStart:function(_815){},onCountdownTick:function(_816){},onSuspend:function(){},onResume:function(){},installDebugLogging:function(){dojo.connect(this,"onUpdateStart",function(){console_log("UpdateMgr: Starting update");});dojo.connect(this,"onUpdateComplete",function(){console_log("UpdateMgr: Update compeleted");});dojo.connect(this,"onMakeRequest",function(_817,uri){console_log("UpdateMgr: Making request: ",_817," ",uri);});dojo.connect(this,"onUserFunctionCall",function(_819){console_log("UpdateMgr: calling user function for ",_819);});dojo.connect(this,"onResponseProcessingStart",function(_81a){console_log("UpdateMgr: Starting response processing on:",_81a);});dojo.connect(this,"onResponseProcessingTick",function(_81b,_81c){console_log("UpdateMgr: Continuing response processing on: ",_81b);console_log("UpdateMgr: minimum progress of processing jobs is: ",_81c);});dojo.connect(this,"onCountdownStart",function(_81d){console_log("UpdateMgr: Starting update delay countdown of ",_81d," seconds");});dojo.connect(this,"onCountdownTick",function(_81e){console_log("UpdateMgr: Counting down delay, ",_81e," seconds remaining.");});dojo.connect(this,"onSuspend",function(){console_log("UpdateMgr: updates suspended");});dojo.connect(this,"onResume",function(){console_log("UpdateMgr: updates resumed");});}});(function(){var _81f=null;nox.ext.apps.commonui.coreui.getUpdateMgr=function(){if(_81f==null){_81f=new nox.ext.apps.commonui.coreui.UpdateMgr();}return _81f;};})();}if(!dojo._hasResource["dojo.number"]){dojo._hasResource["dojo.number"]=true;dojo.provide("dojo.number");dojo.number.format=function(_820,_821){_821=dojo.mixin({},_821||{});var _822=dojo.i18n.normalizeLocale(_821.locale);var _823=dojo.i18n.getLocalization("dojo.cldr","number",_822);_821.customs=_823;var _824=_821.pattern||_823[(_821.type||"decimal")+"Format"];if(isNaN(_820)||Math.abs(_820)==Infinity){return null;}return dojo.number._applyPattern(_820,_824,_821);};dojo.number._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;dojo.number._applyPattern=function(_825,_826,_827){_827=_827||{};var _828=_827.customs.group;var _829=_827.customs.decimal;var _82a=_826.split(";");var _82b=_82a[0];_826=_82a[(_825<0)?1:0]||("-"+_82b);if(_826.indexOf("%")!=-1){_825*=100;}else{if(_826.indexOf("")!=-1){_825*=1000;}else{if(_826.indexOf("")!=-1){_828=_827.customs.currencyGroup||_828;_829=_827.customs.currencyDecimal||_829;_826=_826.replace(/\u00a4{1,3}/,function(_82c){var prop=["symbol","currency","displayName"][_82c.length-1];return _827[prop]||_827.currency||"";});}else{if(_826.indexOf("E")!=-1){throw new Error("exponential notation not supported");}}}}var _82e=dojo.number._numberPatternRE;var _82f=_82b.match(_82e);if(!_82f){throw new Error("unable to find a number expression in pattern: "+_826);}if(_827.fractional===false){_827.places=0;}return _826.replace(_82e,dojo.number._formatAbsolute(_825,_82f[0],{decimal:_829,group:_828,places:_827.places,round:_827.round}));};dojo.number.round=function(_830,_831,_832){var _833=10/(_832||10);return (_833*+_830).toFixed(_831)/_833;};if((0.9).toFixed()==0){(function(){var _834=dojo.number.round;dojo.number.round=function(v,p,m){var d=Math.pow(10,-p||0),a=Math.abs(v);if(!v||a>=d||a*Math.pow(10,p+1)<5){d=0;}return _834(v,p,m)+(v>0?d:-d);};})();}dojo.number._formatAbsolute=function(_83a,_83b,_83c){_83c=_83c||{};if(_83c.places===true){_83c.places=0;}if(_83c.places===Infinity){_83c.places=6;}var _83d=_83b.split(".");var _83e=(_83c.places>=0)?_83c.places:(_83d[1]&&_83d[1].length)||0;if(!(_83c.round<0)){_83a=dojo.number.round(_83a,_83e,_83c.round);}var _83f=String(Math.abs(_83a)).split(".");var _840=_83f[1]||"";if(_83c.places){var _841=dojo.isString(_83c.places)&&_83c.places.indexOf(",");if(_841){_83c.places=_83c.places.substring(_841+1);}_83f[1]=dojo.string.pad(_840.substr(0,_83c.places),_83c.places,"0",true);}else{if(_83d[1]&&_83c.places!==0){var pad=_83d[1].lastIndexOf("0")+1;if(pad>_840.length){_83f[1]=dojo.string.pad(_840,pad,"0",true);}var _843=_83d[1].length;if(_843<_840.length){_83f[1]=_840.substr(0,_843);}}else{if(_83f[1]){_83f.pop();}}}var _844=_83d[0].replace(",","");pad=_844.indexOf("0");if(pad!=-1){pad=_844.length-pad;if(pad>_83f[0].length){_83f[0]=dojo.string.pad(_83f[0],pad);}if(_844.indexOf("#")==-1){_83f[0]=_83f[0].substr(_83f[0].length-pad);}}var _845=_83d[0].lastIndexOf(",");var _846,_847;if(_845!=-1){_846=_83d[0].length-_845-1;var _848=_83d[0].substr(0,_845);_845=_848.lastIndexOf(",");if(_845!=-1){_847=_848.length-_845-1;}}var _849=[];for(var _84a=_83f[0];_84a;){var off=_84a.length-_846;_849.push((off>0)?_84a.substr(off):_84a);_84a=(off>0)?_84a.slice(0,off):"";if(_847){_846=_847;delete _847;}}_83f[0]=_849.reverse().join(_83c.group||",");return _83f.join(_83c.decimal||".");};dojo.number.regexp=function(_84c){return dojo.number._parseInfo(_84c).regexp;};dojo.number._parseInfo=function(_84d){_84d=_84d||{};var _84e=dojo.i18n.normalizeLocale(_84d.locale);var _84f=dojo.i18n.getLocalization("dojo.cldr","number",_84e);var _850=_84d.pattern||_84f[(_84d.type||"decimal")+"Format"];var _851=_84f.group;var _852=_84f.decimal;var _853=1;if(_850.indexOf("%")!=-1){_853/=100;}else{if(_850.indexOf("")!=-1){_853/=1000;}else{var _854=_850.indexOf("")!=-1;if(_854){_851=_84f.currencyGroup||_851;_852=_84f.currencyDecimal||_852;}}}var _855=_850.split(";");if(_855.length==1){_855.push("-"+_855[0]);}var re=dojo.regexp.buildGroupRE(_855,function(_857){_857="(?:"+dojo.regexp.escapeString(_857,".")+")";return _857.replace(dojo.number._numberPatternRE,function(_858){var _859={signed:false,separator:_84d.strict?_851:[_851,""],fractional:_84d.fractional,decimal:_852,exponent:false};var _85a=_858.split(".");var _85b=_84d.places;if(_85a.length==1||_85b===0){_859.fractional=false;}else{if(_85b===undefined){_85b=_84d.pattern?_85a[1].lastIndexOf("0")+1:Infinity;}if(_85b&&_84d.fractional==undefined){_859.fractional=true;}if(!_84d.places&&(_85b<_85a[1].length)){_85b+=","+_85a[1].length;}_859.places=_85b;}var _85c=_85a[0].split(",");if(_85c.length>1){_859.groupSize=_85c.pop().length;if(_85c.length>1){_859.groupSize2=_85c.pop().length;}}return "("+dojo.number._realNumberRegexp(_859)+")";});},true);if(_854){re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(_85d,_85e,_85f,_860){var prop=["symbol","currency","displayName"][_85f.length-1];var _862=dojo.regexp.escapeString(_84d[prop]||_84d.currency||"");_85e=_85e?"[\\s\\xa0]":"";_860=_860?"[\\s\\xa0]":"";if(!_84d.strict){if(_85e){_85e+="*";}if(_860){_860+="*";}return "(?:"+_85e+_862+_860+")?";}return _85e+_862+_860;});}return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:_851,decimal:_852,factor:_853};};dojo.number.parse=function(_863,_864){var info=dojo.number._parseInfo(_864);var _866=(new RegExp("^"+info.regexp+"$")).exec(_863);if(!_866){return NaN;}var _867=_866[1];if(!_866[1]){if(!_866[2]){return NaN;}_867=_866[2];info.factor*=-1;}_867=_867.replace(new RegExp("["+info.group+"\\s\\xa0"+"]","g"),"").replace(info.decimal,".");return _867*info.factor;};dojo.number._realNumberRegexp=function(_868){_868=_868||{};if(!("places" in _868)){_868.places=Infinity;}if(typeof _868.decimal!="string"){_868.decimal=".";}if(!("fractional" in _868)||/^0/.test(_868.places)){_868.fractional=[true,false];}if(!("exponent" in _868)){_868.exponent=[true,false];}if(!("eSigned" in _868)){_868.eSigned=[true,false];}var _869=dojo.number._integerRegexp(_868);var _86a=dojo.regexp.buildGroupRE(_868.fractional,function(q){var re="";if(q&&(_868.places!==0)){re="\\"+_868.decimal;if(_868.places==Infinity){re="(?:"+re+"\\d+)?";}else{re+="\\d{"+_868.places+"}";}}return re;},true);var _86d=dojo.regexp.buildGroupRE(_868.exponent,function(q){if(q){return "([eE]"+dojo.number._integerRegexp({signed:_868.eSigned})+")";}return "";});var _86f=_869+_86a;if(_86a){_86f="(?:(?:"+_86f+")|(?:"+_86a+"))";}return _86f+_86d;};dojo.number._integerRegexp=function(_870){_870=_870||{};if(!("signed" in _870)){_870.signed=[true,false];}if(!("separator" in _870)){_870.separator="";}else{if(!("groupSize" in _870)){_870.groupSize=3;}}var _871=dojo.regexp.buildGroupRE(_870.signed,function(q){return q?"[-+]":"";},true);var _873=dojo.regexp.buildGroupRE(_870.separator,function(sep){if(!sep){return "(?:\\d+)";}sep=dojo.regexp.escapeString(sep);if(sep==" "){sep="\\s";}else{if(sep==""){sep="\\s\\xa0";}}var grp=_870.groupSize,grp2=_870.groupSize2;if(grp2){var _877="(?:0|[1-9]\\d{0,"+(grp2-1)+"}(?:["+sep+"]\\d{"+grp2+"})*["+sep+"]\\d{"+grp+"})";return ((grp-grp2)>0)?"(?:"+_877+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_877;}return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";},true);return _871+_873;};}if(!dojo._hasResource["dijit.ProgressBar"]){dojo._hasResource["dijit.ProgressBar"]=true;dojo.provide("dijit.ProgressBar");dojo.declare("dijit.ProgressBar",[dijit._Widget,dijit._Templated],{progress:"0",maximum:100,places:0,indeterminate:false,templateString:"<div class=\"dijitProgressBar dijitProgressBarEmpty\"\n\t><div waiRole=\"progressbar\" tabindex=\"0\" dojoAttachPoint=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\"></div\n\t\t><span style=\"visibility:hidden\">&nbsp;</span\n\t></div\n\t><div dojoAttachPoint=\"label\" class=\"dijitProgressBarLabel\" id=\"${id}_label\">&nbsp;</div\n\t><img dojoAttachPoint=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\"\n\t></img\n></div>\n",_indeterminateHighContrastImagePath:dojo.moduleUrl("dijit","themes/a11y/indeterminate_progress.gif"),postCreate:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath);this.update();},update:function(_878){dojo.mixin(this,_878||{});var tip=this.internalProgress;var _87a=1,_87b;if(this.indeterminate){_87b="addClass";dijit.removeWaiState(tip,"valuenow");dijit.removeWaiState(tip,"valuemin");dijit.removeWaiState(tip,"valuemax");}else{_87b="removeClass";if(String(this.progress).indexOf("%")!=-1){_87a=Math.min(parseFloat(this.progress)/100,1);this.progress=_87a*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_87a=this.progress/this.maximum;}var text=this.report(_87a);this.label.firstChild.nodeValue=text;dijit.setWaiState(tip,"describedby",this.label.id);dijit.setWaiState(tip,"valuenow",this.progress);dijit.setWaiState(tip,"valuemin",0);dijit.setWaiState(tip,"valuemax",this.maximum);}dojo[_87b](this.domNode,"dijitProgressBarIndeterminate");tip.style.width=(_87a*100)+"%";this.onChange();},report:function(_87d){return dojo.number.format(_87d,{type:"percent",places:this.places,locale:this.lang});},onChange:function(){}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.Progress"]){dojo._hasResource["nox.ext.apps.commonui.coreui.Progress"]=true;dojo.provide("nox.ext.apps.commonui.coreui.Progress");dojo.declare("nox.ext.apps.commonui.coreui._Tooltip",dijit._MasterTooltip,{disabled:true,templateString:null,widgetsInTemplate:true,position:["below"],events:["onMouseOver","onMouseOut","onFocus","onBlur","onHover","onUnHover"],constructor:function(){this._tooltip_connects=[];},postMixInProperties:function(){var _87e=dojo.i18n.getLocalization("nox.ext.apps.commonui.coreui","Progress");dojo.mixin(this,_87e);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);if(this.srcNodeRef){this.srcNodeRef.style.display="none";}this._connectNodes=[];if(!this.disabled){this._enable();}},show:function(_87f,_880){if(this.aroundNode&&this.aroundNode===_87f){return;}if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.domNode.style.top=(this.domNode.offsetTop+1)+"px";var _881={};var ltr=this.isLeftToRight();dojo.forEach((_880&&_880.length)?_880:dijit.Tooltip.defaultPosition,function(pos){switch(pos){case "after":_881[ltr?"BR":"BL"]=ltr?"BL":"BR";break;case "before":_881[ltr?"BL":"BR"]=ltr?"BR":"BL";break;case "below":_881[ltr?"BL":"BR"]=ltr?"TL":"TR";_881[ltr?"BR":"BL"]=ltr?"TR":"TL";break;case "above":default:_881[ltr?"TL":"TR"]=ltr?"BL":"BR";_881[ltr?"TR":"TL"]=ltr?"BR":"BL";break;}});var pos=dijit.placeOnScreenAroundElement(this.domNode,_87f,_881,dojo.hitch(this,"orient"));dojo.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_87f;},disable:function(){if(this.disabled){return;}this.hide(this.aroundNode);dojo.forEach(this._tooltip_connects,function(cts){this.disconnect(cts);},this);this.disabled=true;},enable:function(){if(!this.disabled){return;}this._enable();},_enable:function(){dojo.forEach(this.connectId,function(id){var node=dojo.byId(id);if(node){this._connectNodes.push(node);dojo.forEach(this.events,function(_888){this._tooltip_connects.push(this.connect(node,_888.toLowerCase(),"_"+_888));},this);if(dojo.isIE){node.style.zoom=1;}}},this);this.disabled=false;},_onMouseOver:function(e){this._onHover(e);},_onMouseOut:function(e){if(dojo.isDescendant(e.relatedTarget,e.target)){return;}this._onUnHover(e);},_onFocus:function(e){this._focus=true;this._onHover(e);this.inherited(arguments);},_onBlur:function(e){this._focus=false;this._onUnHover(e);this.inherited(arguments);},_onHover:function(e){if(!this._showTimer&&e){var _88e=e.target;this._showTimer=setTimeout(dojo.hitch(this,function(){this.open(_88e);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_890){_890=_890||this._connectNodes[0];if(!_890){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.show(_890,this.position);this._connectNode=_890;},close:function(){this.hide(this._connectNode);delete this._connectNode;if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},uninitialize:function(){this.close();},destroy:function(){this._tooltip_connects=null;}});dojo.declare("nox.ext.apps.commonui.coreui.ProgressTooltip",nox.ext.apps.commonui.coreui._Tooltip,{templateString:"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"noxProgressTooltip\">\n\t<div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" waiRole='alert'>\n\t\t<div class=\"loading\">\n\t\t\t<table cellspacing=\"0\" cellpadding=\"0\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td><span class=\"progressMessage\">${loadingMessage}</span></td>\n\t\t\t\t\t<td><div class=\"progressBar\" style=\"width: 100px;\" dojoType=\"dijit.ProgressBar\" dojoAttachPoint=\"progress\"></div></td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\"></div>\n</div>\n",setPercentage:function(pct){this.progress.update({progress:pct});}});dojo.declare("nox.ext.apps.commonui.coreui.ErrorTooltip",nox.ext.apps.commonui.coreui._Tooltip,{templateString:"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"noxErrorTooltip\">\n  <div class=\"dijitTooltipContainer dijitTooltipContents\" \n       style=\"max-width: 300px\" dojoAttachPoint=\"containerNode\" waiRole='alert'>\n\t\t<div class=\"error\">\n\t\t\t<table cellspacing=\"0\" cellpadding=\"0\">\n\t\t\t\t<tr>\n          <td><h3><span class=\"errorHeader\" dojoAttachPoint=\"errorHeaderNode\"></span></h3></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td><span class=\"errorMessage\" dojoAttachPoint=\"errorNode\">${errorMessage}</span></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n          <td align=\"right\">\n          <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"retryButton\">${retryButtonText}</button>\n          <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"dismissButton\">${dismissButtonText}</button>\n        </td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\"></div>\n</div>\n",events:["onMouseOver","onFocus","onHover"],setError:function(_892,args){if(_892.length>300){_892=_892.substring(0,280)+" [message truncated]";}this.errorNode.innerHTML="";this.errorNode.appendChild(dojo.doc.createTextNode(_892));if(args.header_msg){this.errorHeaderNode.innerHTML=args.header_msg;}if(args.hide_retry){dojo.style(this.retryButton.domNode,{display:"none"});}else{dojo.style(this.retryButton.domNode,{display:"inline"});}if(args.hide_dismiss){dojo.style(this.dismissButton.domNode,{display:"none"});}else{dojo.style(this.dismissButton.domNode,{display:"inline"});}}});dojo.declare("nox.ext.apps.commonui.coreui.Progress",[dijit._Widget,dijit._Templated],{loadingImage:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images/progress.gif"),templateString:"<div class='noxCoreuiProgress'><img src='${loadingImage.uri}' dojoAttachPoint='loadingNode' style='visibility: hidden;' class='noxCoreuiProgressSpinner'/></div>",constructor:function(){},postCreate:function(){this.inherited(arguments);this.tooltip=new nox.ext.apps.commonui.coreui.ProgressTooltip({connectId:[this.domNode],disabled:true});this.errorTooltip=new nox.ext.apps.commonui.coreui.ErrorTooltip({id:"noxErrorTooltip",connectId:[this.domNode],disabled:true});this.connect(this.errorTooltip.retryButton,"onClick","onRetry");this.connect(this.errorTooltip.dismissButton,"onClick","onDismissError");dojo.setSelectable(this.loadingNode,false);this.connect(this.domNode,"onclick","onRefresh");var u=nox.ext.apps.commonui.coreui.getUpdateMgr();this.connect(u,"onUpdateStart","onStart");if(u._updates_started){this.onStart();}this.connect(u,"onMakeRequest","onActivity");this.connect(u,"onUserFunctionCall","onActivity");this.connect(u,"onCountdownStart","onIdle");this.connect(u,"onResponseProcessingTick","onProcessingTick");this.connect(u,"onUpdateComplete","onComplete");this.connect(nox.ext.apps.commonui.coreui.UpdateErrorHandler,"onError","onError");},onStart:function(){dojo.style(this.domNode,"display","block");},onRefresh:function(){if(this._activity_started){return;}nox.ext.apps.commonui.coreui.getUpdateMgr().updateNow();},onRetry:function(){if(this._activity_started){return;}this._error=false;this.onIdle();nox.ext.apps.commonui.coreui.getUpdateMgr().retry_failed_request();},onIdle:function(){if(!this._error){dojo.style(this.loadingNode,"visibility","hidden");this._activity_started=false;dojo.style(this.domNode,"backgroundPosition","0px 0px");dojo.addClass(this.domNode,"noxCoreuiProgressCanRefresh");this.tooltip.disable();this.errorTooltip.disable();}},onComplete:function(){this.onIdle();dojo.style(this.domNode,"display","none");},onActivity:function(){if(!this._activity_started){this._error=false;this._activity_started=true;this.tooltip.setPercentage(0);dojo.style(this.domNode,"backgroundPosition","-26px 0px");dojo.removeClass(this.domNode,"noxCoreuiProgressCanRefresh");dojo.style(this.loadingNode,"visibility","visible");this.tooltip.enable();this.errorTooltip.disable();}},onError:function(_895,args){if(args==null){args={};}this._error=true;this._activity_started=false;this.resume_on_dismiss=false;dojo.style(this.loadingNode,"visibility","hidden");this.errorTooltip.setError(_895,args);dojo.style(this.domNode,"backgroundPosition","-52px 0px");dojo.removeClass(this.domNode,"noxCoreuiProgressCanRefresh");this.tooltip.disable();if(args.validation_error!=null&&args.validation_error==true){nox.ext.apps.commonui.coreui.getUpdateMgr().suspend();this.resume_on_dismiss=true;}this.errorTooltip.enable();if(args.auto_show==null||args.auto_show==true){this.errorTooltip.open(dojo.byId("progress"));}},onDismissError:function(){this._error=false;this.onIdle();if(this.resume_on_dismiss){nox.ext.apps.commonui.coreui.getUpdateMgr().resume();this.resume_on_dismiss=false;}else{nox.ext.apps.commonui.coreui.getUpdateMgr().skip_failed_request();}},onProcessingTick:function(_897,_898){this.tooltip.setPercentage(_898);}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui._ItemSort"]){dojo._hasResource["nox.ext.apps.commonui.coreui._ItemSort"]=true;dojo.provide("nox.ext.apps.commonui.coreui._ItemSort");dojo.declare("nox.ext.apps.commonui.coreui._ItemSort",[],{_get_item_dom_node:function(item){throw Error("Method must be implemented by subclass");},_get_dom_node_item:function(node){throw Error("Method must be implemented by subclass");},_get_num_item_dom_nodes:function(){throw Error("Method must be implemented by subclass");},_get_item_dom_node_idx:function(idx){throw Error("Method must be implemented by subclass");},_get_store:function(){throw Error("Method must be implemented by subclass");},_cmp_attr:function(_89c,_89d){if(_89d==null){return -1;}if(_89c==null){throw "first item in _cmp_attr should not be null";}var _89e=this._get_store();for(i=0;i<this.sort.attr.length;i++){var v1=_89e.getValue(_89c,this.sort.attr[i]);var v2=_89e.getValue(_89d,this.sort.attr[i]);if(v1<v2){return -1;}else{if(v1>v2){return 1;}}}return 0;},_insert_helper:function(item){var n=null;var m=(this.sort.decreasing==true)?-1:1;var _8a4=0;var _8a5=this._get_num_item_dom_nodes();while(_8a4!=_8a5){var i=Math.floor((_8a5-_8a4)/2);n=this._get_item_dom_node_idx(_8a4+i);var z=this._get_dom_node_item(n);var r=m*this.sort.cmp.call(this,item,z);if(r<0){_8a5=_8a4+i;}else{if(r>0){n=this._get_item_dom_node_idx([_8a4+i+1]);_8a4=_8a4+i+1;}else{break;}}}while(n!=null&&this.sort.cmp.call(this,item,this._get_dom_node_item(n))==0){n=n.nextSibling;}return n;},_node_to_insert_before:function(item){if(this.sort==null||this.sort==""){return null;}else{return this._insert_helper(item);}},postMixInProperties:function(){if(this.sort!=null){if(this.sort.cmp==null){this.sort.cmp=this._cmp_attr;}if(typeof (this.sort.attr)=="string"){this.sort.attr=[this.sort.attr];}}}});}if(!dojo._hasResource["dojox.string.Builder"]){dojo._hasResource["dojox.string.Builder"]=true;dojo.provide("dojox.string.Builder");dojox.string.Builder=function(str){var b="";this.length=0;this.append=function(s){if(arguments.length>1){var tmp="",l=arguments.length;switch(l){case 9:tmp=""+arguments[8]+tmp;case 8:tmp=""+arguments[7]+tmp;case 7:tmp=""+arguments[6]+tmp;case 6:tmp=""+arguments[5]+tmp;case 5:tmp=""+arguments[4]+tmp;case 4:tmp=""+arguments[3]+tmp;case 3:tmp=""+arguments[2]+tmp;case 2:b+=""+arguments[0]+arguments[1]+tmp;break;default:var i=0;while(i<arguments.length){tmp+=arguments[i++];}b+=tmp;}}else{b+=s;}this.length=b.length;return this;};this.concat=function(s){return this.append.apply(this,arguments);};this.appendArray=function(_8b1){return this.append.apply(this,_8b1);};this.clear=function(){b="";this.length=0;return this;};this.replace=function(_8b2,_8b3){b=b.replace(_8b2,_8b3);this.length=b.length;return this;};this.remove=function(_8b4,len){if(len===undefined){len=b.length;}if(len==0){return this;}b=b.substr(0,_8b4)+b.substr(_8b4+len);this.length=b.length;return this;};this.insert=function(_8b6,str){if(_8b6==0){b=str+b;}else{b=b.slice(0,_8b6)+str+b.slice(_8b6);}this.length=b.length;return this;};this.toString=function(){return b;};if(str){this.append(str);}};}if(!dojo._hasResource["dojox.string.tokenize"]){dojo._hasResource["dojox.string.tokenize"]=true;dojo.provide("dojox.string.tokenize");dojox.string.tokenize=function(str,re,_8ba,_8bb){var _8bc=[];var _8bd,_8be,_8bf=0;while(_8bd=re.exec(str)){_8be=str.slice(_8bf,re.lastIndex-_8bd[0].length);if(_8be.length){_8bc.push(_8be);}if(_8ba){if(dojo.isOpera){var copy=_8bd.slice(0);while(copy.length<_8bd.length){copy.push(null);}_8bd=copy;}var _8c1=_8ba.apply(_8bb,_8bd.slice(1).concat(_8bc.length));if(typeof _8c1!="undefined"){_8bc.push(_8c1);}}_8bf=re.lastIndex;}_8be=str.slice(_8bf);if(_8be.length){_8bc.push(_8be);}return _8bc;};}if(!dojo._hasResource["dojox.dtl._base"]){dojo._hasResource["dojox.dtl._base"]=true;dojo.provide("dojox.dtl._base");dojo.experimental("dojox.dtl");(function(){var dd=dojox.dtl;dd.TOKEN_BLOCK=-1;dd.TOKEN_VAR=-2;dd.TOKEN_COMMENT=-3;dd.TOKEN_TEXT=3;dd._Context=dojo.extend(function(dict){dojo._mixin(this,dict||{});this._dicts=[];},{push:function(){var last=this;var _8c5=dojo.delegate(this);_8c5.pop=function(){return last;};return _8c5;},pop:function(){throw new Error("pop() called on empty Context");},get:function(key,_8c7){if(typeof this[key]!="undefined"){return this._normalize(this[key]);}for(var i=0,dict;dict=this._dicts[i];i++){if(typeof dict[key]!="undefined"){return this._normalize(dict[key]);}}return _8c7;},_normalize:function(_8ca){if(_8ca instanceof Date){_8ca.year=_8ca.getFullYear();_8ca.month=_8ca.getMonth()+1;_8ca.day=_8ca.getDate();_8ca.date=_8ca.year+"-"+("0"+_8ca.month).slice(-2)+"-"+("0"+_8ca.day).slice(-2);_8ca.hour=_8ca.getHours();_8ca.minute=_8ca.getMinutes();_8ca.second=_8ca.getSeconds();_8ca.microsecond=_8ca.getMilliseconds();}return _8ca;},update:function(dict){var _8cc=this.push();if(dict){dojo._mixin(this,dict);}return _8cc;}});var _8cd=/("(?:[^"\\]*(?:\\.[^"\\]*)*)"|'(?:[^'\\]*(?:\\.[^'\\]*)*)'|[^\s]+)/g;var _8ce=/\s+/g;var _8cf=function(_8d0,_8d1){_8d0=_8d0||_8ce;if(!(_8d0 instanceof RegExp)){_8d0=new RegExp(_8d0,"g");}if(!_8d0.global){throw new Error("You must use a globally flagged RegExp with split "+_8d0);}_8d0.exec("");var part,_8d3=[],_8d4=0,i=0;while(part=_8d0.exec(this)){_8d3.push(this.slice(_8d4,_8d0.lastIndex-part[0].length));_8d4=_8d0.lastIndex;if(_8d1&&(++i>_8d1-1)){break;}}_8d3.push(this.slice(_8d4));return _8d3;};dd.Token=function(_8d6,_8d7){this.token_type=_8d6;this.contents=new String(dojo.trim(_8d7));this.contents.split=_8cf;this.split=function(){return String.prototype.split.apply(this.contents,arguments);};};dd.Token.prototype.split_contents=function(_8d8){var bit,bits=[],i=0;_8d8=_8d8||999;while(i++<_8d8&&(bit=_8cd.exec(this.contents))){bit=bit[0];if(bit.charAt(0)=="\""&&bit.slice(-1)=="\""){bits.push("\""+bit.slice(1,-1).replace("\\\"","\"").replace("\\\\","\\")+"\"");}else{if(bit.charAt(0)=="'"&&bit.slice(-1)=="'"){bits.push("'"+bit.slice(1,-1).replace("\\'","'").replace("\\\\","\\")+"'");}else{bits.push(bit);}}}return bits;};var ddt=dd.text={_get:function(_8dd,name,_8df){var _8e0=dd.register.get(_8dd,name.toLowerCase(),_8df);if(!_8e0){if(!_8df){throw new Error("No tag found for "+name);}return null;}var fn=_8e0[1];var _8e2=_8e0[2];var _8e3;if(fn.indexOf(":")!=-1){_8e3=fn.split(":");fn=_8e3.pop();}dojo["require"](_8e2);var _8e4=dojo.getObject(_8e2);return _8e4[fn||name]||_8e4[name+"_"]||_8e4[fn+"_"];},getTag:function(name,_8e6){return ddt._get("tag",name,_8e6);},getFilter:function(name,_8e8){return ddt._get("filter",name,_8e8);},getTemplate:function(file){return new dd.Template(ddt.getTemplateString(file));},getTemplateString:function(file){return dojo._getText(file.toString())||"";},_resolveLazy:function(_8eb,sync,json){if(sync){if(json){return dojo.fromJson(dojo._getText(_8eb))||{};}else{return dd.text.getTemplateString(_8eb);}}else{return dojo.xhrGet({handleAs:(json)?"json":"text",url:_8eb});}},_resolveTemplateArg:function(arg,sync){if(ddt._isTemplate(arg)){if(!sync){var d=new dojo.Deferred();d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,sync);},_isTemplate:function(arg){return (typeof arg=="undefined")||(typeof arg=="string"&&(arg.match(/^\s*[<{]/)||arg.indexOf(" ")!=-1));},_resolveContextArg:function(arg,sync){if(arg.constructor==Object){if(!sync){var d=new dojo.Deferred;d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,sync,true);},_re:/(?:\{\{\s*(.+?)\s*\}\}|\{%\s*(load\s*)?(.+?)\s*%\})/g,tokenize:function(str){return dojox.string.tokenize(str,ddt._re,ddt._parseDelims);},_parseDelims:function(varr,load,tag){if(varr){return [dd.TOKEN_VAR,varr];}else{if(load){var _8f9=dojo.trim(tag).split(/\s+/g);for(var i=0,part;part=_8f9[i];i++){dojo["require"](part);}}else{return [dd.TOKEN_BLOCK,tag];}}}};dd.Template=dojo.extend(function(_8fc,_8fd){var str=_8fd?_8fc:ddt._resolveTemplateArg(_8fc,true)||"";var _8ff=ddt.tokenize(str);var _900=new dd._Parser(_8ff);this.nodelist=_900.parse();},{update:function(node,_902){return ddt._resolveContextArg(_902).addCallback(this,function(_903){var _904=this.render(new dd._Context(_903));if(node.forEach){node.forEach(function(item){item.innerHTML=_904;});}else{dojo.byId(node).innerHTML=_904;}return this;});},render:function(_906,_907){_907=_907||this.getBuffer();_906=_906||new dd._Context({});return this.nodelist.render(_906,_907)+"";},getBuffer:function(){return new dojox.string.Builder();}});var qfRe=/\{\{\s*(.+?)\s*\}\}/g;dd.quickFilter=function(str){if(!str){return new dd._NodeList();}if(str.indexOf("{%")==-1){return new dd._QuickNodeList(dojox.string.tokenize(str,qfRe,function(_90a){return new dd._Filter(_90a);}));}};dd._QuickNodeList=dojo.extend(function(_90b){this.contents=_90b;},{render:function(_90c,_90d){for(var i=0,l=this.contents.length;i<l;i++){if(this.contents[i].resolve){_90d=_90d.concat(this.contents[i].resolve(_90c));}else{_90d=_90d.concat(this.contents[i]);}}return _90d;},dummyRender:function(_910){return this.render(_910,dd.Template.prototype.getBuffer()).toString();},clone:function(_911){return this;}});dd._Filter=dojo.extend(function(_912){if(!_912){throw new Error("Filter must be called with variable name");}this.contents=_912;var _913=this._cache[_912];if(_913){this.key=_913[0];this.filters=_913[1];}else{this.filters=[];dojox.string.tokenize(_912,this._re,this._tokenize,this);this._cache[_912]=[this.key,this.filters];}},{_cache:{},_re:/(?:^_\("([^\\"]*(?:\\.[^\\"])*)"\)|^"([^\\"]*(?:\\.[^\\"]*)*)"|^([a-zA-Z0-9_.]+)|\|(\w+)(?::(?:_\("([^\\"]*(?:\\.[^\\"])*)"\)|"([^\\"]*(?:\\.[^\\"]*)*)"|([a-zA-Z0-9_.]+)|'([^\\']*(?:\\.[^\\']*)*)'))?|^'([^\\']*(?:\\.[^\\']*)*)')/g,_values:{0:"\"",1:"\"",2:"",8:"\""},_args:{4:"\"",5:"\"",6:"",7:"'"},_tokenize:function(){var pos,arg;for(var i=0,has=[];i<arguments.length;i++){has[i]=(typeof arguments[i]!="undefined"&&typeof arguments[i]=="string"&&arguments[i]);}if(!this.key){for(pos in this._values){if(has[pos]){this.key=this._values[pos]+arguments[pos]+this._values[pos];break;}}}else{for(pos in this._args){if(has[pos]){var _918=arguments[pos];if(this._args[pos]=="'"){_918=_918.replace(/\\'/g,"'");}else{if(this._args[pos]=="\""){_918=_918.replace(/\\"/g,"\"");}}arg=[!this._args[pos],_918];break;}}var fn=ddt.getFilter(arguments[3]);if(!dojo.isFunction(fn)){throw new Error(arguments[3]+" is not registered as a filter");}this.filters.push([fn,arg]);}},getExpression:function(){return this.contents;},resolve:function(_91a){if(typeof this.key=="undefined"){return "";}var str=this.resolvePath(this.key,_91a);for(var i=0,_91d;_91d=this.filters[i];i++){if(_91d[1]){if(_91d[1][0]){str=_91d[0](str,this.resolvePath(_91d[1][1],_91a));}else{str=_91d[0](str,_91d[1][1]);}}else{str=_91d[0](str);}}return str;},resolvePath:function(path,_91f){var _920,_921;var _922=path.charAt(0);var last=path.slice(-1);if(!isNaN(parseInt(_922))){_920=(path.indexOf(".")==-1)?parseInt(path):parseFloat(path);}else{if(_922=="\""&&_922==last){_920=path.slice(1,-1);}else{if(path=="true"){return true;}if(path=="false"){return false;}if(path=="null"||path=="None"){return null;}_921=path.split(".");_920=_91f.get(_921[0]);if(dojo.isFunction(_920)){var self=_91f.getThis&&_91f.getThis();if(_920.alters_data){_920="";}else{if(self){_920=_920.call(self);}else{_920="";}}}for(var i=1;i<_921.length;i++){var part=_921[i];if(_920){var base=_920;if(dojo.isObject(_920)&&part=="items"&&typeof _920[part]=="undefined"){var _928=[];for(var key in _920){_928.push([key,_920[key]]);}_920=_928;continue;}if(_920.get&&dojo.isFunction(_920.get)&&_920.get.safe){_920=_920.get(part);}else{if(typeof _920[part]=="undefined"){_920=_920[part];break;}else{_920=_920[part];}}if(dojo.isFunction(_920)){if(_920.alters_data){_920="";}else{_920=_920.call(base);}}else{if(_920 instanceof Date){_920=dd._Context.prototype._normalize(_920);}}}else{return "";}}}}return _920;}});dd._TextNode=dd._Node=dojo.extend(function(obj){this.contents=obj;},{set:function(data){this.contents=data;return this;},render:function(_92c,_92d){return _92d.concat(this.contents);},isEmpty:function(){return !dojo.trim(this.contents);},clone:function(){return this;}});dd._NodeList=dojo.extend(function(_92e){this.contents=_92e||[];this.last="";},{push:function(node){this.contents.push(node);return this;},concat:function(_930){this.contents=this.contents.concat(_930);return this;},render:function(_931,_932){for(var i=0;i<this.contents.length;i++){_932=this.contents[i].render(_931,_932);if(!_932){throw new Error("Template must return buffer");}}return _932;},dummyRender:function(_934){return this.render(_934,dd.Template.prototype.getBuffer()).toString();},unrender:function(){return arguments[1];},clone:function(){return this;},rtrim:function(){while(1){i=this.contents.length-1;if(this.contents[i] instanceof dd._TextNode&&this.contents[i].isEmpty()){this.contents.pop();}else{break;}}return this;}});dd._VarNode=dojo.extend(function(str){this.contents=new dd._Filter(str);},{render:function(_936,_937){var str=this.contents.resolve(_936);if(!str.safe){str=dd._base.escape(""+str);}return _937.concat(str);}});dd._noOpNode=new function(){this.render=this.unrender=function(){return arguments[1];};this.clone=function(){return this;};};dd._Parser=dojo.extend(function(_939){this.contents=_939;},{i:0,parse:function(_93a){var _93b={};_93a=_93a||[];for(var i=0;i<_93a.length;i++){_93b[_93a[i]]=true;}var _93d=new dd._NodeList();while(this.i<this.contents.length){token=this.contents[this.i++];if(typeof token=="string"){_93d.push(new dd._TextNode(token));}else{var type=token[0];var text=token[1];if(type==dd.TOKEN_VAR){_93d.push(new dd._VarNode(text));}else{if(type==dd.TOKEN_BLOCK){if(_93b[text]){--this.i;return _93d;}var cmd=text.split(/\s+/g);if(cmd.length){cmd=cmd[0];var fn=ddt.getTag(cmd);if(fn){_93d.push(fn(this,new dd.Token(type,text)));}}}}}}if(_93a.length){throw new Error("Could not find closing tag(s): "+_93a.toString());}this.contents.length=0;return _93d;},next_token:function(){var _942=this.contents[this.i++];return new dd.Token(_942[0],_942[1]);},delete_first_token:function(){this.i++;},skip_past:function(_943){while(this.i<this.contents.length){var _944=this.contents[this.i++];if(_944[0]==dd.TOKEN_BLOCK&&_944[1]==_943){return;}}throw new Error("Unclosed tag found when looking for "+_943);},create_variable_node:function(expr){return new dd._VarNode(expr);},create_text_node:function(expr){return new dd._TextNode(expr||"");},getTemplate:function(file){return new dd.Template(file);}});dd.register={_registry:{attributes:[],tags:[],filters:[]},get:function(_948,name){var _94a=dd.register._registry[_948+"s"];for(var i=0,_94c;_94c=_94a[i];i++){if(typeof _94c[0]=="string"){if(_94c[0]==name){return _94c;}}else{if(name.match(_94c[0])){return _94c;}}}},getAttributeTags:function(){var tags=[];var _94e=dd.register._registry.attributes;for(var i=0,_950;_950=_94e[i];i++){if(_950.length==3){tags.push(_950);}else{var fn=dojo.getObject(_950[1]);if(fn&&dojo.isFunction(fn)){_950.push(fn);tags.push(_950);}}}return tags;},_any:function(type,base,_954){for(var path in _954){for(var i=0,fn;fn=_954[path][i];i++){var key=fn;if(dojo.isArray(fn)){key=fn[0];fn=fn[1];}if(typeof key=="string"){if(key.substr(0,5)=="attr:"){var attr=fn;if(attr.substr(0,5)=="attr:"){attr=attr.slice(5);}dd.register._registry.attributes.push([attr.toLowerCase(),base+"."+path+"."+attr]);}key=key.toLowerCase();}dd.register._registry[type].push([key,fn,base+"."+path]);}}},tags:function(base,_95b){dd.register._any("tags",base,_95b);},filters:function(base,_95d){dd.register._any("filters",base,_95d);}};var _95e=/&/g;var _95f=/</g;var _960=/>/g;var _961=/'/g;var _962=/"/g;dd._base.escape=function(_963){return dd.mark_safe(_963.replace(_95e,"&amp;").replace(_95f,"&lt;").replace(_960,"&gt;").replace(_962,"&quot;").replace(_961,"&#39;"));};dd._base.safe=function(_964){if(typeof _964=="string"){_964=new String(_964);}if(typeof _964=="object"){_964.safe=true;}return _964;};dd.mark_safe=dd._base.safe;dd.register.tags("dojox.dtl.tag",{"date":["now"],"logic":["if","for","ifequal","ifnotequal"],"loader":["extends","block","include","load","ssi"],"misc":["comment","debug","filter","firstof","spaceless","templatetag","widthratio","with"],"loop":["cycle","ifchanged","regroup"]});dd.register.filters("dojox.dtl.filter",{"dates":["date","time","timesince","timeuntil"],"htmlstrings":["linebreaks","linebreaksbr","removetags","striptags"],"integers":["add","get_digit"],"lists":["dictsort","dictsortreversed","first","join","length","length_is","random","slice","unordered_list"],"logic":["default","default_if_none","divisibleby","yesno"],"misc":["filesizeformat","pluralize","phone2numeric","pprint"],"strings":["addslashes","capfirst","center","cut","fix_ampersands","floatformat","iriencode","linenumbers","ljust","lower","make_list","rjust","slugify","stringformat","title","truncatewords","truncatewords_html","upper","urlencode","urlize","urlizetrunc","wordcount","wordwrap"]});dd.register.filters("dojox.dtl",{"_base":["escape","safe"]});})();}if(!dojo._hasResource["dojox.dtl.Context"]){dojo._hasResource["dojox.dtl.Context"]=true;dojo.provide("dojox.dtl.Context");dojox.dtl.Context=dojo.extend(function(dict){this._this={};dojox.dtl._Context.call(this,dict);},dojox.dtl._Context.prototype,{getKeys:function(){var keys=[];for(var key in this){if(this.hasOwnProperty(key)&&key!="_dicts"&&key!="_this"){keys.push(key);}}return keys;},extend:function(obj){return dojo.delegate(this,obj);},filter:function(_969){var _96a=new dojox.dtl.Context();var keys=[];var i,arg;if(_969 instanceof dojox.dtl.Context){keys=_969.getKeys();}else{if(typeof _969=="object"){for(var key in _969){keys.push(key);}}else{for(i=0;arg=arguments[i];i++){if(typeof arg=="string"){keys.push(arg);}}}}for(i=0,key;key=keys[i];i++){_96a[key]=this[key];}return _96a;},setThis:function(_96f){this._this=_96f;},getThis:function(){return this._this;},hasKey:function(key){if(typeof this[key]!="undefined"){return true;}for(var i=0,dict;dict=this._dicts[i];i++){if(typeof dict[key]!="undefined"){return true;}}return false;}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ItemList"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ItemList"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ItemList");dojo.declare("nox.ext.apps.commonui.coreui.ItemList",[dijit._Widget,dijit._Templated,nox.ext.apps.commonui.coreui._ItemSort],{templateString:"<span dojoAttachPoint=\"item_list\" class=\"item-list-container\"></span>\n",DTLTemplatePath:dojo.moduleUrl("nox.ext.apps.commonui.coreui","templates/ItemListDTL.html"),editableDTLTemplatePath:dojo.moduleUrl("nox.ext.apps.commonui.coreui","templates/EditableItemListDTL.html"),deleteIcon:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images/itemClose.png"),widgetsInTemplate:false,store:null,labelAttr:null,get:null,sort:null,ignoreNullValues:false,delimiter:", ",editable:false,constructor:function(_973){this.id_base=dijit.getUniqueId("ItemList");},_get_item_id:function(item){return this.id_base+"-"+this.store.getIdentity(item);},_get_item_value:function(item){if(this.get!=null){var _976=this.get(item);}else{if(this.labelAttr!=null&&this.labelAttr!=""){_976=this.store.getValue(item,this.labelAttr,null);}else{_976=this.store.getLabel(item);}}if(_976==null){_976=document.createTextNode((this.ignoreNullValues)?"":"?");}else{if(typeof (_976)=="number"){_976=document.createTextNode(String(_976));}}return _976;},_create_span:function(item){var s=document.createElement("span");s.id=this._get_item_id(item);s.appendChild(this._get_item_value(item));return s;},_get_item_dom_node:function(item){return dojo.byId(this._get_item_id(item));},_get_dom_node_item:function(node){var id=node.id.substr(this.id_base.length+1);return this.store.fetchItemByIdentity(id);},_get_num_item_dom_nodes:function(){return this.item_list.childNodes.length;},_get_item_dom_node_idx:function(idx){return this.item_list.childNodes[idx];},_get_store:function(){return this.store;},_reset_delimiters:function(){for(var i=0;i<this._get_num_item_dom_nodes();i++){var node=this._get_item_dom_node_idx(i);for(j=0;j<node.childNodes.length;j++){var _97f=node.childNodes[j];if(_97f.id==this.id_base+"_delimiter"){node.removeChild(_97f);}}}var b=this._get_num_item_dom_nodes()-1;for(z=0;z<b;z++){var node=this._get_item_dom_node_idx(z);var _97f=document.createElement("span");_97f.id=this.id_base+"_delimiter";_97f.appendChild(document.createTextNode(this.delimiter));node.appendChild(_97f);}},_onNewItem:function(item){this._refresh();},_onItemChange:function(item,_983,_984,_985){},_onDeleteItem:function(item){this._refresh();},_refresh:function(){this.store.fetch({query:{},onComplete:dojo.hitch(this,function(_987){dojo.forEach(_987,function(item){item.displayText=this._get_item_value(item);},this);var _989=this.editable?this.editableDTLTemplatePath:this.DTLTemplatePath;var _98a=new dojox.dtl.Template(_989);var _98b=new dojox.dtl.Context({items:_987,iconURL:this.deleteIcon});this.domNode.innerHTML=_98a.render(_98b);var i=0;var _98d=this.onDelete;dojo.query("img",this.domNode).forEach(function(node){var item=_987[i];i++;dojo.connect(node,"onclick",function(){_98d(item);});});})});},postCreate:function(){dojo.connect(this.store,"onNew",this,"_onNewItem");dojo.connect(this.store,"onSet",this,"_onItemChange");dojo.connect(this.store,"onDelete",this,"_onDeleteItem");this._refresh();},onDelete:function(_990){}});}if(!dojo._hasResource["dojo.DeferredList"]){dojo._hasResource["dojo.DeferredList"]=true;dojo.provide("dojo.DeferredList");dojo.declare("dojo.DeferredList",dojo.Deferred,{constructor:function(list,_992,_993,_994,_995){this.list=list;this.resultList=new Array(this.list.length);this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=_995;this.silentlyCancelled=false;if(this.list.length===0&&!_992){this.callback(this.resultList);}this.finishedCount=0;this.fireOnOneCallback=_992;this.fireOnOneErrback=_993;this.consumeErrors=_994;dojo.forEach(this.list,function(d,_997){d.addCallback(this,function(r){this._cbDeferred(_997,true,r);return r;});d.addErrback(this,function(r){this._cbDeferred(_997,false,r);return r;});},this);},_cbDeferred:function(_99a,_99b,_99c){this.resultList[_99a]=[_99b,_99c];this.finishedCount+=1;if(this.fired!==0){if(_99b&&this.fireOnOneCallback){this.callback([_99a,_99c]);}else{if(!_99b&&this.fireOnOneErrback){this.errback(_99c);}else{if(this.finishedCount==this.list.length){this.callback(this.resultList);}}}}if(!_99b&&this.consumeErrors){_99c=null;}return _99c;},gatherResults:function(_99d){var d=new dojo.DeferredList(_99d,false,true,false);d.addCallback(function(_99f){var ret=[];dojo.forEach(_99f,function(_9a1){ret.push(_9a1[1]);});return ret;});return d;}});}if(!dojo._hasResource["dojo.cldr.supplemental"]){dojo._hasResource["dojo.cldr.supplemental"]=true;dojo.provide("dojo.cldr.supplemental");dojo.cldr.supplemental.getFirstDayOfWeek=function(_9a2){var _9a3={mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,er:6,et:6,iq:6,ir:6,jo:6,ke:6,kw:6,lb:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,so:6,tn:6,ye:6,as:0,au:0,az:0,bw:0,ca:0,cn:0,fo:0,ge:0,gl:0,gu:0,hk:0,ie:0,il:0,is:0,jm:0,jp:0,kg:0,kr:0,la:0,mh:0,mo:0,mp:0,mt:0,nz:0,ph:0,pk:0,sg:0,th:0,tt:0,tw:0,um:0,us:0,uz:0,vi:0,za:0,zw:0,et:0,mw:0,ng:0,tj:0,sy:4};var _9a4=dojo.cldr.supplemental._region(_9a2);var dow=_9a3[_9a4];return (dow===undefined)?1:dow;};dojo.cldr.supplemental._region=function(_9a6){_9a6=dojo.i18n.normalizeLocale(_9a6);var tags=_9a6.split("-");var _9a8=tags[1];if(!_9a8){_9a8={de:"de",en:"us",es:"es",fi:"fi",fr:"fr",he:"il",hu:"hu",it:"it",ja:"jp",ko:"kr",nl:"nl",pt:"br",sv:"se",zh:"cn"}[tags[0]];}else{if(_9a8.length==4){_9a8=tags[2];}}return _9a8;};dojo.cldr.supplemental.getWeekend=function(_9a9){var _9aa={eg:5,il:5,sy:5,"in":0,ae:4,bh:4,dz:4,iq:4,jo:4,kw:4,lb:4,ly:4,ma:4,om:4,qa:4,sa:4,sd:4,tn:4,ye:4};var _9ab={ae:5,bh:5,dz:5,iq:5,jo:5,kw:5,lb:5,ly:5,ma:5,om:5,qa:5,sa:5,sd:5,tn:5,ye:5,af:5,ir:5,eg:6,il:6,sy:6};var _9ac=dojo.cldr.supplemental._region(_9a9);var _9ad=_9aa[_9ac];var end=_9ab[_9ac];if(_9ad===undefined){_9ad=6;}if(end===undefined){end=0;}return {start:_9ad,end:end};};}if(!dojo._hasResource["dojo.date"]){dojo._hasResource["dojo.date"]=true;dojo.provide("dojo.date");dojo.date.getDaysInMonth=function(_9af){var _9b0=_9af.getMonth();var days=[31,28,31,30,31,30,31,31,30,31,30,31];if(_9b0==1&&dojo.date.isLeapYear(_9af)){return 29;}return days[_9b0];};dojo.date.isLeapYear=function(_9b2){var year=_9b2.getFullYear();return !(year%400)||(!(year%4)&&!!(year%100));};dojo.date.getTimezoneName=function(_9b4){var str=_9b4.toString();var tz="";var _9b7;var pos=str.indexOf("(");if(pos>-1){tz=str.substring(++pos,str.indexOf(")"));}else{var pat=/([A-Z\/]+) \d{4}$/;if((_9b7=str.match(pat))){tz=_9b7[1];}else{str=_9b4.toLocaleString();pat=/ ([A-Z\/]+)$/;if((_9b7=str.match(pat))){tz=_9b7[1];}}}return (tz=="AM"||tz=="PM")?"":tz;};dojo.date.compare=function(_9ba,_9bb,_9bc){_9ba=new Date(Number(_9ba));_9bb=new Date(Number(_9bb||new Date()));if(_9bc!=="undefined"){if(_9bc=="date"){_9ba.setHours(0,0,0,0);_9bb.setHours(0,0,0,0);}else{if(_9bc=="time"){_9ba.setFullYear(0,0,0);_9bb.setFullYear(0,0,0);}}}if(_9ba>_9bb){return 1;}if(_9ba<_9bb){return -1;}return 0;};dojo.date.add=function(date,_9be,_9bf){var sum=new Date(Number(date));var _9c1=false;var _9c2="Date";switch(_9be){case "day":break;case "weekday":var days,_9c4;var mod=_9bf%5;if(!mod){days=(_9bf>0)?5:-5;_9c4=(_9bf>0)?((_9bf-5)/5):((_9bf+5)/5);}else{days=mod;_9c4=parseInt(_9bf/5);}var strt=date.getDay();var adj=0;if(strt==6&&_9bf>0){adj=1;}else{if(strt==0&&_9bf<0){adj=-1;}}var trgt=strt+days;if(trgt==0||trgt==6){adj=(_9bf>0)?2:-2;}_9bf=(7*_9c4)+days+adj;break;case "year":_9c2="FullYear";_9c1=true;break;case "week":_9bf*=7;break;case "quarter":_9bf*=3;case "month":_9c1=true;_9c2="Month";break;case "hour":case "minute":case "second":case "millisecond":_9c2="UTC"+_9be.charAt(0).toUpperCase()+_9be.substring(1)+"s";}if(_9c2){sum["set"+_9c2](sum["get"+_9c2]()+_9bf);}if(_9c1&&(sum.getDate()<date.getDate())){sum.setDate(0);}return sum;};dojo.date.difference=function(_9c9,_9ca,_9cb){_9ca=_9ca||new Date();_9cb=_9cb||"day";var _9cc=_9ca.getFullYear()-_9c9.getFullYear();var _9cd=1;switch(_9cb){case "quarter":var m1=_9c9.getMonth();var m2=_9ca.getMonth();var q1=Math.floor(m1/3)+1;var q2=Math.floor(m2/3)+1;q2+=(_9cc*4);_9cd=q2-q1;break;case "weekday":var days=Math.round(dojo.date.difference(_9c9,_9ca,"day"));var _9d3=parseInt(dojo.date.difference(_9c9,_9ca,"week"));var mod=days%7;if(mod==0){days=_9d3*5;}else{var adj=0;var aDay=_9c9.getDay();var bDay=_9ca.getDay();_9d3=parseInt(days/7);mod=days%7;var _9d8=new Date(_9c9);_9d8.setDate(_9d8.getDate()+(_9d3*7));var _9d9=_9d8.getDay();if(days>0){switch(true){case aDay==6:adj=-1;break;case aDay==0:adj=0;break;case bDay==6:adj=-1;break;case bDay==0:adj=-2;break;case (_9d9+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==6:adj=0;break;case aDay==0:adj=1;break;case bDay==6:adj=2;break;case bDay==0:adj=1;break;case (_9d9+mod)<0:adj=2;}}}days+=adj;days-=(_9d3*2);}_9cd=days;break;case "year":_9cd=_9cc;break;case "month":_9cd=(_9ca.getMonth()-_9c9.getMonth())+(_9cc*12);break;case "week":_9cd=parseInt(dojo.date.difference(_9c9,_9ca,"day")/7);break;case "day":_9cd/=24;case "hour":_9cd/=60;case "minute":_9cd/=60;case "second":_9cd/=1000;case "millisecond":_9cd*=_9ca.getTime()-_9c9.getTime();}return Math.round(_9cd);};}if(!dojo._hasResource["dojo.date.locale"]){dojo._hasResource["dojo.date.locale"]=true;dojo.provide("dojo.date.locale");(function(){function _9da(_9db,_9dc,_9dd,_9de){return _9de.replace(/([a-z])\1*/ig,function(_9df){var s,pad;var c=_9df.charAt(0);var l=_9df.length;var _9e4=["abbr","wide","narrow"];switch(c){case "G":s=_9dc[(l<4)?"eraAbbr":"eraNames"][_9db.getFullYear()<0?0:1];break;case "y":s=_9db.getFullYear();switch(l){case 1:break;case 2:if(!_9dd){s=String(s);s=s.substr(s.length-2);break;}default:pad=true;}break;case "Q":case "q":s=Math.ceil((_9db.getMonth()+1)/3);pad=true;break;case "M":var m=_9db.getMonth();if(l<3){s=m+1;pad=true;}else{var _9e6=["months","format",_9e4[l-3]].join("-");s=_9dc[_9e6][m];}break;case "w":var _9e7=0;s=dojo.date.locale._getWeekOfYear(_9db,_9e7);pad=true;break;case "d":s=_9db.getDate();pad=true;break;case "D":s=dojo.date.locale._getDayOfYear(_9db);pad=true;break;case "E":var d=_9db.getDay();if(l<3){s=d+1;pad=true;}else{var _9e9=["days","format",_9e4[l-3]].join("-");s=_9dc[_9e9][d];}break;case "a":var _9ea=(_9db.getHours()<12)?"am":"pm";s=_9dc[_9ea];break;case "h":case "H":case "K":case "k":var h=_9db.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_9db.getMinutes();pad=true;break;case "s":s=_9db.getSeconds();pad=true;break;case "S":s=Math.round(_9db.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "v":case "z":s=dojo.date.getTimezoneName(_9db);if(s){break;}l=4;case "Z":var _9ec=_9db.getTimezoneOffset();var tz=[(_9ec<=0?"+":"-"),dojo.string.pad(Math.floor(Math.abs(_9ec)/60),2),dojo.string.pad(Math.abs(_9ec)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojo.date.locale.format: invalid pattern char: "+_9de);}if(pad){s=dojo.string.pad(s,l);}return s;});};dojo.date.locale.format=function(_9ee,_9ef){_9ef=_9ef||{};var _9f0=dojo.i18n.normalizeLocale(_9ef.locale);var _9f1=_9ef.formatLength||"short";var _9f2=dojo.date.locale._getGregorianBundle(_9f0);var str=[];var _9f4=dojo.hitch(this,_9da,_9ee,_9f2,_9ef.fullYear);if(_9ef.selector=="year"){var year=_9ee.getFullYear();if(_9f0.match(/^zh|^ja/)){year+="";}return year;}if(_9ef.selector!="time"){var _9f6=_9ef.datePattern||_9f2["dateFormat-"+_9f1];if(_9f6){str.push(_9f7(_9f6,_9f4));}}if(_9ef.selector!="date"){var _9f8=_9ef.timePattern||_9f2["timeFormat-"+_9f1];if(_9f8){str.push(_9f7(_9f8,_9f4));}}var _9f9=str.join(" ");return _9f9;};dojo.date.locale.regexp=function(_9fa){return dojo.date.locale._parseInfo(_9fa).regexp;};dojo.date.locale._parseInfo=function(_9fb){_9fb=_9fb||{};var _9fc=dojo.i18n.normalizeLocale(_9fb.locale);var _9fd=dojo.date.locale._getGregorianBundle(_9fc);var _9fe=_9fb.formatLength||"short";var _9ff=_9fb.datePattern||_9fd["dateFormat-"+_9fe];var _a00=_9fb.timePattern||_9fd["timeFormat-"+_9fe];var _a01;if(_9fb.selector=="date"){_a01=_9ff;}else{if(_9fb.selector=="time"){_a01=_a00;}else{_a01=_9ff+" "+_a00;}}var _a02=[];var re=_9f7(_a01,dojo.hitch(this,_a04,_a02,_9fd,_9fb));return {regexp:re,tokens:_a02,bundle:_9fd};};dojo.date.locale.parse=function(_a05,_a06){var info=dojo.date.locale._parseInfo(_a06);var _a08=info.tokens,_a09=info.bundle;var re=new RegExp("^"+info.regexp+"$",info.strict?"":"i");var _a0b=re.exec(_a05);if(!_a0b){return null;}var _a0c=["abbr","wide","narrow"];var _a0d=[1970,0,1,0,0,0,0];var amPm="";var _a0f=dojo.every(_a0b,function(v,i){if(!i){return true;}var _a12=_a08[i-1];var l=_a12.length;switch(_a12.charAt(0)){case "y":if(l!=2&&_a06.strict){_a0d[0]=v;}else{if(v<100){v=Number(v);var year=""+new Date().getFullYear();var _a15=year.substring(0,2)*100;var _a16=Math.min(Number(year.substring(2,4))+20,99);var num=(v<_a16)?_a15+v:_a15-100+v;_a0d[0]=num;}else{if(_a06.strict){return false;}_a0d[0]=v;}}break;case "M":if(l>2){var _a18=_a09["months-format-"+_a0c[l-3]].concat();if(!_a06.strict){v=v.replace(".","").toLowerCase();_a18=dojo.map(_a18,function(s){return s.replace(".","").toLowerCase();});}v=dojo.indexOf(_a18,v);if(v==-1){return false;}}else{v--;}_a0d[1]=v;break;case "E":case "e":var days=_a09["days-format-"+_a0c[l-3]].concat();if(!_a06.strict){v=v.toLowerCase();days=dojo.map(days,function(d){return d.toLowerCase();});}v=dojo.indexOf(days,v);if(v==-1){return false;}break;case "D":_a0d[1]=0;case "d":_a0d[2]=v;break;case "a":var am=_a06.am||_a09.am;var pm=_a06.pm||_a09.pm;if(!_a06.strict){var _a1e=/\./g;v=v.replace(_a1e,"").toLowerCase();am=am.replace(_a1e,"").toLowerCase();pm=pm.replace(_a1e,"").toLowerCase();}if(_a06.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":if(v>23){return false;}_a0d[3]=v;break;case "m":_a0d[4]=v;break;case "s":_a0d[5]=v;break;case "S":_a0d[6]=v;}return true;});var _a1f=+_a0d[3];if(amPm==="p"&&_a1f<12){_a0d[3]=_a1f+12;}else{if(amPm==="a"&&_a1f==12){_a0d[3]=0;}}var _a20=new Date(_a0d[0],_a0d[1],_a0d[2],_a0d[3],_a0d[4],_a0d[5],_a0d[6]);if(_a06.strict){_a20.setFullYear(_a0d[0]);}var _a21=_a08.join(""),_a22=_a21.indexOf("d")!=-1,_a23=_a21.indexOf("M")!=-1;if(!_a0f||(_a23&&_a20.getMonth()>_a0d[1])||(_a22&&_a20.getDate()>_a0d[2])){return null;}if((_a23&&_a20.getMonth()<_a0d[1])||(_a22&&_a20.getDate()<_a0d[2])){_a20=dojo.date.add(_a20,"hour",1);}return _a20;};function _9f7(_a24,_a25,_a26,_a27){var _a28=function(x){return x;};_a25=_a25||_a28;_a26=_a26||_a28;_a27=_a27||_a28;var _a2a=_a24.match(/(''|[^'])+/g);var _a2b=_a24.charAt(0)=="'";dojo.forEach(_a2a,function(_a2c,i){if(!_a2c){_a2a[i]="";}else{_a2a[i]=(_a2b?_a26:_a25)(_a2c);_a2b=!_a2b;}});return _a27(_a2a.join(""));};function _a04(_a2e,_a2f,_a30,_a31){_a31=dojo.regexp.escapeString(_a31);if(!_a30.strict){_a31=_a31.replace(" a"," ?a");}return _a31.replace(/([a-z])\1*/ig,function(_a32){var s;var c=_a32.charAt(0);var l=_a32.length;var p2="",p3="";if(_a30.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d{2,4}";break;case "M":s=(l>2)?"\\S+?":p2+"[1-9]|1[0-2]";break;case "D":s=p2+"[1-9]|"+p3+"[1-9][0-9]|[12][0-9][0-9]|3[0-5][0-9]|36[0-6]";break;case "d":s="[12]\\d|"+p2+"[1-9]|3[01]";break;case "w":s=p2+"[1-9]|[1-4][0-9]|5[0-3]";break;case "E":s="\\S+";break;case "h":s=p2+"[1-9]|1[0-2]";break;case "k":s=p2+"\\d|1[01]";break;case "H":s=p2+"\\d|1\\d|2[0-3]";break;case "K":s=p2+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":s="[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_a30.am||_a2f.am||"AM";var pm=_a30.pm||_a2f.pm||"PM";if(_a30.strict){s=am+"|"+pm;}else{s=am+"|"+pm;if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}if(s.indexOf(".")!=-1){s+="|"+s.replace(/\./g,"");}}s=s.replace(/\./g,"\\.");break;default:s=".*";}if(_a2e){_a2e.push(_a32);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};})();(function(){var _a3a=[];dojo.date.locale.addCustomFormats=function(_a3b,_a3c){_a3a.push({pkg:_a3b,name:_a3c});};dojo.date.locale._getGregorianBundle=function(_a3d){var _a3e={};dojo.forEach(_a3a,function(desc){var _a40=dojo.i18n.getLocalization(desc.pkg,desc.name,_a3d);_a3e=dojo.mixin(_a3e,_a40);},this);return _a3e;};})();dojo.date.locale.addCustomFormats("dojo.cldr","gregorian");dojo.date.locale.getNames=function(item,type,_a43,_a44){var _a45;var _a46=dojo.date.locale._getGregorianBundle(_a44);var _a47=[item,_a43,type];if(_a43=="standAlone"){var key=_a47.join("-");_a45=_a46[key];if(_a45[0]==1){_a45=undefined;}}_a47[1]="format";return (_a45||_a46[_a47.join("-")]).concat();};dojo.date.locale.isWeekend=function(_a49,_a4a){var _a4b=dojo.cldr.supplemental.getWeekend(_a4a);var day=(_a49||new Date()).getDay();if(_a4b.end<_a4b.start){_a4b.end+=7;if(day<_a4b.start){day+=7;}}return day>=_a4b.start&&day<=_a4b.end;};dojo.date.locale._getDayOfYear=function(_a4d){return dojo.date.difference(new Date(_a4d.getFullYear(),0,1,_a4d.getHours()),_a4d)+1;};dojo.date.locale._getWeekOfYear=function(_a4e,_a4f){if(arguments.length==1){_a4f=0;}var _a50=new Date(_a4e.getFullYear(),0,1).getDay();var adj=(_a50-_a4f+7)%7;var week=Math.floor((dojo.date.locale._getDayOfYear(_a4e)+adj-1)/7);if(_a50==_a4f){week++;}return week;};}if(!dojo._hasResource["dijit._Calendar"]){dojo._hasResource["dijit._Calendar"]=true;dojo.provide("dijit._Calendar");dojo.declare("dijit._Calendar",[dijit._Widget,dijit._Templated],{templateString:"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset' dojoAttachPoint=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" waiRole=\"presentation\">\n\t\t\t\t<span dojoAttachPoint=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div dojoAttachPoint=\"monthLabelSpacer\" class=\"dijitCalendarMonthLabelSpacer\"></div>\n\t\t\t\t<div dojoAttachPoint=\"monthLabelNode\" class=\"dijitCalendarMonthLabel\"></div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' dojoAttachPoint=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" waiRole=\"presentation\">\n\t\t\t\t<span dojoAttachPoint=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<th class=\"dijitReset dijitCalendarDayLabelTemplate\"><span class=\"dijitCalendarDayLabel\"></span></th>\n\t\t</tr>\n\t</thead>\n\t<tbody dojoAttachEvent=\"onclick: _onDayClick, onmouseover: _onDayMouseOver, onmouseout: _onDayMouseOut\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t<tr class=\"dijitReset dijitCalendarWeekTemplate\">\n\t\t\t<td class=\"dijitReset dijitCalendarDateTemplate\"><span class=\"dijitCalendarDateLabel\"></span></td>\n\t\t</tr>\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\">\n\t\t\t\t<h3 class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span dojoAttachPoint=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\"></span>\n\t\t\t\t\t<span dojoAttachPoint=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\"></span>\n\t\t\t\t\t<span dojoAttachPoint=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\"></span>\n\t\t\t\t</h3>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\t\n",value:new Date(),dayWidth:"narrow",setValue:function(_a53){dojo.deprecated("dijit.Calendar:setValue() is deprecated.  Use attr('value', ...) instead.","","2.0");this.attr("value",_a53);},_getValueAttr:function(_a54){var _a54=new Date(this.value);_a54.setHours(0,0,0,0);if(_a54.getDate()<this.value.getDate()){_a54=dojo.date.add(_a54,"hour",1);}return _a54;},_setValueAttr:function(_a55){if(!this.value||dojo.date.compare(_a55,this.value)){_a55=new Date(_a55);_a55.setHours(1);this.displayMonth=new Date(_a55);if(!this.isDisabledDate(_a55,this.lang)){this.value=_a55;this.onChange(this.attr("value"));}this._populateGrid();}},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(dojo.doc.createTextNode(text));},_populateGrid:function(){var _a58=this.displayMonth;_a58.setDate(1);var _a59=_a58.getDay();var _a5a=dojo.date.getDaysInMonth(_a58);var _a5b=dojo.date.getDaysInMonth(dojo.date.add(_a58,"month",-1));var _a5c=new Date();var _a5d=this.value;var _a5e=dojo.cldr.supplemental.getFirstDayOfWeek(this.lang);if(_a5e>_a59){_a5e-=7;}dojo.query(".dijitCalendarDateTemplate",this.domNode).forEach(function(_a5f,i){i+=_a5e;var date=new Date(_a58);var _a62,_a63="dijitCalendar",adj=0;if(i<_a59){_a62=_a5b-_a59+i+1;adj=-1;_a63+="Previous";}else{if(i>=(_a59+_a5a)){_a62=i-_a59-_a5a+1;adj=1;_a63+="Next";}else{_a62=i-_a59+1;_a63+="Current";}}if(adj){date=dojo.date.add(date,"month",adj);}date.setDate(_a62);if(!dojo.date.compare(date,_a5c,"date")){_a63="dijitCalendarCurrentDate "+_a63;}if(!dojo.date.compare(date,_a5d,"date")){_a63="dijitCalendarSelectedDate "+_a63;}if(this.isDisabledDate(date,this.lang)){_a63="dijitCalendarDisabledDate "+_a63;}var _a65=this.getClassForDate(date,this.lang);if(_a65){_a63=_a65+" "+_a63;}_a5f.className=_a63+"Month dijitCalendarDateTemplate";_a5f.dijitDateValue=date.valueOf();var _a66=dojo.query(".dijitCalendarDateLabel",_a5f)[0];this._setText(_a66,date.getDate());},this);var _a67=dojo.date.locale.getNames("months","wide","standAlone",this.lang);this._setText(this.monthLabelNode,_a67[_a58.getMonth()]);var y=_a58.getFullYear()-1;var d=new Date();dojo.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],dojo.date.locale.format(d,{selector:"year",locale:this.lang}));},this);var _a6b=this;var _a6c=function(_a6d,_a6e,adj){_a6b._connects.push(dijit.typematic.addMouseListener(_a6b[_a6d],_a6b,function(_a70){if(_a70>=0){_a6b._adjustDisplay(_a6e,adj);}},0.8,500));};_a6c("incrementMonth","month",1);_a6c("decrementMonth","month",-1);_a6c("nextYearLabelNode","year",1);_a6c("previousYearLabelNode","year",-1);},goToToday:function(){this.attr("value",new Date());},postCreate:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,false);var _a71=dojo.hitch(this,function(_a72,n){var _a74=dojo.query(_a72,this.domNode)[0];for(var i=0;i<n;i++){_a74.parentNode.appendChild(_a74.cloneNode(true));}});_a71(".dijitCalendarDayLabelTemplate",6);_a71(".dijitCalendarDateTemplate",6);_a71(".dijitCalendarWeekTemplate",5);var _a76=dojo.date.locale.getNames("days",this.dayWidth,"standAlone",this.lang);var _a77=dojo.cldr.supplemental.getFirstDayOfWeek(this.lang);dojo.query(".dijitCalendarDayLabel",this.domNode).forEach(function(_a78,i){this._setText(_a78,_a76[(i+_a77)%7]);},this);var _a7a=dojo.date.locale.getNames("months","wide","standAlone",this.lang);dojo.forEach(_a7a,function(name){var _a7c=dojo.create("div",null,this.monthLabelSpacer);this._setText(_a7c,name);},this);this.value=null;this.attr("value",new Date());},_adjustDisplay:function(part,_a7e){this.displayMonth=dojo.date.add(this.displayMonth,part,_a7e);this._populateGrid();},_onDayClick:function(evt){dojo.stopEvent(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!dojo.hasClass(node,"dijitCalendarDisabledDate")){this.attr("value",node.dijitDateValue);this.onValueSelected(this.attr("value"));}},_onDayMouseOver:function(evt){var node=evt.target;if(node&&(node.dijitDateValue||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){dojo.addClass(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}for(var node=evt.relatedTarget;node;){if(node==this._currentNode){return;}try{node=node.parentNode;}catch(x){node=null;}}dojo.removeClass(this._currentNode,"dijitCalendarHoveredDate");this._currentNode=null;},onValueSelected:function(date){},onChange:function(date){},isDisabledDate:function(_a87,_a88){},getClassForDate:function(_a89,_a8a){}});}if(!dojo._hasResource["dijit.form._DateTimeTextBox"]){dojo._hasResource["dijit.form._DateTimeTextBox"]=true;dojo.provide("dijit.form._DateTimeTextBox");dojo.declare("dijit.form._DateTimeTextBox",dijit.form.RangeBoundTextBox,{regExpGen:dojo.date.locale.regexp,compare:dojo.date.compare,format:function(_a8b,_a8c){if(!_a8b){return "";}return dojo.date.locale.format(_a8b,_a8c);},parse:function(_a8d,_a8e){return dojo.date.locale.parse(_a8d,_a8e)||(this._isEmpty(_a8d)?null:undefined);},serialize:dojo.date.stamp.toISOString,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",postMixInProperties:function(){this.inherited(arguments);if(!this.value||this.value.toString()==dijit.form._DateTimeTextBox.prototype.value.toString()){this.value=null;}var _a8f=this.constraints;_a8f.selector=this._selector;_a8f.fullYear=true;var _a90=dojo.date.stamp.fromISOString;if(typeof _a8f.min=="string"){_a8f.min=_a90(_a8f.min);}if(typeof _a8f.max=="string"){_a8f.max=_a90(_a8f.max);}},_onFocus:function(evt){this._open();},_setValueAttr:function(_a92,_a93,_a94){this.inherited(arguments);if(this._picker){if(!_a92){_a92=new Date();}this._picker.attr("value",_a92);}},_open:function(){if(this.disabled||this.readOnly||!this.popupClass){return;}var _a95=this;if(!this._picker){var _a96=dojo.getObject(this.popupClass,false);this._picker=new _a96({onValueSelected:function(_a97){if(_a95._tabbingAway){delete _a95._tabbingAway;}else{_a95.focus();}setTimeout(dojo.hitch(_a95,"_close"),1);dijit.form._DateTimeTextBox.superclass._setValueAttr.call(_a95,_a97,true);},lang:_a95.lang,constraints:_a95.constraints,isDisabledDate:function(date){var _a99=dojo.date.compare;var _a9a=_a95.constraints;return _a9a&&(_a9a.min&&(_a99(_a9a.min,date,"date")>0)||(_a9a.max&&_a99(_a9a.max,date,"date")<0));}});this._picker.attr("value",this.attr("value")||new Date());}if(!this._opened){dijit.popup.open({parent:this,popup:this._picker,around:this.domNode,onCancel:dojo.hitch(this,this._close),onClose:function(){_a95._opened=false;}});this._opened=true;}dojo.marginBox(this._picker.domNode,{w:this.domNode.offsetWidth});},_close:function(){if(this._opened){dijit.popup.close(this._picker);this._opened=false;}},_onBlur:function(){this._close();if(this._picker){this._picker.destroy();delete this._picker;}this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(_a9b,_a9c){this._setValueAttr(this.parse(_a9b,this.constraints),_a9c,_a9b);},destroy:function(){if(this._picker){this._picker.destroy();delete this._picker;}this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.focusNode,"onkeypress",this._onKeyPress);},_onKeyPress:function(e){var p=this._picker,dk=dojo.keys;if(p&&this._opened&&p.handleKey){if(p.handleKey(e)===false){return;}}if(this._opened&&e.charOrCode==dk.ESCAPE&&!e.shiftKey&&!e.ctrlKey&&!e.altKey){this._close();dojo.stopEvent(e);}else{if(!this._opened&&e.charOrCode==dk.DOWN_ARROW){this._open();dojo.stopEvent(e);}else{if(e.charOrCode===dk.TAB){this._tabbingAway=true;}else{if(this._opened&&(e.keyChar||e.charOrCode===dk.BACKSPACE||e.charOrCode==dk.DELETE)){setTimeout(dojo.hitch(this,function(){dijit.placeOnScreenAroundElement(p.domNode.parentNode,this.domNode,{"BL":"TL","TL":"BL"},p.orient?dojo.hitch(p,"orient"):null);}),1);}}}}}});}if(!dojo._hasResource["dijit.form.DateTextBox"]){dojo._hasResource["dijit.form.DateTextBox"]=true;dojo.provide("dijit.form.DateTextBox");dojo.declare("dijit.form.DateTextBox",dijit.form._DateTimeTextBox,{baseClass:"dijitTextBox dijitDateTextBox",popupClass:"dijit._Calendar",_selector:"date",value:new Date("")});}if(!dojo._hasResource["dijit._TimePicker"]){dojo._hasResource["dijit._TimePicker"]=true;dojo.provide("dijit._TimePicker");dojo.declare("dijit._TimePicker",[dijit._Widget,dijit._Templated],{templateString:"<div id=\"widget_${id}\" class=\"dijitMenu ${baseClass}\"\n    ><div dojoAttachPoint=\"upArrow\" class=\"dijitButtonNode dijitUpArrowButton\" dojoAttachEvent=\"onmouseenter:_buttonMouse,onmouseleave:_buttonMouse\"\n\t\t><div class=\"dijitReset dijitInline dijitArrowButtonInner\" wairole=\"presentation\" role=\"presentation\">&nbsp;</div\n\t\t><div class=\"dijitArrowButtonChar\">&#9650;</div></div\n    ><div dojoAttachPoint=\"timeMenu,focusNode\" dojoAttachEvent=\"onclick:_onOptionSelected,onmouseover,onmouseout\"></div\n    ><div dojoAttachPoint=\"downArrow\" class=\"dijitButtonNode dijitDownArrowButton\" dojoAttachEvent=\"onmouseenter:_buttonMouse,onmouseleave:_buttonMouse\"\n\t\t><div class=\"dijitReset dijitInline dijitArrowButtonInner\" wairole=\"presentation\" role=\"presentation\">&nbsp;</div\n\t\t><div class=\"dijitArrowButtonChar\">&#9660;</div></div\n></div>\n",baseClass:"dijitTimePicker",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",visibleRange:"T05:00:00",value:new Date(),_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:dojo.date.stamp.toISOString,_filterString:"",setValue:function(_aa0){dojo.deprecated("dijit._TimePicker:setValue() is deprecated.  Use attr('value') instead.","","2.0");this.attr("value",_aa0);},_setValueAttr:function(date){this.value=date;this._showText();},onOpen:function(best){if(this._beenOpened&&this.domNode.parentNode){var p=dijit.byId(this.domNode.parentNode.dijitPopupParent);if(p){var val=p.getDisplayedValue();if(val&&!p.parse(val,p.constraints)){this._filterString=val;}else{this._filterString="";}this._showText();}}this._beenOpened=true;},isDisabledDate:function(_aa5,_aa6){return false;},_getFilteredNodes:function(_aa7,_aa8,_aa9){var _aaa=[],n,i=_aa7,max=this._maxIncrement+Math.abs(i),chk=_aa9?-1:1,dec=_aa9?1:0,inc=_aa9?0:1;do{i=i-dec;n=this._createOption(i);if(n){_aaa.push(n);}i=i+inc;}while(_aaa.length<_aa8&&(i*chk)<max);if(_aa9){_aaa.reverse();}return _aaa;},_showText:function(){this.timeMenu.innerHTML="";var _ab1=dojo.date.stamp.fromISOString;this._clickableIncrementDate=_ab1(this.clickableIncrement);this._visibleIncrementDate=_ab1(this.visibleIncrement);this._visibleRangeDate=_ab1(this.visibleRange);var _ab2=function(date){return date.getHours()*60*60+date.getMinutes()*60+date.getSeconds();};var _ab4=_ab2(this._clickableIncrementDate);var _ab5=_ab2(this._visibleIncrementDate);var _ab6=_ab2(this._visibleRangeDate);var time=this.value.getTime();this._refDate=new Date(time-time%(_ab5*1000));this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._totalIncrements=_ab6/_ab4;this._visibleIncrement=_ab5/_ab4;this._maxIncrement=(60*60*24)/_ab4;var _ab8=this._getFilteredNodes(0,this._totalIncrements>>1,true);var _ab9=this._getFilteredNodes(0,this._totalIncrements>>1,false);if(_ab8.length<this._totalIncrements>>1){_ab8=_ab8.slice(_ab8.length/2);_ab9=_ab9.slice(0,_ab9.length/2);}dojo.forEach(_ab8.concat(_ab9),function(n){this.timeMenu.appendChild(n);},this);},postCreate:function(){if(this.constraints===dijit._TimePicker.prototype.constraints){this.constraints={};}dojo.mixin(this,this.constraints);if(!this.constraints.locale){this.constraints.locale=this.lang;}this.connect(this.timeMenu,dojo.isIE?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var _abb=this;var _abc=function(){_abb._connects.push(dijit.typematic.addMouseListener.apply(null,arguments));};_abc(this.upArrow,this,this._onArrowUp,1,50);_abc(this.downArrow,this,this._onArrowDown,1,50);var _abd=function(cb){return function(cnt){if(cnt>0){cb.call(this,arguments);}};};var _ac0=function(node,cb){return function(e){dojo.stopEvent(e);dijit.typematic.trigger(e,this,node,_abd(cb),node,1,50);};};this.connect(this.upArrow,"onmouseover",_ac0(this.upArrow,this._onArrowUp));this.connect(this.downArrow,"onmouseover",_ac0(this.downArrow,this._onArrowDown));this.inherited(arguments);},_buttonMouse:function(e){dojo.toggleClass(e.currentTarget,"dijitButtonNodeHover",e.type=="mouseover");},_createOption:function(_ac5){var date=new Date(this._refDate);var _ac7=this._clickableIncrementDate;date.setHours(date.getHours()+_ac7.getHours()*_ac5,date.getMinutes()+_ac7.getMinutes()*_ac5,date.getSeconds()+_ac7.getSeconds()*_ac5);var _ac8=dojo.date.locale.format(date,this.constraints);if(this._filterString&&_ac8.toLowerCase().indexOf(this._filterString)!==0){return null;}var div=dojo.create("div",{"class":this.baseClass+"Item"});div.date=date;div.index=_ac5;dojo.create("div",{"class":this.baseClass+"ItemInner",innerHTML:_ac8},div);if(_ac5%this._visibleIncrement<1&&_ac5%this._visibleIncrement>-1){dojo.addClass(div,this.baseClass+"Marker");}else{if(!(_ac5%this._clickableIncrement)){dojo.addClass(div,this.baseClass+"Tick");}}if(this.isDisabledDate(date)){dojo.addClass(div,this.baseClass+"ItemDisabled");}if(!dojo.date.compare(this.value,date,this.constraints.selector)){div.selected=true;dojo.addClass(div,this.baseClass+"ItemSelected");if(dojo.hasClass(div,this.baseClass+"Marker")){dojo.addClass(div,this.baseClass+"MarkerSelected");}else{dojo.addClass(div,this.baseClass+"TickSelected");}}return div;},_onOptionSelected:function(tgt){var _acb=tgt.target.date||tgt.target.parentNode.date;if(!_acb||this.isDisabledDate(_acb)){return;}this._highlighted_option=null;this.attr("value",_acb);this.onValueSelected(_acb);},onValueSelected:function(time){},_highlightOption:function(node,_ace){if(!node){return;}if(_ace){if(this._highlighted_option){this._highlightOption(this._highlighted_option,false);}this._highlighted_option=node;}else{if(this._highlighted_option!==node){return;}else{this._highlighted_option=null;}}dojo.toggleClass(node,this.baseClass+"ItemHover",_ace);if(dojo.hasClass(node,this.baseClass+"Marker")){dojo.toggleClass(node,this.baseClass+"MarkerHover",_ace);}else{dojo.toggleClass(node,this.baseClass+"TickHover",_ace);}},onmouseover:function(e){var tgr=(e.target.parentNode===this.timeMenu)?e.target:e.target.parentNode;if(!dojo.hasClass(tgr,this.baseClass+"Item")){return;}this._highlightOption(tgr,true);},onmouseout:function(e){var tgr=(e.target.parentNode===this.timeMenu)?e.target:e.target.parentNode;this._highlightOption(tgr,false);},_mouseWheeled:function(e){dojo.stopEvent(e);var _ad4=(dojo.isIE?e.wheelDelta:-e.detail);this[(_ad4>0?"_onArrowUp":"_onArrowDown")]();},_onArrowUp:function(_ad5){if(typeof _ad5=="number"&&_ad5==-1){return;}if(!this.timeMenu.childNodes.length){return;}var _ad6=this.timeMenu.childNodes[0].index;var divs=this._getFilteredNodes(_ad6,1,true);if(divs.length){this.timeMenu.removeChild(this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]);this.timeMenu.insertBefore(divs[0],this.timeMenu.childNodes[0]);}},_onArrowDown:function(_ad8){if(typeof _ad8=="number"&&_ad8==-1){return;}if(!this.timeMenu.childNodes.length){return;}var _ad9=this.timeMenu.childNodes[this.timeMenu.childNodes.length-1].index+1;var divs=this._getFilteredNodes(_ad9,1,false);if(divs.length){this.timeMenu.removeChild(this.timeMenu.childNodes[0]);this.timeMenu.appendChild(divs[0]);}},handleKey:function(e){var dk=dojo.keys;if(e.keyChar||e.charOrCode===dk.BACKSPACE||e.charOrCode==dk.DELETE){setTimeout(dojo.hitch(this,function(){this._filterString=e.target.value.toLowerCase();this._showText();}),1);}else{if(e.charOrCode==dk.DOWN_ARROW||e.charOrCode==dk.UP_ARROW){dojo.stopEvent(e);if(this._highlighted_option&&!this._highlighted_option.parentNode){this._highlighted_option=null;}var _add=this.timeMenu,tgt=this._highlighted_option||dojo.query("."+this.baseClass+"ItemSelected",_add)[0];if(!tgt){tgt=_add.childNodes[0];}else{if(_add.childNodes.length){if(e.charOrCode==dk.DOWN_ARROW&&!tgt.nextSibling){this._onArrowDown();}else{if(e.charOrCode==dk.UP_ARROW&&!tgt.previousSibling){this._onArrowUp();}}if(e.charOrCode==dk.DOWN_ARROW){tgt=tgt.nextSibling;}else{tgt=tgt.previousSibling;}}}this._highlightOption(tgt,true);}else{if(this._highlighted_option&&(e.charOrCode==dk.ENTER||e.charOrCode===dk.TAB)){if(e.charOrCode==dk.ENTER){dojo.stopEvent(e);}setTimeout(dojo.hitch(this,function(){this._onOptionSelected({target:this._highlighted_option});}),1);}}}}});}if(!dojo._hasResource["dijit.form.TimeTextBox"]){dojo._hasResource["dijit.form.TimeTextBox"]=true;dojo.provide("dijit.form.TimeTextBox");dojo.declare("dijit.form.TimeTextBox",dijit.form._DateTimeTextBox,{baseClass:"dijitTextBox dijitTimeTextBox",popupClass:"dijit._TimePicker",_selector:"time",value:new Date("")});}if(!dojo._hasResource["dijit.form._Spinner"]){dojo._hasResource["dijit.form._Spinner"]=true;dojo.provide("dijit.form._Spinner");dojo.declare("dijit.form._Spinner",dijit.form.RangeBoundTextBox,{defaultTimeout:500,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:"<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\"\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\" waiRole=\"presentation\"\n\t><div class=\"dijitInputLayoutContainer\"\n\t\t><div class=\"dijitReset dijitSpinnerButtonContainer\"\n\t\t\t>&nbsp;<div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\t\tdojoAttachPoint=\"upArrowNode\"\n\t\t\t\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse\"\n\t\t\t\tstateModifier=\"UpArrow\"\n\t\t\t\t><div class=\"dijitArrowButtonInner\">&thinsp;</div\n\t\t\t\t><div class=\"dijitArrowButtonChar\">&#9650;</div\n\t\t\t></div\n\t\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\t\tdojoAttachPoint=\"downArrowNode\"\n\t\t\t\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse\"\n\t\t\t\tstateModifier=\"DownArrow\"\n\t\t\t\t><div class=\"dijitArrowButtonInner\">&thinsp;</div\n\t\t\t\t><div class=\"dijitArrowButtonChar\">&#9660;</div\n\t\t\t></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitValidationIcon\"><br></div\n\t\t><div class=\"dijitReset dijitValidationIconText\">&Chi;</div\n\t\t><div class=\"dijitReset dijitInputField\"\n\t\t\t><input class='dijitReset' dojoAttachPoint=\"textbox,focusNode\" type=\"${type}\" dojoAttachEvent=\"onkeypress:_onKeyPress\"\n\t\t\t\twaiRole=\"spinbutton\" autocomplete=\"off\" ${nameAttrSetting}\n\t\t/></div\n\t></div\n></div>\n",baseClass:"dijitSpinner",adjust:function(val,_ae0){return val;},_arrowState:function(node,_ae2){this._active=_ae2;this.stateModifier=node.getAttribute("stateModifier")||"";this._setStateClass();},_arrowPressed:function(_ae3,_ae4,_ae5){if(this.disabled||this.readOnly){return;}this._arrowState(_ae3,true);this._setValueAttr(this.adjust(this.attr("value"),_ae4*_ae5),false);dijit.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(node){this._wheelTimer=null;if(this.disabled||this.readOnly){return;}this._arrowState(node,false);},_typematicCallback:function(_ae7,node,evt){var inc=this.smallDelta;if(node==this.textbox){var k=dojo.keys;var key=evt.charOrCode;inc=(key==k.PAGE_UP||key==k.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==k.UP_ARROW||key==k.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_ae7==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){dojo.stopEvent(evt);var _aee=evt.detail?(evt.detail*-1):(evt.wheelDelta/120);if(_aee!==0){var node=this[(_aee>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_aee,this.smallDelta);if(!this._wheelTimer){clearTimeout(this._wheelTimer);}this._wheelTimer=setTimeout(dojo.hitch(this,"_arrowReleased",node),50);}},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");this._connects.push(dijit.typematic.addListener(this.upArrowNode,this.textbox,{charOrCode:dojo.keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout));this._connects.push(dijit.typematic.addListener(this.downArrowNode,this.textbox,{charOrCode:dojo.keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout));this._connects.push(dijit.typematic.addListener(this.upArrowNode,this.textbox,{charOrCode:dojo.keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout));this._connects.push(dijit.typematic.addListener(this.downArrowNode,this.textbox,{charOrCode:dojo.keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout));if(dojo.isIE){var _af0=this;this.connect(this.domNode,"onresize",function(){setTimeout(dojo.hitch(_af0,function(){var sz=this.upArrowNode.parentNode.offsetHeight;if(sz){this.upArrowNode.style.height=sz>>1;this.downArrowNode.style.height=sz-(sz>>1);this.focusNode.parentNode.style.height=sz;}this._setStateClass();}),0);});}}});}if(!dojo._hasResource["dijit.form.NumberTextBox"]){dojo._hasResource["dijit.form.NumberTextBox"]=true;dojo.provide("dijit.form.NumberTextBox");dojo.declare("dijit.form.NumberTextBoxMixin",null,{regExpGen:dojo.number.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:dojo.number.format,postMixInProperties:function(){if(typeof this.constraints.max!="number"){this.constraints.max=9000000000000000;}this.inherited(arguments);},_onFocus:function(){if(this.disabled){return;}var val=this.attr("value");if(typeof val=="number"&&!isNaN(val)){var _af3=this.format(val,this.constraints);if(_af3!==undefined){this.textbox.value=_af3;}}this.inherited(arguments);},format:function(_af4,_af5){if(typeof _af4!="number"){return String(_af4);}if(isNaN(_af4)){return "";}if(("rangeCheck" in this)&&!this.rangeCheck(_af4,_af5)){return String(_af4);}if(this.editOptions&&this._focused){_af5=dojo.mixin(dojo.mixin({},this.editOptions),_af5);}return this._formatter(_af4,_af5);},parse:dojo.number.parse,_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_af7){return (_af7===null||_af7===""||_af7===undefined)?NaN:this.inherited(arguments);},serialize:function(_af8,_af9){return (typeof _af8!="number"||isNaN(_af8))?"":this.inherited(arguments);},_setValueAttr:function(_afa,_afb,_afc){if(_afa!==undefined&&_afc===undefined){if(typeof _afa=="number"){if(isNaN(_afa)){_afc="";}else{if(("rangeCheck" in this)&&!this.rangeCheck(_afa,this.constraints)){_afc=String(_afa);}}}else{if(!_afa){_afc="";_afa=NaN;}else{_afc=String(_afa);_afa=undefined;}}}this.inherited(arguments,[_afa,_afb,_afc]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){var n=Number(this.textbox.value);return (String(n)===this.textbox.value)?n:undefined;}else{return v;}}});dojo.declare("dijit.form.NumberTextBox",[dijit.form.RangeBoundTextBox,dijit.form.NumberTextBoxMixin],{});}if(!dojo._hasResource["dijit.form.NumberSpinner"]){dojo._hasResource["dijit.form.NumberSpinner"]=true;dojo.provide("dijit.form.NumberSpinner");dojo.declare("dijit.form.NumberSpinner",[dijit.form._Spinner,dijit.form.NumberTextBoxMixin],{required:true,adjust:function(val,_b00){var tc=this.constraints,v=isNaN(val),_b03=!isNaN(tc.max),_b04=!isNaN(tc.min);if(v&&_b00!=0){val=(_b00>0)?_b04?tc.min:_b03?tc.max:0:_b03?this.constraints.max:_b04?tc.min:0;}var _b05=val+_b00;if(v||isNaN(_b05)){return val;}if(_b03&&(_b05>tc.max)){_b05=tc.max;}if(_b04&&(_b05<tc.min)){_b05=tc.min;}return _b05;},_onKeyPress:function(e){if((e.charOrCode==dojo.keys.HOME||e.charOrCode==dojo.keys.END)&&!e.ctrlKey&&!e.altKey){var _b07=this.constraints[(e.charOrCode==dojo.keys.HOME?"min":"max")];if(_b07){this._setValueAttr(_b07,true);}dojo.stopEvent(e);}}});}if(!dojo._hasResource["dojo.cldr.monetary"]){dojo._hasResource["dojo.cldr.monetary"]=true;dojo.provide("dojo.cldr.monetary");dojo.cldr.monetary.getData=function(code){var _b09={ADP:0,BHD:3,BIF:0,BYR:0,CLF:0,CLP:0,DJF:0,ESP:0,GNF:0,IQD:3,ITL:0,JOD:3,JPY:0,KMF:0,KRW:0,KWD:3,LUF:0,LYD:3,MGA:0,MGF:0,OMR:3,PYG:0,RWF:0,TND:3,TRL:0,VUV:0,XAF:0,XOF:0,XPF:0};var _b0a={CHF:5};var _b0b=_b09[code],_b0c=_b0a[code];if(typeof _b0b=="undefined"){_b0b=2;}if(typeof _b0c=="undefined"){_b0c=0;}return {places:_b0b,round:_b0c};};}if(!dojo._hasResource["dojo.currency"]){dojo._hasResource["dojo.currency"]=true;dojo.provide("dojo.currency");dojo.currency._mixInDefaults=function(_b0d){_b0d=_b0d||{};_b0d.type="currency";var _b0e=dojo.i18n.getLocalization("dojo.cldr","currency",_b0d.locale)||{};var iso=_b0d.currency;var data=dojo.cldr.monetary.getData(iso);dojo.forEach(["displayName","symbol","group","decimal"],function(prop){data[prop]=_b0e[iso+"_"+prop];});data.fractional=[true,false];return dojo.mixin(data,_b0d);};dojo.currency.format=function(_b12,_b13){return dojo.number.format(_b12,dojo.currency._mixInDefaults(_b13));};dojo.currency.regexp=function(_b14){return dojo.number.regexp(dojo.currency._mixInDefaults(_b14));};dojo.currency.parse=function(_b15,_b16){return dojo.number.parse(_b15,dojo.currency._mixInDefaults(_b16));};}if(!dojo._hasResource["dijit.form.CurrencyTextBox"]){dojo._hasResource["dijit.form.CurrencyTextBox"]=true;dojo.provide("dijit.form.CurrencyTextBox");dojo.declare("dijit.form.CurrencyTextBox",dijit.form.NumberTextBox,{currency:"",regExpGen:dojo.currency.regexp,_formatter:dojo.currency.format,parse:dojo.currency.parse,postMixInProperties:function(){this.constraints.currency=this.currency;this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.HorizontalSlider"]){dojo._hasResource["dijit.form.HorizontalSlider"]=true;dojo.provide("dijit.form.HorizontalSlider");dojo.declare("dijit.form.HorizontalSlider",[dijit.form._FormValueWidget,dijit._Container],{templateString:"<table class=\"dijit dijitReset dijitSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,topDecoration\" class=\"dijitReset\" style=\"text-align:center;width:100%;\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" waiRole=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\" \n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" waiRole=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\" style=\"right:0px;\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset\" style=\"text-align:center;\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n",value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:dijit.defaultDuration,widgetsInTemplate:true,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{id:""}),baseClass:"dijitSlider",_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_startingPixelCount:"l",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey){return;}switch(e.charOrCode){case dojo.keys.HOME:this._setValueAttr(this.minimum,true);break;case dojo.keys.END:this._setValueAttr(this.maximum,true);break;case ((this._descending||this.isLeftToRight())?dojo.keys.RIGHT_ARROW:dojo.keys.LEFT_ARROW):case (this._descending===false?dojo.keys.DOWN_ARROW:dojo.keys.UP_ARROW):case (this._descending===false?dojo.keys.PAGE_DOWN:dojo.keys.PAGE_UP):this.increment(e);break;case ((this._descending||this.isLeftToRight())?dojo.keys.LEFT_ARROW:dojo.keys.RIGHT_ARROW):case (this._descending===false?dojo.keys.UP_ARROW:dojo.keys.DOWN_ARROW):case (this._descending===false?dojo.keys.PAGE_UP:dojo.keys.PAGE_DOWN):this.decrement(e);break;default:return;}dojo.stopEvent(e);},_onHandleClick:function(e){if(this.disabled||this.readOnly){return;}if(!dojo.isIE){dijit.focus(this.sliderHandle);}dojo.stopEvent(e);},_isReversed:function(){return !this.isLeftToRight();},_onBarClick:function(e){if(this.disabled||this.readOnly||!this.clickSelect){return;}dijit.focus(this.sliderHandle);dojo.stopEvent(e);var _b1a=dojo.coords(this.sliderBarContainer,true);var _b1b=e[this._mousePixelCoord]-_b1a[this._startingPixelCoord];this._setPixelValue(this._isReversed()?(_b1a[this._pixelCount]-_b1b):_b1b,_b1a[this._pixelCount],true);this._movable.onMouseDown(e);},_setPixelValue:function(_b1c,_b1d,_b1e){if(this.disabled||this.readOnly){return;}_b1c=_b1c<0?0:_b1d<_b1c?_b1d:_b1c;var _b1f=this.discreteValues;if(_b1f<=1||_b1f==Infinity){_b1f=_b1d;}_b1f--;var _b20=_b1d/_b1f;var _b21=Math.round(_b1c/_b20);this._setValueAttr((this.maximum-this.minimum)*_b21/_b1f+this.minimum,_b1e);},_setValueAttr:function(_b22,_b23){this.valueNode.value=this.value=_b22;dijit.setWaiState(this.focusNode,"valuenow",_b22);this.inherited(arguments);var _b24=(_b22-this.minimum)/(this.maximum-this.minimum);var _b25=(this._descending===false)?this.remainingBar:this.progressBar;var _b26=(this._descending===false)?this.progressBar:this.remainingBar;if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}if(_b23&&this.slideDuration>0&&_b25.style[this._progressPixelSize]){var _b27=this;var _b28={};var _b29=parseFloat(_b25.style[this._progressPixelSize]);var _b2a=this.slideDuration*(_b24-_b29/100);if(_b2a==0){return;}if(_b2a<0){_b2a=0-_b2a;}_b28[this._progressPixelSize]={start:_b29,end:_b24*100,units:"%"};this._inProgressAnim=dojo.animateProperty({node:_b25,duration:_b2a,onAnimate:function(v){_b26.style[_b27._progressPixelSize]=(100-parseFloat(v[_b27._progressPixelSize]))+"%";},onEnd:function(){delete _b27._inProgressAnim;},properties:_b28});this._inProgressAnim.play();}else{_b25.style[this._progressPixelSize]=(_b24*100)+"%";_b26.style[this._progressPixelSize]=((1-_b24)*100)+"%";}},_bumpValue:function(_b2c){if(this.disabled||this.readOnly){return;}var s=dojo.getComputedStyle(this.sliderBarContainer);var c=dojo._getContentBox(this.sliderBarContainer,s);var _b2f=this.discreteValues;if(_b2f<=1||_b2f==Infinity){_b2f=c[this._pixelCount];}_b2f--;var _b30=(this.value-this.minimum)*_b2f/(this.maximum-this.minimum)+_b2c;if(_b30<0){_b30=0;}if(_b30>_b2f){_b30=_b2f;}_b30=_b30*(this.maximum-this.minimum)/_b2f+this.minimum;this._setValueAttr(_b30,true);},_onClkBumper:function(val){if(this.disabled||this.readOnly||!this.clickSelect){return;}this._setValueAttr(val,true);},_onClkIncBumper:function(){this._onClkBumper(this._descending===false?this.minimum:this.maximum);},_onClkDecBumper:function(){this._onClkBumper(this._descending===false?this.maximum:this.minimum);},decrement:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_DOWN?-this.pageIncrement:-1);},increment:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_UP?this.pageIncrement:1);},_mouseWheeled:function(evt){dojo.stopEvent(evt);var _b35=!dojo.isMozilla;var _b36=evt[(_b35?"wheelDelta":"detail")]*(_b35?1:-1);this[(_b36<0?"decrement":"increment")](evt);},startup:function(){dojo.forEach(this.getChildren(),function(_b37){if(this[_b37.container]!=this.containerNode){this[_b37.container].appendChild(_b37.domNode);}},this);},_typematicCallback:function(_b38,_b39,e){if(_b38==-1){return;}this[(_b39==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);},postCreate:function(){if(this.showButtons){this.incrementButton.style.display="";this.decrementButton.style.display="";this._connects.push(dijit.typematic.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500));this._connects.push(dijit.typematic.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));}this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var _b3b=this;var _b3c=function(){dijit.form._SliderMover.apply(this,arguments);this.widget=_b3b;};dojo.extend(_b3c,dijit.form._SliderMover.prototype);this._movable=new dojo.dnd.Moveable(this.sliderHandle,{mover:_b3c});var _b3d=dojo.query("label[for=\""+this.id+"\"]");if(_b3d.length){_b3d[0].id=(this.id+"_label");dijit.setWaiState(this.focusNode,"labelledby",_b3d[0].id);}dijit.setWaiState(this.focusNode,"valuemin",this.minimum);dijit.setWaiState(this.focusNode,"valuemax",this.maximum);this.inherited(arguments);},destroy:function(){this._movable.destroy();if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}this.inherited(arguments);}});dojo.declare("dijit.form._SliderMover",dojo.dnd.Mover,{onMouseMove:function(e){var _b3f=this.widget;var _b40=_b3f._abspos;if(!_b40){_b40=_b3f._abspos=dojo.coords(_b3f.sliderBarContainer,true);_b3f._setPixelValue_=dojo.hitch(_b3f,"_setPixelValue");_b3f._isReversed_=_b3f._isReversed();}var _b41=e[_b3f._mousePixelCoord]-_b40[_b3f._startingPixelCoord];_b3f._setPixelValue_(_b3f._isReversed_?(_b40[_b3f._pixelCount]-_b41):_b41,_b40[_b3f._pixelCount],false);},destroy:function(e){dojo.dnd.Mover.prototype.destroy.apply(this,arguments);var _b43=this.widget;_b43._abspos=null;_b43._setValueAttr(_b43.value,true);}});}if(!dojo._hasResource["dijit._editor.selection"]){dojo._hasResource["dijit._editor.selection"]=true;dojo.provide("dijit._editor.selection");dojo.mixin(dijit._editor.selection,{getType:function(){if(dojo.doc.selection){return dojo.doc.selection.type.toLowerCase();}else{var _b44="text";var oSel;try{oSel=dojo.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _b46=oSel.getRangeAt(0);if((_b46.startContainer==_b46.endContainer)&&((_b46.endOffset-_b46.startOffset)==1)&&(_b46.startContainer.nodeType!=3)){_b44="control";}}return _b44;}},getSelectedText:function(){if(dojo.doc.selection){if(dijit._editor.selection.getType()=="control"){return null;}return dojo.doc.selection.createRange().text;}else{var _b47=dojo.global.getSelection();if(_b47){return _b47.toString();}}return "";},getSelectedHtml:function(){if(dojo.doc.selection){if(dijit._editor.selection.getType()=="control"){return null;}return dojo.doc.selection.createRange().htmlText;}else{var _b48=dojo.global.getSelection();if(_b48&&_b48.rangeCount){var frag=_b48.getRangeAt(0).cloneContents();var div=dojo.doc.createElement("div");div.appendChild(frag);return div.innerHTML;}return null;}},getSelectedElement:function(){if(dijit._editor.selection.getType()=="control"){if(dojo.doc.selection){var _b4b=dojo.doc.selection.createRange();if(_b4b&&_b4b.item){return dojo.doc.selection.createRange().item(0);}}else{var _b4c=dojo.global.getSelection();return _b4c.anchorNode.childNodes[_b4c.anchorOffset];}}return null;},getParentElement:function(){if(dijit._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(dojo.doc.selection){var r=dojo.doc.selection.createRange();r.collapse(true);return r.parentElement();}else{var _b4f=dojo.global.getSelection();if(_b4f){var node=_b4f.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}}return null;},hasAncestorElement:function(_b51){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_b52){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _nlc=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _tlc=String(tags[i]).toLowerCase();if(_nlc==_tlc){return _tlc;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_b5b){if(window["getSelection"]){var _b5c=dojo.global.getSelection();if(_b5c.removeAllRanges){if(_b5b){_b5c.collapseToStart();}else{_b5c.collapseToEnd();}}else{_b5c.collapse(_b5b);}}else{if(dojo.doc.selection){var _b5d=dojo.doc.selection.createRange();_b5d.collapse(_b5b);_b5d.select();}}},remove:function(){var _s=dojo.doc.selection;if(_s){if(_s.type.toLowerCase()!="none"){_s.clear();}return _s;}else{_s=dojo.global.getSelection();_s.deleteFromDocument();return _s;}},selectElementChildren:function(_b5f,_b60){var _b61=dojo.global;var _b62=dojo.doc;_b5f=dojo.byId(_b5f);if(_b62.selection&&dojo.body().createTextRange){var _b63=_b5f.ownerDocument.body.createTextRange();_b63.moveToElementText(_b5f);if(!_b60){try{_b63.select();}catch(e){}}}else{if(_b61.getSelection){var _b64=_b61.getSelection();if(_b64.setBaseAndExtent){_b64.setBaseAndExtent(_b5f,0,_b5f,_b5f.innerText.length-1);}else{if(_b64.selectAllChildren){_b64.selectAllChildren(_b5f);}}}}},selectElement:function(_b65,_b66){var _b67,_b68=dojo.doc;_b65=dojo.byId(_b65);if(_b68.selection&&dojo.body().createTextRange){try{_b67=dojo.body().createControlRange();_b67.addElement(_b65);if(!_b66){_b67.select();}}catch(e){this.selectElementChildren(_b65,_b66);}}else{if(dojo.global.getSelection){var _b69=dojo.global.getSelection();if(_b69.removeAllRanges){_b67=_b68.createRange();_b67.selectNode(_b65);_b69.removeAllRanges();_b69.addRange(_b67);}}}}});}if(!dojo._hasResource["dijit._editor.range"]){dojo._hasResource["dijit._editor.range"]=true;dojo.provide("dijit._editor.range");dijit.range={};dijit.range.getIndex=function(node,_b6b){var ret=[],retR=[];var stop=_b6b;var _b6f=node;var _b70,n;while(node!=stop){var i=0;_b70=node.parentNode;while((n=_b70.childNodes[i++])){if(n===node){--i;break;}}if(i>=_b70.childNodes.length){dojo.debug("Error finding index of a node in dijit.range.getIndex");}ret.unshift(i);retR.unshift(i-_b70.childNodes.length);node=_b70;}if(ret.length>0&&_b6f.nodeType==3){n=_b6f.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=_b6f.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};dijit.range.getNode=function(_b73,_b74){if(!dojo.isArray(_b73)||_b73.length==0){return _b74;}var node=_b74;dojo.every(_b73,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;console.debug("Error: can not find node with index",_b73,"under parent node",_b74);return false;}return true;});return node;};dijit.range.getCommonAncestor=function(n1,n2){var _b79=function(n){var as=[];while(n){as.unshift(n);if(n.nodeName!="BODY"){n=n.parentNode;}else{break;}}return as;};var n1as=_b79(n1);var n2as=_b79(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};dijit.range.getAncestor=function(node,_b82,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(_b82.test(name)){return node;}node=node.parentNode;}return null;};dijit.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;dijit.range.getBlockAncestor=function(node,_b86,root){root=root||node.ownerDocument.body;_b86=_b86||dijit.range.BlockTagNames;var _b88=null,_b89;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!_b88&&_b86.test(name)){_b88=node;}if(!_b89&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_b89=node;}node=node.parentNode;}return {blockNode:_b88,blockContainer:_b89||node.ownerDocument.body};};dijit.range.atBeginningOfContainer=function(_b8b,node,_b8d){var _b8e=false;var _b8f=(_b8d==0);if(!_b8f&&node.nodeType==3){if(dojo.trim(node.nodeValue.substr(0,_b8d))==0){_b8f=true;}}if(_b8f){var _b90=node;_b8e=true;while(_b90&&_b90!==_b8b){if(_b90.previousSibling){_b8e=false;break;}_b90=_b90.parentNode;}}return _b8e;};dijit.range.atEndOfContainer=function(_b91,node,_b93){var _b94=false;var _b95=(_b93==(node.length||node.childNodes.length));if(!_b95&&node.nodeType==3){if(dojo.trim(node.nodeValue.substr(_b93))==0){_b95=true;}}if(_b95){var _b96=node;_b94=true;while(_b96&&_b96!==_b91){if(_b96.nextSibling){_b94=false;break;}_b96=_b96.parentNode;}}return _b94;};dijit.range.adjacentNoneTextNode=function(_b97,next){var node=_b97;var len=(0-_b97.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};dijit.range._w3c=Boolean(window["getSelection"]);dijit.range.create=function(){if(dijit.range._w3c){return dojo.doc.createRange();}else{return new dijit.range.W3CRange;}};dijit.range.getSelection=function(win,_b9d){if(dijit.range._w3c){return win.getSelection();}else{var s=new dijit.range.ie.selection(win);if(!_b9d){s._getCurrentSelection();}return s;}};if(!dijit.range._w3c){dijit.range.ie={cachedSelection:{},selection:function(win){this._ranges=[];this.addRange=function(r,_ba1){this._ranges.push(r);if(!_ba1){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _ba2=function(){var r=win.document.selection.createRange();var type=win.document.selection.type.toUpperCase();if(type=="CONTROL"){return new dijit.range.W3CRange(dijit.range.ie.decomposeControlRange(r));}else{return new dijit.range.W3CRange(dijit.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_ba2();if(r){this.addRange(r,true);}};},decomposeControlRange:function(_ba7){var _ba8=_ba7.item(0),_ba9=_ba7.item(_ba7.length-1);var _baa=_ba8.parentNode,_bab=_ba9.parentNode;var _bac=dijit.range.getIndex(_ba8,_baa).o;var _bad=dijit.range.getIndex(_ba9,_bab).o+1;return [_baa,_bac,_bab,_bad];},getEndPoint:function(_bae,end){var _bb0=_bae.duplicate();_bb0.collapse(!end);var _bb1="EndTo"+(end?"End":"Start");var _bb2=_bb0.parentElement();var _bb3,_bb4,_bb5;if(_bb2.childNodes.length>0){dojo.every(_bb2.childNodes,function(node,i){var _bb8;if(node.nodeType!=3){_bb0.moveToElementText(node);if(_bb0.compareEndPoints(_bb1,_bae)>0){_bb3=node.previousSibling;if(_bb5&&_bb5.nodeType==3){_bb3=_bb5;_bb8=true;}else{_bb3=_bb2;_bb4=i;return false;}}else{if(i==_bb2.childNodes.length-1){_bb3=_bb2;_bb4=_bb2.childNodes.length;return false;}}}else{if(i==_bb2.childNodes.length-1){_bb3=node;_bb8=true;}}if(_bb8&&_bb3){var _bb9=dijit.range.adjacentNoneTextNode(_bb3)[0];if(_bb9){_bb3=_bb9.nextSibling;}else{_bb3=_bb2.firstChild;}var _bba=dijit.range.adjacentNoneTextNode(_bb3);_bb9=_bba[0];var _bbb=_bba[1];if(_bb9){_bb0.moveToElementText(_bb9);_bb0.collapse(false);}else{_bb0.moveToElementText(_bb2);}_bb0.setEndPoint(_bb1,_bae);_bb4=_bb0.text.length-_bbb;return false;}_bb5=node;return true;});}else{_bb3=_bb2;_bb4=0;}if(!end&&_bb3.nodeType!=3&&_bb4==_bb3.childNodes.length){if(_bb3.nextSibling&&_bb3.nextSibling.nodeType==3){_bb3=_bb3.nextSibling;_bb4=0;}}return [_bb3,_bb4];},setEndPoint:function(_bbc,_bbd,_bbe){var _bbf=_bbc.duplicate(),node,len;if(_bbd.nodeType!=3){if(_bbe>0){node=_bbd.childNodes[_bbe-1];if(node.nodeType==3){_bbd=node;_bbe=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_bbd=node.nextSibling;_bbe=0;}else{_bbf.moveToElementText(node.nextSibling?node:_bbd);var _bc2=node.parentNode.insertBefore(document.createTextNode(" "),node.nextSibling);_bbf.collapse(false);_bc2.parentNode.removeChild(_bc2);}}}else{_bbf.moveToElementText(_bbd);_bbf.collapse(true);}}if(_bbd.nodeType==3){var _bc3=dijit.range.adjacentNoneTextNode(_bbd);var _bc4=_bc3[0];len=_bc3[1];if(_bc4){_bbf.moveToElementText(_bc4);_bbf.collapse(false);if(_bc4.contentEditable!="inherit"){len++;}}else{_bbf.moveToElementText(_bbd.parentNode);_bbf.collapse(true);}_bbe+=len;if(_bbe>0){if(_bbf.move("character",_bbe)!=_bbe){console.error("Error when moving!");}}}return _bbf;},decomposeTextRange:function(_bc5){var _bc6=dijit.range.ie.getEndPoint(_bc5);var _bc7=_bc6[0],_bc8=_bc6[1];var _bc9=_bc6[0],_bca=_bc6[1];if(_bc5.htmlText.length){if(_bc5.htmlText==_bc5.text){_bca=_bc8+_bc5.text.length;}else{_bc6=dijit.range.ie.getEndPoint(_bc5,true);_bc9=_bc6[0],_bca=_bc6[1];}}return [_bc7,_bc8,_bc9,_bca];},setRange:function(_bcb,_bcc,_bcd,_bce,_bcf,_bd0){var _bd1=dijit.range.ie.setEndPoint(_bcb,_bcc,_bcd);_bcb.setEndPoint("StartToStart",_bd1);if(!_bd0){var end=dijit.range.ie.setEndPoint(_bcb,_bce,_bcf);}_bcb.setEndPoint("EndToEnd",end||_bd1);return _bcb;}};dojo.declare("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=dijit.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_bd4){_bd4=parseInt(_bd4);if(this.startContainer===node&&this.startOffset==_bd4){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_bd4;if(!this.endContainer){this.setEnd(node,_bd4);}else{this._updateInternal();}},setEnd:function(node,_bd6){_bd6=parseInt(_bd6);if(this.endContainer===node&&this.endOffset==_bd6){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_bd6;if(!this.startContainer){this.setStart(node,_bd6);}else{this._updateInternal();}},setStartAfter:function(node,_bd8){this._setPoint("setStart",node,_bd8,1);},setStartBefore:function(node,_bda){this._setPoint("setStart",node,_bda,0);},setEndAfter:function(node,_bdc){this._setPoint("setEnd",node,_bdc,1);},setEndBefore:function(node,_bde){this._setPoint("setEnd",node,_bde,0);},_setPoint:function(what,node,_be1,ext){var _be3=dijit.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,_be3.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();dijit.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(body){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var r=this._getIERange();r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new dijit.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}}if(!dojo._hasResource["dijit._editor.html"]){dojo._hasResource["dijit._editor.html"]=true;dojo.provide("dijit._editor.html");dijit._editor.escapeXml=function(str,_bea){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_bea){str=str.replace(/'/gm,"&#39;");}return str;};dijit._editor.getNodeHtml=function(node){var _bec;switch(node.nodeType){case 1:_bec="<"+node.nodeName.toLowerCase();var _bed=[];if(dojo.isIE&&node.outerHTML){var s=node.outerHTML;s=s.substr(0,s.indexOf(">")).replace(/(['"])[^"']*\1/g,"");var reg=/([^\s=]+)=/g;var m,key;while((m=reg.exec(s))){key=m[1];if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(node.getAttribute("_djrealurl")){_bed.push([key,node.getAttribute("_djrealurl")]);continue;}}var val;switch(key){case "style":val=node.style.cssText.toLowerCase();break;case "class":val=node.className;break;default:val=node.getAttribute(key);}_bed.push([key,val.toString()]);}}}else{var attr,i=0;while((attr=node.attributes[i++])){var n=attr.name;if(n.substr(0,3)!="_dj"){var v=attr.value;if(n=="src"||n=="href"){if(node.getAttribute("_djrealurl")){v=node.getAttribute("_djrealurl");}}_bed.push([n,v]);}}}_bed.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((attr=_bed[j++])){_bec+=" "+attr[0]+"=\""+(dojo.isString(attr[1])?dijit._editor.escapeXml(attr[1],true):attr[1])+"\"";}if(node.childNodes.length){_bec+=">"+dijit._editor.getChildrenHtml(node)+"</"+node.nodeName.toLowerCase()+">";}else{_bec+=" />";}break;case 3:_bec=dijit._editor.escapeXml(node.nodeValue,true);break;case 8:_bec="<!--"+dijit._editor.escapeXml(node.nodeValue,true)+"-->";break;default:_bec="<!-- Element not recognized - Type: "+node.nodeType+" Name: "+node.nodeName+"-->";}return _bec;};dijit._editor.getChildrenHtml=function(dom){var out="";if(!dom){return out;}var _bfc=dom["childNodes"]||dom;var _bfd=!dojo.isIE||_bfc!==dom;var node,i=0;while((node=_bfc[i++])){if(!_bfd||node.parentNode==dom){out+=dijit._editor.getNodeHtml(node);}}return out;};}if(!dojo._hasResource["dijit._editor.RichText"]){dojo._hasResource["dijit._editor.RichText"]=true;dojo.provide("dijit._editor.RichText");if(!dojo.config["useXDomain"]||dojo.config["allowXdRichTextSave"]){if(dojo._postLoad){(function(){var _c00=dojo.doc.createElement("textarea");_c00.id=dijit._scopeName+"._editor.RichText.savedContent";dojo.style(_c00,{display:"none",position:"absolute",top:"-100px",height:"3px",width:"3px"});dojo.body().appendChild(_c00);})();}else{try{dojo.doc.write("<textarea id=\""+dijit._scopeName+"._editor.RichText.savedContent\" "+"style=\"display:none;position:absolute;top:-100px;left:-100px;height:3px;width:3px;overflow:hidden;\"></textarea>");}catch(e){}}}dojo.declare("dijit._editor.RichText",dijit._Widget,{constructor:function(_c01){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this._keyHandlers={};this.contentPreFilters.push(dojo.hitch(this,"_preFixUrlAttributes"));if(dojo.isMoz){this.contentPreFilters.push(this._fixContentForMoz);this.contentPostFilters.push(this._removeMozBogus);}if(dojo.isSafari){this.contentPostFilters.push(this._removeSafariBogus);}this.onLoadDeferred=new dojo.Deferred();},inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",_content:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"==this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}dojo.publish(dijit._scopeName+"._editor.RichText::init",[this]);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=dojo.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _c05={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!dojo.isIE){_c05.Z=exec("redo");}for(var key in _c05){this.addKeyHandler(key,true,false,_c05[key]);}},events:["onKeyPress","onKeyDown","onKeyUp","onClick"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(this._editorCommandsLocalized){return;}this._editorCommandsLocalized=true;var _c07=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _c08="",_c09,i=0;while((_c09=_c07[i++])){if(_c09.charAt(1)!="l"){_c08+="<"+_c09+"><span>content</span></"+_c09+"><br/>";}else{_c08+="<"+_c09+"><li>content</li></"+_c09+"><br/>";}}var div=dojo.doc.createElement("div");dojo.style(div,{position:"absolute",top:"-2000px"});dojo.doc.body.appendChild(div);div.innerHTML=_c08;var node=div.firstChild;while(node){dijit._editor.selection.selectElement(node.firstChild);dojo.withGlobal(this.window,"selectElement",dijit._editor.selection,[node.firstChild]);var _c0d=node.tagName.toLowerCase();this._local2NativeFormatNames[_c0d]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_c0d]]=_c0d;node=node.nextSibling.nextSibling;}dojo.body().removeChild(div);},open:function(_c0e){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new dojo.Deferred();}if(!this.isClosed){this.close();}dojo.publish(dijit._scopeName+"._editor.RichText::open",[this]);this._content="";if(arguments.length==1&&_c0e.nodeName){this.domNode=_c0e;}var dn=this.domNode;var html;if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=this._preFilterContent(ta.value);dn=this.domNode=dojo.doc.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;dojo.place(dn,ta,"before");var _c12=dojo.hitch(this,function(){dojo.style(ta,{display:"block",position:"absolute",top:"-1000px"});if(dojo.isIE){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(dojo.isIE){setTimeout(_c12,10);}else{_c12();}if(ta.form){dojo.connect(ta.form,"onsubmit",this,function(){ta.value=this.getValue();});}}else{html=this._preFilterContent(dijit._editor.getChildrenHtml(dn));dn.innerHTML="";}var _c14=dojo.contentBox(dn);this._oldHeight=_c14.h;this._oldWidth=_c14.w;this.savedContent=html;if(dn.nodeName&&dn.nodeName=="LI"){dn.innerHTML=" <br>";}this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);if(this.name!=""&&(!dojo.config["useXDomain"]||dojo.config["allowXdRichTextSave"])){var _c15=dojo.byId(dijit._scopeName+"._editor.RichText.savedContent");if(_c15.value!=""){var _c16=_c15.value.split(this._SEPARATOR),i=0,dat;while((dat=_c16[i++])){var data=dat.split(":");if(data[0]==this.name){html=data[1];_c16.splice(i,1);break;}}}this.connect(window,"onbeforeunload","_saveContent");}this.isClosed=false;if(dojo.isIE||dojo.isWebKit||dojo.isOpera){var ifr=(this.editorObject=this.iframe=dojo.doc.createElement("iframe"));ifr.id=this.id+"_iframe";this._iframeSrc=this._getIframeDocTxt();ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(dojo.isIE>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=dojo.hitch(this,function(win){this.window=win;this.document=this.window.document;if(dojo.isIE){this._localizeEditorCommands();}this.onLoad(html);this.savedContent=this.getValue(true);});var s="javascript:parent."+dijit._scopeName+".byId(\""+this.id+"\")._iframeSrc";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(dojo.isWebKit){setTimeout(function(){ifr.setAttribute("src",s);},0);}}else{this._drawIframe(html);this.savedContent=this.getValue(true);}if(dn.nodeName=="LI"){dn.lastChild.style.marginTop="-1.2em";}if(this.domNode.nodeName=="LI"){this.domNode.lastChild.style.marginTop="-1.2em";}dojo.addClass(this.domNode,"RichTextEditable");},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_localizedIframeTitles:null,_getIframeDocTxt:function(){var _cs=dojo.getComputedStyle(this.domNode);var html="";if(dojo.isIE||(!this.height&&!dojo.isMoz)){html="<div>"+html+"</div>";}var font=[_cs.fontWeight,_cs.fontSize,_cs.fontFamily].join(" ");var _c20=_cs.lineHeight;if(_c20.indexOf("px")>=0){_c20=parseFloat(_c20)/parseFloat(_cs.fontSize);}else{if(_c20.indexOf("em")>=0){_c20=parseFloat(_c20);}else{_c20="1.0";}}var _c21="";this.style.replace(/(^|;)(line-|font-?)[^;]+/g,function(_c22){_c21+=_c22.replace(/^;/g,"")+";";});var d=dojo.doc;return [this.isLeftToRight()?"<html><head>":"<html dir='rtl'><head>",(dojo.isMoz?"<title>"+this._localizedIframeTitles.iframeEditTitle+"</title>":""),"<meta http-equiv='Content-Type' content='text/html;'>","<style>","body,html {","\tbackground:transparent;","\tpadding: 1em 0 0 0;","\tmargin: -1em 0 0 0;","}","body{","\ttop:0px; left:0px; right:0px;","\tfont:",font,";",((this.height||dojo.isOpera)?"":"position: fixed;"),"\tmin-height:",this.minHeight,";","\tline-height:",_c20,"}","p{ margin: 1em 0 !important; }",(this.height?"":"body,html{overflow-y:hidden;/*for IE*/} body > div {overflow-x:auto;/*FF:horizontal scrollbar*/ overflow-y:hidden;/*safari*/ min-height:"+this.minHeight+";/*safari*/}"),"li > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; } ","li{ min-height:1.2em; }","</style>",this._applyEditingAreaStyleSheets(),"</head><body onload='frameElement._loadFunc(window,document)' style='"+_c21+"'>",html,"</body></html>"].join("");},_drawIframe:function(html){if(!this.iframe){var ifr=(this.iframe=dojo.doc.createElement("iframe"));ifr.id=this.id+"_iframe";var ifrs=ifr.style;ifrs.border="none";ifrs.lineHeight="0";ifrs.verticalAlign="bottom";this.editorObject=this.iframe;this._localizedIframeTitles=dojo.i18n.getLocalization("dijit.form","Textarea");var _c27=dojo.query("label[for=\""+this.id+"\"]");if(_c27.length){this._localizedIframeTitles.iframeEditTitle=_c27[0].innerHTML+" "+this._localizedIframeTitles.iframeEditTitle;}ifr._loadFunc=function(win){};}this.iframe.style.width=this.inheritWidth?this._oldWidth:"100%";if(this._layoutMode){this.iframe.style.height="100%";}else{if(this.height){this.iframe.style.height=this.height;}else{this.iframe.height=this._oldHeight;}}var _c29;if(this.textarea){_c29=this.srcNodeRef;}else{_c29=dojo.doc.createElement("div");_c29.style.display="none";_c29.innerHTML=html;this.editingArea.appendChild(_c29);}this.editingArea.appendChild(this.iframe);var _c2a=dojo.hitch(this,function(){if(!this.editNode){if(!this.document){try{if(this.iframe.contentWindow){this.window=this.iframe.contentWindow;this.document=this.iframe.contentWindow.document;}else{if(this.iframe.contentDocument){this.window=this.iframe.contentDocument.window;this.document=this.iframe.contentDocument;}}}catch(e){}if(!this.document){setTimeout(_c2a,50);return;}var _c2b=this.document;_c2b.open();if(dojo.isAIR){_c2b.body.innerHTML=html;}else{_c2b.write(this._getIframeDocTxt());}_c2b.close();dojo.destroy(_c29);}if(!this.document.body){setTimeout(_c2a,50);return;}this.onLoad(html);}else{dojo.destroy(_c29);this.editNode.innerHTML=html;this.onDisplayChanged();}});_c2a();},_applyEditingAreaStyleSheets:function(){var _c2c=[];if(this.styleSheets){_c2c=this.styleSheets.split(";");this.styleSheets="";}_c2c=_c2c.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_c2c[i++])){var _c30=(new dojo._Url(dojo.global.location,url)).toString();this.editingAreaStyleSheets.push(_c30);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_c30+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){url=(new dojo._Url(dojo.global.location,url)).toString();}if(dojo.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _c34=this.document.createElement("link");_c34.rel="stylesheet";_c34.type="text/css";_c34.href=url;head.appendChild(_c34);}},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){url=(new dojo._Url(dojo.global.location,url)).toString();}var _c37=dojo.indexOf(this.editingAreaStyleSheets,url);if(_c37==-1){return;}delete this.editingAreaStyleSheets[_c37];dojo.withGlobal(this.window,"query",dojo,["link:[href=\""+url+"\"]"]).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_c38){this.disabled=_c38;if(!this.isLoaded){return;}_c38=!!_c38;if(dojo.isIE||dojo.isWebKit||dojo.isOpera){var _c39=dojo.isIE&&(this.isLoaded||!this.focusOnLoad);if(_c39){this.editNode.unselectable="on";}this.editNode.contentEditable=!_c38;if(_c39){var _c3a=this;setTimeout(function(){_c3a.editNode.unselectable="off";},0);}}else{try{this.document.designMode=(_c38?"off":"on");}catch(e){return;}if(!_c38&&this._mozSettingProps){var ps=this._mozSettingProps;for(var n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e){}}}}}this._disabledOK=true;},_isResized:function(){return false;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;dijit.registerIframe(this.iframe);}if(!dojo.isIE&&(this.height||dojo.isMoz)){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _c3e=this;if(dojo.isIE){var _c3f=(this.tabStop=dojo.doc.createElement("<div tabIndex=-1>"));this.editingArea.appendChild(_c3f);this.iframe.onfocus=function(){_c3e.editNode.setActive();};}}this.focusNode=this.editNode;this._preDomFilterContent(this.editNode);var _c40=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;dojo.forEach(_c40,function(item){this.connect(ap,item.toLowerCase(),item);},this);if(dojo.isIE){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}if(dojo.isWebKit){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");}this.isLoaded=true;this.attr("disabled",this.disabled);this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.callback(true);}if(this.focusOnLoad){dojo.addOnLoad(dojo.hitch(this,function(){setTimeout(dojo.hitch(this,"focus"),this.updateInterval);}));}this.onDisplayChanged();},onKeyDown:function(e){if(e.keyCode===dojo.keys.TAB&&this.isTabIndent){dojo.stopEvent(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(dojo.isIE){if(e.keyCode==dojo.keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===dojo.keys.BACKSPACE&&this.document.selection.type==="Control"){dojo.stopEvent(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}else{if(dojo.isMoz&&!this.isTabIndent){if(e.keyCode==dojo.keys.TAB&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.iframe){var _c44=dojo.isFF<3?this.iframe.contentDocument:this.iframe;_c44.title=this._localizedIframeTitles.iframeFocusTitle;this.iframe.focus();dojo.stopEvent(e);}else{if(e.keyCode==dojo.keys.TAB&&e.shiftKey){if(this.toolbar){this.toolbar.focus();}dojo.stopEvent(e);}}}}return true;},onKeyUp:function(e){return;},setDisabled:function(_c46){dojo.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.attr("disabled",_c46);},_setValueAttr:function(_c47){this.setValue(_c47);},_getDisableSpellCheckAttr:function(){return !dojo.attr(this.document.body,"spellcheck");},_setDisableSpellCheckAttr:function(_c48){if(this.document){dojo.attr(this.document.body,"spellcheck",!_c48);}else{this.onLoadDeferred.addCallback(dojo.hitch(this,function(){dojo.attr(this.document.body,"spellcheck",!_c48);}));}},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode;var _c4b=this._keyHandlers[c];var args=arguments;if(_c4b&&!e.altKey){dojo.forEach(_c4b,function(h){if((!!h.shift==!!e.shiftKey)&&(!!h.ctrl==!!e.ctrlKey)){if(!h.handler.apply(this,args)){e.preventDefault();}}},this);}if(!this._onKeyHitch){this._onKeyHitch=dojo.hitch(this,"onKeyPressed");}setTimeout(this._onKeyHitch,1);return true;},addKeyHandler:function(key,ctrl,_c50,_c51){if(!dojo.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_c50||false,ctrl:ctrl||false,handler:_c51});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(e){if(!this._focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _c=this.getValue(true);if(_c!=this.savedContent){this.onChange(_c);this.savedContent=_c;}if(dojo.isMoz&&this.iframe){var _c56=dojo.isFF<3?this.iframe.contentDocument:this.iframe;_c56.title=this._localizedIframeTitles.iframeEditTitle;}},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.attr("disabled",false);}this.inherited(arguments);}},blur:function(){if(!dojo.isIE&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(dojo.doc.body.focus){dojo.doc.body.focus();}}},focus:function(){if(!dojo.isIE){dijit.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(e){if(this._updateTimer){clearTimeout(this._updateTimer);}if(!this._updateHandler){this._updateHandler=dojo.hitch(this,"onNormalizedDisplayChanged");}this._updateTimer=setTimeout(this._updateHandler,this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(_c59){},_normalizeCommand:function(cmd){var _c5b=cmd.toLowerCase();if(_c5b=="formatblock"){if(dojo.isSafari){_c5b="heading";}}else{if(_c5b=="hilitecolor"&&!dojo.isMoz){_c5b="backcolor";}}return _c5b;},_qcaCache:{},queryCommandAvailable:function(_c5c){var ca=this._qcaCache[_c5c];if(ca!=undefined){return ca;}return (this._qcaCache[_c5c]=this._queryCommandAvailable(_c5c));},_queryCommandAvailable:function(_c5e){var ie=1;var _c60=1<<1;var _c61=1<<2;var _c62=1<<3;var _c63=1<<4;var _c64=dojo.isWebKit;function _c65(_c66){return {ie:Boolean(_c66&ie),mozilla:Boolean(_c66&_c60),webkit:Boolean(_c66&_c61),webkit420:Boolean(_c66&_c63),opera:Boolean(_c66&_c62)};};var _c67=null;switch(_c5e.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_c67=_c65(_c60|ie|_c61|_c62);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_c67=_c65(_c60|ie|_c62|_c63);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_c67=_c65(ie);break;case "cut":case "copy":case "paste":_c67=_c65(ie|_c60|_c63);break;case "inserttable":_c67=_c65(_c60|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_c67=_c65(ie|_c60);break;default:return false;}return (dojo.isIE&&_c67.ie)||(dojo.isMoz&&_c67.mozilla)||(dojo.isWebKit&&_c67.webkit)||(dojo.isWebKit>420&&_c67.webkit420)||(dojo.isOpera&&_c67.opera);},execCommand:function(_c68,_c69){var _c6a;this.focus();_c68=this._normalizeCommand(_c68);if(_c69!=undefined){if(_c68=="heading"){throw new Error("unimplemented");}else{if((_c68=="formatblock")&&dojo.isIE){_c69="<"+_c69+">";}}}if(_c68=="inserthtml"){_c69=this._preFilterContent(_c69);_c6a=true;if(dojo.isIE){var _c6b=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()=="CONTROL"){var n=_c6b.item(0);while(_c6b.length){_c6b.remove(_c6b.item(0));}n.outerHTML=_c69;}else{_c6b.pasteHTML(_c69);}_c6b.select();}else{if(dojo.isMoz&&!_c69.length){this._sCall("remove");}else{_c6a=this.document.execCommand(_c68,false,_c69);}}}else{if((_c68=="unlink")&&(this.queryCommandEnabled("unlink"))&&(dojo.isMoz||dojo.isWebKit)){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);_c6a=this.document.execCommand("unlink",false,null);}else{if((_c68=="hilitecolor")&&(dojo.isMoz)){this.document.execCommand("styleWithCSS",false,true);_c6a=this.document.execCommand(_c68,false,_c69);this.document.execCommand("styleWithCSS",false,false);}else{if((dojo.isIE)&&((_c68=="backcolor")||(_c68=="forecolor"))){_c69=arguments.length>1?_c69:null;_c6a=this.document.execCommand(_c68,false,_c69);}else{_c69=arguments.length>1?_c69:null;if(_c69||_c68!="createlink"){_c6a=this.document.execCommand(_c68,false,_c69);}}}}}this.onDisplayChanged();return _c6a;},queryCommandEnabled:function(_c6e){if(this.disabled||!this._disabledOK){return false;}_c6e=this._normalizeCommand(_c6e);if(dojo.isMoz||dojo.isWebKit){if(_c6e=="unlink"){this._sCall("hasAncestorElement",["a"]);}else{if(_c6e=="inserttable"){return true;}}}if(dojo.isWebKit){if(_c6e=="copy"){_c6e="cut";}else{if(_c6e=="paste"){return true;}}}var elem=dojo.isIE?this.document.selection.createRange():this.document;return elem.queryCommandEnabled(_c6e);},queryCommandState:function(_c70){if(this.disabled||!this._disabledOK){return false;}_c70=this._normalizeCommand(_c70);return this.document.queryCommandState(_c70);},queryCommandValue:function(_c71){if(this.disabled||!this._disabledOK){return false;}var r;_c71=this._normalizeCommand(_c71);if(dojo.isIE&&_c71=="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_c71)];}else{r=this.document.queryCommandValue(_c71);}return r;},_sCall:function(name,args){return dojo.withGlobal(this.window,name,dijit._editor.selection,args);},placeCursorAtStart:function(){this.focus();var _c75=false;if(dojo.isMoz){var _c76=this.editNode.firstChild;while(_c76){if(_c76.nodeType==3){if(_c76.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_c75=true;this._sCall("selectElement",[_c76]);break;}}else{if(_c76.nodeType==1){_c75=true;this._sCall("selectElementChildren",[_c76]);break;}}_c76=_c76.nextSibling;}}else{_c75=true;this._sCall("selectElementChildren",[this.editNode]);}if(_c75){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _c77=false;if(dojo.isMoz){var last=this.editNode.lastChild;while(last){if(last.nodeType==3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_c77=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType==1){_c77=true;if(last.lastChild){this._sCall("selectElement",[last.lastChild]);}else{this._sCall("selectElement",[last]);}break;}}last=last.previousSibling;}}else{_c77=true;this._sCall("selectElementChildren",[this.editNode]);}if(_c77){this._sCall("collapse",[false]);}},getValue:function(_c79){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_c79);},_getValueAttr:function(){return this.getValue();},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.setValue(html);}));return;}if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!dojo.isMoz){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(dojo.isMoz&&!html){html="&nbsp;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}},_preFilterContent:function(html){var ec=html;dojo.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;dojo.forEach(this.contentDomPreFilters,function(ef){if(ef&&dojo.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_c83){var ec;if(!dojo.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_c83){dom=dojo.clone(dom);}dojo.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=dijit._editor.getChildrenHtml(dom);}else{ec=dom;}if(!dojo.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}dojo.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(e){var _c88=dojo.byId(dijit._scopeName+"._editor.RichText.savedContent");_c88.value+=this._SEPARATOR+this.name+":"+this.getValue();},escapeXml:function(str,_c8a){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_c8a){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){dojo.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit._editor.getNodeHtml instead",2);return dijit._editor.getNodeHtml(node);},getNodeChildrenHtml:function(dom){dojo.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit._editor.getChildrenHtml instead",2);return dijit._editor.getChildrenHtml(dom);},close:function(save,_c8e){if(this.isClosed){return false;}if(!arguments.length){save=true;}this._content=this.getValue();var _c8f=(this.savedContent!=this._content);if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(dojo.isIE){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(dojo.isIE){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=save?this._content:this.savedContent;dojo.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=save?this._content:this.savedContent;}dojo.removeClass(this.domNode,"RichTextEditable");this.isClosed=true;this.isLoaded=false;delete this.editNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;return _c8f;},destroyRendering:function(){},destroy:function(){this.destroyRendering();if(!this.isClosed){this.close(false);}this.inherited(arguments);},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"");},_removeSafariBogus:function(html){return html.replace(/\sclass="webkit-block-placeholder"/gi,"");},_fixContentForMoz:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");}});}if(!dojo._hasResource["dijit._editor._Plugin"]){dojo._hasResource["dijit._editor._Plugin"]=true;dojo.provide("dijit._editor._Plugin");dojo.declare("dijit._editor._Plugin",null,{constructor:function(args,node){if(args){dojo.mixin(this,args);}this._connects=[];},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,queryCommand:null,command:"",commandArg:null,useDefaultCommand:true,buttonClass:dijit.form.Button,getLabel:function(key){return this.editor.commands[key];},_initButton:function(_c98){if(this.command.length){var _c99=this.getLabel(this.command);var _c9a=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){_c98=dojo.mixin({label:_c99,showLabel:false,iconClass:_c9a,dropDown:this.dropDown,tabIndex:"-1"},_c98||{});this.button=new this.buttonClass(_c98);}}},destroy:function(f){dojo.forEach(this._connects,dojo.disconnect);if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(dojo.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_ca1,_ca2;if(!e||!e.isLoaded||!c.length){return;}if(this.button){try{_ca2=e.queryCommandEnabled(c);if(this.enabled!==_ca2){this.enabled=_ca2;this.button.attr("disabled",!_ca2);}if(typeof this.button.checked=="boolean"){_ca1=e.queryCommandState(c);if(this.checked!==_ca1){this.checked=_ca1;this.button.attr("checked",e.queryCommandState(c));}}}catch(e){console.log(e);}}},setEditor:function(_ca3){this.editor=_ca3;this._initButton();if(this.command.length&&!this.editor.queryCommandAvailable(this.command)){if(this.button){this.button.domNode.style.display="none";}}if(this.button&&this.useDefaultCommand){this.connect(this.button,"onClick",dojo.hitch(this.editor,"execCommand",this.command,this.commandArg));}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_ca4){if(this.button){_ca4.addChild(this.button);}}});}if(!dojo._hasResource["dijit._editor.plugins.EnterKeyHandling"]){dojo._hasResource["dijit._editor.plugins.EnterKeyHandling"]=true;dojo.provide("dijit._editor.plugins.EnterKeyHandling");dojo.declare("dijit._editor.plugins.EnterKeyHandling",dijit._editor._Plugin,{blockNodeForEnter:"BR",constructor:function(args){if(args){dojo.mixin(this,args);}},setEditor:function(_ca6){this.editor=_ca6;if(this.blockNodeForEnter=="BR"){if(dojo.isIE){_ca6.contentDomPreFilters.push(dojo.hitch(this,"regularPsToSingleLinePs"));_ca6.contentDomPostFilters.push(dojo.hitch(this,"singleLinePsToRegularPs"));_ca6.onLoadDeferred.addCallback(dojo.hitch(this,"_fixNewLineBehaviorForIE"));}else{_ca6.onLoadDeferred.addCallback(dojo.hitch(this,function(d){try{this.editor.document.execCommand("insertBrOnReturn",false,true);}catch(e){}return d;}));}}else{if(this.blockNodeForEnter){dojo["require"]("dijit._editor.range");var h=dojo.hitch(this,this.handleEnterKey);_ca6.addKeyHandler(13,0,0,h);_ca6.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},connect:function(o,f,tf){if(!this._connects){this._connects=[];}this._connects.push(dojo.connect(o,f,this,tf));},destroy:function(){dojo.forEach(this._connects,dojo.disconnect);this._connects=[];},onKeyPressed:function(e){if(this._checkListLater){if(dojo.withGlobal(this.editor.window,"isCollapsed",dijit)){var _cad=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,["LI"]);if(!_cad){dijit._editor.RichText.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _cae=dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.blockNodeForEnter]);if(_cae){_cae.innerHTML=this.bogusHtmlContent;if(dojo.isIE){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{alert("onKeyPressed: Can not find the new block node");}}else{if(dojo.isMoz){if(_cad.parentNode.parentNode.nodeName=="LI"){_cad=_cad.parentNode.parentNode;}}var fc=_cad.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_cad.insertBefore(fc.ownerDocument.createTextNode(""),fc);var _cb1=dijit.range.create();_cb1.setStart(_cad.firstChild,0);var _cb2=dijit.range.getSelection(this.editor.window,true);_cb2.removeAllRanges();_cb2.addRange(_cb1);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&nbsp;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){if(!this.blockNodeForEnter){return true;}var _cb4,_cb5,_cb6,doc=this.editor.document,br;if(e.shiftKey||this.blockNodeForEnter=="BR"){var _cb9=dojo.withGlobal(this.editor.window,"getParentElement",dijit._editor.selection);var _cba=dijit.range.getAncestor(_cb9,this.blockNodes);if(_cba){if(!e.shiftKey&&_cba.tagName=="LI"){return true;}_cb4=dijit.range.getSelection(this.editor.window);_cb5=_cb4.getRangeAt(0);if(!_cb5.collapsed){_cb5.deleteContents();}if(dijit.range.atBeginningOfContainer(_cba,_cb5.startContainer,_cb5.startOffset)){if(e.shiftKey){br=doc.createElement("br");_cb6=dijit.range.create();_cba.insertBefore(br,_cba.firstChild);_cb6.setStartBefore(br.nextSibling);_cb4.removeAllRanges();_cb4.addRange(_cb6);}else{dojo.place(br,_cba,"before");}}else{if(dijit.range.atEndOfContainer(_cba,_cb5.startContainer,_cb5.startOffset)){_cb6=dijit.range.create();br=doc.createElement("br");if(e.shiftKey){_cba.appendChild(br);_cba.appendChild(doc.createTextNode(""));_cb6.setStart(_cba.lastChild,0);}else{dojo.place(br,_cba,"after");_cb6.setStartAfter(_cba);}_cb4.removeAllRanges();_cb4.addRange(_cb6);}else{return true;}}}else{dijit._editor.RichText.prototype.execCommand.call(this.editor,"inserthtml","<br>");}return false;}var _cbb=true;_cb4=dijit.range.getSelection(this.editor.window);_cb5=_cb4.getRangeAt(0);if(!_cb5.collapsed){_cb5.deleteContents();}var _cbc=dijit.range.getBlockAncestor(_cb5.endContainer,null,this.editor.editNode);var _cbd=_cbc.blockNode;if((this._checkListLater=(_cbd&&(_cbd.nodeName=="LI"||_cbd.parentNode.nodeName=="LI")))){if(dojo.isMoz){this._pressedEnterInBlock=_cbd;}if(/^(?:\s|&nbsp;)$/.test(_cbd.innerHTML)){_cbd.innerHTML="";}return true;}if(!_cbc.blockNode||_cbc.blockNode===this.editor.editNode){dijit._editor.RichText.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);_cbc={blockNode:dojo.withGlobal(this.editor.window,"getAncestorElement",dijit._editor.selection,[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_cbc.blockNode){if(!(_cbc.blockNode.textContent||_cbc.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length){this.removeTrailingBr(_cbc.blockNode);return false;}}else{_cbc.blockNode=this.editor.editNode;}_cb4=dijit.range.getSelection(this.editor.window);_cb5=_cb4.getRangeAt(0);}var _cbe=doc.createElement(this.blockNodeForEnter);_cbe.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_cbc.blockNode);if(dijit.range.atEndOfContainer(_cbc.blockNode,_cb5.endContainer,_cb5.endOffset)){if(_cbc.blockNode===_cbc.blockContainer){_cbc.blockNode.appendChild(_cbe);}else{dojo.place(_cbe,_cbc.blockNode,"after");}_cbb=false;_cb6=dijit.range.create();_cb6.setStart(_cbe,0);_cb4.removeAllRanges();_cb4.addRange(_cb6);if(this.editor.height){_cbe.scrollIntoView(false);}}else{if(dijit.range.atBeginningOfContainer(_cbc.blockNode,_cb5.startContainer,_cb5.startOffset)){dojo.place(_cbe,_cbc.blockNode,_cbc.blockNode===_cbc.blockContainer?"first":"before");if(_cbe.nextSibling&&this.editor.height){_cbe.nextSibling.scrollIntoView(false);}_cbb=false;}else{if(dojo.isMoz){this._pressedEnterInBlock=_cbc.blockNode;}}}return _cbb;},removeTrailingBr:function(_cbf){var para=/P|DIV|LI/i.test(_cbf.tagName)?_cbf:dijit._editor.selection.getParentOfType(_cbf,["P","DIV","LI"]);if(!para){return;}if(para.lastChild){if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||(para.lastChild&&para.lastChild.tagName=="BR")){dojo.destroy(para.lastChild);}}if(!para.childNodes.length){para.innerHTML=this.bogusHtmlContent;}},_fixNewLineBehaviorForIE:function(d){if(this.editor.document.__INSERTED_EDITIOR_NEWLINE_CSS===undefined){var _cc2="p{margin:0 !important;}";var _cc3=function(_cc4,doc,URI){if(!_cc4){return null;}if(!doc){doc=document;}var _cc7=doc.createElement("style");_cc7.setAttribute("type","text/css");var head=doc.getElementsByTagName("head")[0];if(!head){console.debug("No head tag in document, aborting styles");return null;}else{head.appendChild(_cc7);}if(_cc7.styleSheet){var _cc9=function(){try{_cc7.styleSheet.cssText=_cc4;}catch(e){console.debug(e);}};if(_cc7.styleSheet.disabled){setTimeout(_cc9,10);}else{_cc9();}}else{var _cca=doc.createTextNode(_cc4);_cc7.appendChild(_cca);}return _cc7;};_cc3(_cc2,this.editor.document);this.editor.document.__INSERTED_EDITIOR_NEWLINE_CSS=true;return d;}return null;},regularPsToSingleLinePs:function(_ccb,_ccc){function _ccd(el){function _ccf(_cd0){var newP=_cd0[0].ownerDocument.createElement("p");_cd0[0].parentNode.insertBefore(newP,_cd0[0]);dojo.forEach(_cd0,function(node){newP.appendChild(node);});};var _cd3=0;var _cd4=[];var _cd5;while(_cd3<el.childNodes.length){_cd5=el.childNodes[_cd3];if(_cd5.nodeType==3||(_cd5.nodeType==1&&_cd5.nodeName!="BR"&&dojo.style(_cd5,"display")!="block")){_cd4.push(_cd5);}else{var _cd6=_cd5.nextSibling;if(_cd4.length){_ccf(_cd4);_cd3=(_cd3+1)-_cd4.length;if(_cd5.nodeName=="BR"){dojo.destroy(_cd5);}}_cd4=[];}_cd3++;}if(_cd4.length){_ccf(_cd4);}};function _cd7(el){var _cd9=null;var _cda=[];var _cdb=el.childNodes.length-1;for(var i=_cdb;i>=0;i--){_cd9=el.childNodes[i];if(_cd9.nodeName=="BR"){var newP=_cd9.ownerDocument.createElement("p");dojo.place(newP,el,"after");if(_cda.length==0&&i!=_cdb){newP.innerHTML="&nbsp;";}dojo.forEach(_cda,function(node){newP.appendChild(node);});dojo.destroy(_cd9);_cda=[];}else{_cda.unshift(_cd9);}}};var _cdf=[];var ps=_ccb.getElementsByTagName("p");dojo.forEach(ps,function(p){_cdf.push(p);});dojo.forEach(_cdf,function(p){if((p.previousSibling)&&(p.previousSibling.nodeName=="P"||dojo.style(p.previousSibling,"display")!="block")){var newP=p.parentNode.insertBefore(this.document.createElement("p"),p);newP.innerHTML=_ccc?"":"&nbsp;";}_cd7(p);},this.editor);_ccd(_ccb);return _ccb;},singleLinePsToRegularPs:function(_ce4){function _ce5(node){var ps=node.getElementsByTagName("p");var _ce8=[];for(var i=0;i<ps.length;i++){var p=ps[i];var _ceb=false;for(var k=0;k<_ce8.length;k++){if(_ce8[k]===p.parentNode){_ceb=true;break;}}if(!_ceb){_ce8.push(p.parentNode);}}return _ce8;};function _ced(node){if(node.nodeType!=1||node.tagName!="P"){return dojo.style(node,"display")=="block";}else{if(!node.childNodes.length||node.innerHTML=="&nbsp;"){return true;}}return false;};var _cef=_ce5(_ce4);for(var i=0;i<_cef.length;i++){var _cf1=_cef[i];var _cf2=null;var node=_cf1.firstChild;var _cf4=null;while(node){if(node.nodeType!="1"||node.tagName!="P"){_cf2=null;}else{if(_ced(node)){_cf4=node;_cf2=null;}else{if(_cf2==null){_cf2=node;}else{if((!_cf2.lastChild||_cf2.lastChild.nodeName!="BR")&&(node.firstChild)&&(node.firstChild.nodeName!="BR")){_cf2.appendChild(this.editor.document.createElement("br"));}while(node.firstChild){_cf2.appendChild(node.firstChild);}_cf4=node;}}}node=node.nextSibling;if(_cf4){dojo.destroy(_cf4);_cf4=null;}}}return _ce4;}});}if(!dojo._hasResource["dijit.Editor"]){dojo._hasResource["dijit.Editor"]=true;dojo.provide("dijit.Editor");dojo.declare("dijit.Editor",dijit._editor.RichText,{plugins:null,extraPlugins:null,constructor:function(){if(!dojo.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull","dijit._editor.plugins.EnterKeyHandling"];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(dojo.isIE){this.events.push("onBeforeDeactivate");}},postCreate:function(){if(this.customUndo){dojo["require"]("dijit._editor.range");this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);}if(dojo.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=dojo.i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new dijit.Toolbar({});dojo.place(this.toolbar.domNode,this.editingArea,"before");}dojo.forEach(this.plugins,this.addPlugin,this);this.onNormalizedDisplayChanged();this.toolbar.startup();},destroy:function(){dojo.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_cf6,_cf7){var args=dojo.isString(_cf6)?{name:_cf6}:_cf6;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};dojo.publish(dijit._scopeName+".Editor.getPlugin",[o]);if(!o.plugin){var pc=dojo.getObject(args.name);if(pc){o.plugin=new pc(args);}}if(!o.plugin){console.warn("Cannot find plugin",_cf6);return;}_cf6=o.plugin;}if(arguments.length>1){this._plugins[_cf7]=_cf6;}else{this._plugins.push(_cf6);}_cf6.setEditor(this);if(dojo.isFunction(_cf6.setToolbar)){_cf6.setToolbar(this.toolbar);}},startup:function(){},resize:function(size){dijit.layout._LayoutWidget.prototype.resize.apply(this,arguments);},layout:function(){this.editingArea.style.height=(this._contentBox.h-dojo.marginBox(this.toolbar.domNode).h)+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){delete this._savedSelection;if(e.target.tagName=="BODY"){setTimeout(dojo.hitch(this,"placeCursorAtEnd"),0);}this.inherited(arguments);},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}this._saveSelection();},customUndo:dojo.isIE,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){clearTimeout(this._editTimer);}this._editTimer=setTimeout(dojo.hitch(this,this.endEditing),this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}try{var r=this.inherited("execCommand",arguments);if(dojo.isWebKit&&cmd=="paste"&&!r){throw {code:1011};}}catch(e){if(e.code==1011&&/copy|cut|paste/.test(cmd)){var sub=dojo.string.substitute,_d02={cut:"X",copy:"C",paste:"V"},_d03=navigator.userAgent.indexOf("Macintosh")!=-1;alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[_d03?"appleKey":"ctrlKey"],[_d02[cmd]])]));}r=false;}if(this.customUndo){this._endEditing();}return r;}},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited("queryCommandEnabled",arguments);}},focus:function(){var _d05=0;if(this._savedSelection&&dojo.isIE){_d05=dijit._curFocus!=this.editNode;}this.inherited(arguments);if(_d05){this._restoreSelection();}},_moveToBookmark:function(b){var _d07=b;if(dojo.isIE){if(dojo.isArray(b)){_d07=[];dojo.forEach(b,function(n){_d07.push(dijit.range.getNode(n,this.editNode));},this);}}else{var r=dijit.range.create();r.setStart(dijit.range.getNode(b.startContainer,this.editNode),b.startOffset);r.setEnd(dijit.range.getNode(b.endContainer,this.editNode),b.endOffset);_d07=r;}dojo.withGlobal(this.window,"moveToBookmark",dijit,[_d07]);},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){this.endEditing(true);var s=this._steps.pop();if(this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();return true;}return false;},redo:function(){this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();return true;}return false;},endEditing:function(_d0f){if(this._editTimer){clearTimeout(this._editTimer);}if(this._inEditing){this._endEditing(_d0f);this._inEditing=false;}},_getBookmark:function(){var b=dojo.withGlobal(this.window,dijit.getBookmark);var tmp=[];if(dojo.isIE){if(dojo.isArray(b)){dojo.forEach(b,function(n){tmp.push(dijit.range.getIndex(n,this.editNode).o);},this);b=tmp;}}else{tmp=dijit.range.getIndex(b.startContainer,this.editNode).o;b={startContainer:tmp,startOffset:b.startOffset,endContainer:b.endContainer===b.startContainer?tmp:dijit.range.getIndex(b.endContainer,this.editNode).o,endOffset:b.endOffset};}return b;},_beginEditing:function(cmd){if(this._steps.length===0){this._steps.push({"text":this.savedContent,"bookmark":this._getBookmark()});}},_endEditing:function(_d14){var v=this.getValue(true);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!dojo.isIE&&!this.iframe&&e.keyCode==dojo.keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode,ks=dojo.keys;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){dojo.stopEvent(e);this.undo();return;}else{if(k==89||k==121){dojo.stopEvent(e);this.redo();return;}}}this.inherited(arguments);switch(k){case ks.ENTER:case ks.BACKSPACE:case ks.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");setTimeout(dojo.hitch(this,this.endEditing),1);}else{this.beginEditing("paste");setTimeout(dojo.hitch(this,this.endEditing),1);}break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<dojo.keys.F1||e.keyCode>dojo.keys.F15)){this.beginEditing();break;}case ks.ALT:this.endEditing();break;case ks.UP_ARROW:case ks.DOWN_ARROW:case ks.LEFT_ARROW:case ks.RIGHT_ARROW:case ks.HOME:case ks.END:case ks.PAGE_UP:case ks.PAGE_DOWN:this.endEditing(true);break;case ks.CTRL:case ks.SHIFT:case ks.TAB:break;}},_onBlur:function(){this.inherited("_onBlur",arguments);this.endEditing(true);},_saveSelection:function(){this._savedSelection=this._getBookmark();},_restoreSelection:function(){if(this._savedSelection){if(dojo.withGlobal(this.window,"isCollapsed",dijit)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},_onFocus:function(){setTimeout(dojo.hitch(this,"_restoreSelection"),0);this.inherited(arguments);},onClick:function(){this.endEditing(true);this.inherited(arguments);}});dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin){return;}var args=o.args,p;var _p=dijit._editor._Plugin;var name=args.name;switch(name){case "undo":case "redo":case "cut":case "copy":case "paste":case "insertOrderedList":case "insertUnorderedList":case "indent":case "outdent":case "justifyCenter":case "justifyFull":case "justifyLeft":case "justifyRight":case "delete":case "selectAll":case "removeFormat":case "unlink":case "insertHorizontalRule":p=new _p({command:name});break;case "bold":case "italic":case "underline":case "strikethrough":case "subscript":case "superscript":p=new _p({buttonClass:dijit.form.ToggleButton,command:name});break;case "|":p=new _p({button:new dijit.ToolbarSeparator()});}o.plugin=p;});}if(!dojo._hasResource["dojox.grid.cells.dijit"]){dojo._hasResource["dojox.grid.cells.dijit"]=true;dojo.provide("dojox.grid.cells.dijit");(function(){var dgc=dojox.grid.cells;dojo.declare("dojox.grid.cells._Widget",dgc._Base,{widgetClass:dijit.form.TextBox,constructor:function(_d1f){this.widget=null;if(typeof this.widgetClass=="string"){dojo.deprecated("Passing a string to widgetClass is deprecated","pass the widget class object instead","2.0");this.widgetClass=dojo.getObject(this.widgetClass);}},formatEditing:function(_d20,_d21){this.needFormatNode(_d20,_d21);return "<div></div>";},getValue:function(_d22){return this.widget.attr("value");},setValue:function(_d23,_d24){if(this.widget&&this.widget.attr){if(this.widget.onLoadDeferred){var self=this;this.widget.onLoadDeferred.addCallback(function(){self.widget.attr("value",_d24==null?"":_d24);});}else{this.widget.attr("value",_d24);}}else{this.inherited(arguments);}},getWidgetProps:function(_d26){return dojo.mixin({},this.widgetProps||{},{constraints:dojo.mixin({},this.constraint)||{},value:_d26});},createWidget:function(_d27,_d28,_d29){return new this.widgetClass(this.getWidgetProps(_d28),_d27);},attachWidget:function(_d2a,_d2b,_d2c){_d2a.appendChild(this.widget.domNode);this.setValue(_d2c,_d2b);},formatNode:function(_d2d,_d2e,_d2f){if(!this.widgetClass){return _d2e;}if(!this.widget){this.widget=this.createWidget.apply(this,arguments);}else{this.attachWidget.apply(this,arguments);}this.sizeWidget.apply(this,arguments);this.grid.rowHeightChanged(_d2f);this.focus();},sizeWidget:function(_d30,_d31,_d32){var p=this.getNode(_d32),box=dojo.contentBox(p);dojo.marginBox(this.widget.domNode,{w:box.w});},focus:function(_d35,_d36){if(this.widget){setTimeout(dojo.hitch(this.widget,function(){dojox.grid.util.fire(this,"focus");}),0);}},_finish:function(_d37){this.inherited(arguments);dojox.grid.util.removeNode(this.widget.domNode);}});dgc._Widget.markupFactory=function(node,cell){dgc._Base.markupFactory(node,cell);var d=dojo;var _d3b=d.trim(d.attr(node,"widgetProps")||"");var _d3c=d.trim(d.attr(node,"constraint")||"");var _d3d=d.trim(d.attr(node,"widgetClass")||"");if(_d3b){cell.widgetProps=d.fromJson(_d3b);}if(_d3c){cell.constraint=d.fromJson(_d3c);}if(_d3d){cell.widgetClass=d.getObject(_d3d);}};dojo.declare("dojox.grid.cells.ComboBox",dgc._Widget,{widgetClass:dijit.form.ComboBox,getWidgetProps:function(_d3e){var _d3f=[];dojo.forEach(this.options,function(o){_d3f.push({name:o,value:o});});var _d41=new dojo.data.ItemFileReadStore({data:{identifier:"name",items:_d3f}});return dojo.mixin({},this.widgetProps||{},{value:_d3e,store:_d41});},getValue:function(){var e=this.widget;e.attr("displayedValue",e.attr("displayedValue"));return e.attr("value");}});dgc.ComboBox.markupFactory=function(node,cell){dgc._Widget.markupFactory(node,cell);var d=dojo;var _d46=d.trim(d.attr(node,"options")||"");if(_d46){var o=_d46.split(",");if(o[0]!=_d46){cell.options=o;}}};dojo.declare("dojox.grid.cells.DateTextBox",dgc._Widget,{widgetClass:dijit.form.DateTextBox,setValue:function(_d48,_d49){if(this.widget){this.widget.attr("value",new Date(_d49));}else{this.inherited(arguments);}},getWidgetProps:function(_d4a){return dojo.mixin(this.inherited(arguments),{value:new Date(_d4a)});}});dgc.DateTextBox.markupFactory=function(node,cell){dgc._Widget.markupFactory(node,cell);};dojo.declare("dojox.grid.cells.CheckBox",dgc._Widget,{widgetClass:dijit.form.CheckBox,getValue:function(){return this.widget.checked;},setValue:function(_d4d,_d4e){if(this.widget&&this.widget.attributeMap.checked){this.widget.attr("checked",_d4e);}else{this.inherited(arguments);}},sizeWidget:function(_d4f,_d50,_d51){return;}});dgc.CheckBox.markupFactory=function(node,cell){dgc._Widget.markupFactory(node,cell);};dojo.declare("dojox.grid.cells.Editor",dgc._Widget,{widgetClass:dijit.Editor,getWidgetProps:function(_d54){return dojo.mixin({},this.widgetProps||{},{height:this.widgetHeight||"100px"});},createWidget:function(_d55,_d56,_d57){var _d58=new this.widgetClass(this.getWidgetProps(_d56),_d55);dojo.connect(_d58,"onLoad",dojo.hitch(this,"populateEditor"));return _d58;},formatNode:function(_d59,_d5a,_d5b){this.content=_d5a;this.inherited(arguments);if(dojo.isMoz){var e=this.widget;e.open();if(this.widgetToolbar){dojo.place(e.toolbar.domNode,e.editingArea,"before");}}},populateEditor:function(){this.widget.attr("value",this.content);this.widget.placeCursorAtEnd();}});dgc.Editor.markupFactory=function(node,cell){dgc._Widget.markupFactory(node,cell);var d=dojo;var h=dojo.trim(dojo.attr(node,"widgetHeight")||"");if(h){if((h!="auto")&&(h.substr(-2)!="em")){h=parseInt(h)+"px";}cell.widgetHeight=h;}};})();}if(!dojo._hasResource["dojox.dtl.dom"]){dojo._hasResource["dojox.dtl.dom"]=true;dojo.provide("dojox.dtl.dom");(function(){var dd=dojox.dtl;dd.BOOLS={checked:1,disabled:1,readonly:1};dd.TOKEN_CHANGE=-11;dd.TOKEN_ATTR=-12;dd.TOKEN_CUSTOM=-13;dd.TOKEN_NODE=1;var ddt=dd.text;var ddh=dd.dom={_attributes:{},_uppers:{},_re4:/^function anonymous\(\)\s*{\s*(.*)\s*}$/,_reTrim:/(?:^[\n\s]*(\{%)?\s*|\s*(%\})?[\n\s]*$)/g,_reSplit:/\s*%\}[\n\s]*\{%\s*/g,getTemplate:function(text){if(typeof this._commentable=="undefined"){this._commentable=false;var div=document.createElement("div");div.innerHTML="<!--Test comment handling, and long comments, using comments whenever possible.-->";if(div.childNodes.length&&div.childNodes[0].nodeType==8&&div.childNodes[0].data=="comment"){this._commentable=true;}}if(!this._commentable){text=text.replace(/<!--({({|%).*?(%|})})-->/g,"$1");}if(dojo.isIE){text=text.replace(/\b(checked|disabled|readonly|style)="/g,"t$1=\"");}text=text.replace(/\bstyle="/g,"tstyle=\"");var _d66;var _d67=dojo.isWebKit;var _d68=[[true,"select","option"],[_d67,"tr","td|th"],[_d67,"thead","tr","th"],[_d67,"tbody","tr","td"],[_d67,"table","tbody|thead|tr","tr","td"]];var _d69=[];for(var i=0,pair;pair=_d68[i];i++){if(!pair[0]){continue;}if(text.indexOf("<"+pair[1])!=-1){var _d6c=new RegExp("<"+pair[1]+"(?:.|\n)*?>((?:.|\n)+?)</"+pair[1]+">","ig");tagLoop:while(_d66=_d6c.exec(text)){var _d6d=pair[2].split("|");var _d6e=[];for(var j=0,_d70;_d70=_d6d[j];j++){_d6e.push("<"+_d70+"(?:.|\n)*?>(?:.|\n)*?</"+_d70+">");}var tags=[];var _d72=dojox.string.tokenize(_d66[1],new RegExp("("+_d6e.join("|")+")","ig"),function(data){var tag=/<(\w+)/.exec(data)[1];if(!tags[tag]){tags[tag]=true;tags.push(tag);}return {data:data};});if(tags.length){var tag=(tags.length==1)?tags[0]:pair[2].split("|")[0];var _d76=[];for(var j=0,jl=_d72.length;j<jl;j++){var _d78=_d72[j];if(dojo.isObject(_d78)){_d76.push(_d78.data);}else{var _d79=_d78.replace(this._reTrim,"");if(!_d79){continue;}_d78=_d79.split(this._reSplit);for(var k=0,kl=_d78.length;k<kl;k++){var _d7c="";for(var p=2,pl=pair.length;p<pl;p++){if(p==2){_d7c+="<"+tag+" dtlinstruction=\"{% "+_d78[k].replace("\"","\\\"")+" %}\">";}else{if(tag==pair[p]){continue;}else{_d7c+="<"+pair[p]+">";}}}_d7c+="DTL";for(var p=pair.length-1;p>1;p--){if(p==2){_d7c+="</"+tag+">";}else{if(tag==pair[p]){continue;}else{_d7c+="</"+pair[p]+">";}}}_d76.push(""+_d69.length);_d69.push(_d7c);}}}text=text.replace(_d66[1],_d76.join(""));}}}}for(var i=_d69.length;i--;){text=text.replace(""+i,_d69[i]);}var re=/\b([a-zA-Z_:][a-zA-Z0-9_\-\.:]*)=['"]/g;while(_d66=re.exec(text)){var _d80=_d66[1].toLowerCase();if(_d80=="dtlinstruction"){continue;}if(_d80!=_d66[1]){this._uppers[_d80]=_d66[1];}this._attributes[_d80]=true;}var div=document.createElement("div");div.innerHTML=text;var _d81={nodes:[]};while(div.childNodes.length){_d81.nodes.push(div.removeChild(div.childNodes[0]));}return _d81;},tokenize:function(_d82){var _d83=[];for(var i=0,node;node=_d82[i++];){if(node.nodeType!=1){this.__tokenize(node,_d83);}else{this._tokenize(node,_d83);}}return _d83;},_swallowed:[],_tokenize:function(node,_d87){var _d88=false;var _d89=this._swallowed;var i,j,tag,_d8d;if(!_d87.first){_d88=_d87.first=true;var tags=dd.register.getAttributeTags();for(i=0;tag=tags[i];i++){try{(tag[2])({swallowNode:function(){throw 1;}},new dd.Token(dd.TOKEN_ATTR,""));}catch(e){_d89.push(tag);}}}for(i=0;tag=_d89[i];i++){var text=node.getAttribute(tag[0]);if(text){var _d89=false;var _d90=(tag[2])({swallowNode:function(){_d89=true;return node;}},new dd.Token(dd.TOKEN_ATTR,tag[0]+" "+text));if(_d89){if(node.parentNode&&node.parentNode.removeChild){node.parentNode.removeChild(node);}_d87.push([dd.TOKEN_CUSTOM,_d90]);return;}}}var _d91=[];if(dojo.isIE&&node.tagName=="SCRIPT"){_d91.push({nodeType:3,data:node.text});node.text="";}else{for(i=0;_d8d=node.childNodes[i];i++){_d91.push(_d8d);}}_d87.push([dd.TOKEN_NODE,node]);var _d92=false;if(_d91.length){_d87.push([dd.TOKEN_CHANGE,node]);_d92=true;}for(var key in this._attributes){var _d94=false;var _d95="";if(key=="class"){_d95=node.className||_d95;}else{if(key=="for"){_d95=node.htmlFor||_d95;}else{if(key=="value"&&node.value==node.innerHTML){continue;}else{if(node.getAttribute){_d95=node.getAttribute(key,2)||_d95;if(key=="href"||key=="src"){if(dojo.isIE){var hash=location.href.lastIndexOf(location.hash);var href=location.href.substring(0,hash).split("/");href.pop();href=href.join("/")+"/";if(_d95.indexOf(href)==0){_d95=_d95.replace(href,"");}_d95=decodeURIComponent(_d95);}}else{if(key=="tstyle"){_d94=key;key="style";}else{if(dd.BOOLS[key.slice(1)]&&dojo.trim(_d95)){key=key.slice(1);}else{if(this._uppers[key]&&dojo.trim(_d95)){_d94=this._uppers[key];}}}}}}}}if(_d94){node.setAttribute(_d94,"");node.removeAttribute(_d94);}if(typeof _d95=="function"){_d95=_d95.toString().replace(this._re4,"$1");}if(!_d92){_d87.push([dd.TOKEN_CHANGE,node]);_d92=true;}_d87.push([dd.TOKEN_ATTR,node,key,_d95]);}for(i=0,_d8d;_d8d=_d91[i];i++){if(_d8d.nodeType==1){var _d98=_d8d.getAttribute("dtlinstruction");if(_d98){_d8d.parentNode.removeChild(_d8d);_d8d={nodeType:8,data:_d98};}}this.__tokenize(_d8d,_d87);}if(!_d88&&node.parentNode&&node.parentNode.tagName){if(_d92){_d87.push([dd.TOKEN_CHANGE,node,true]);}_d87.push([dd.TOKEN_CHANGE,node.parentNode]);node.parentNode.removeChild(node);}else{_d87.push([dd.TOKEN_CHANGE,node,true,true]);}},__tokenize:function(_d99,_d9a){var data=_d99.data;switch(_d99.nodeType){case 1:this._tokenize(_d99,_d9a);return;case 3:if(data.match(/[^\s\n]/)&&(data.indexOf("{{")!=-1||data.indexOf("{%")!=-1)){var _d9c=ddt.tokenize(data);for(var j=0,text;text=_d9c[j];j++){if(typeof text=="string"){_d9a.push([dd.TOKEN_TEXT,text]);}else{_d9a.push(text);}}}else{_d9a.push([_d99.nodeType,_d99]);}if(_d99.parentNode){_d99.parentNode.removeChild(_d99);}return;case 8:if(data.indexOf("{%")==0){var text=dojo.trim(data.slice(2,-2));if(text.substr(0,5)=="load "){var _d9f=dojo.trim(text).split(/\s+/g);for(var i=1,part;part=_d9f[i];i++){dojo["require"](part);}}_d9a.push([dd.TOKEN_BLOCK,text]);}if(data.indexOf("{{")==0){_d9a.push([dd.TOKEN_VAR,dojo.trim(data.slice(2,-2))]);}if(_d99.parentNode){_d99.parentNode.removeChild(_d99);}return;}}};dd.DomTemplate=dojo.extend(function(obj){if(!obj.nodes){var node=dojo.byId(obj);if(node&&node.nodeType==1){dojo.forEach(["class","src","href","name","value"],function(item){ddh._attributes[item]=true;});obj={nodes:[node]};}else{if(typeof obj=="object"){obj=ddt.getTemplateString(obj);}obj=ddh.getTemplate(obj);}}var _da5=ddh.tokenize(obj.nodes);if(dd.tests){this.tokens=_da5.slice(0);}var _da6=new dd._DomParser(_da5);this.nodelist=_da6.parse();},{_count:0,_re:/\bdojo:([a-zA-Z0-9_]+)\b/g,setClass:function(str){this.getRootNode().className=str;},getRootNode:function(){return this.buffer.rootNode;},getBuffer:function(){return new dd.DomBuffer();},render:function(_da8,_da9){_da9=this.buffer=_da9||this.getBuffer();this.rootNode=null;var _daa=this.nodelist.render(_da8||new dd.Context({}),_da9);for(var i=0,node;node=_da9._cache[i];i++){if(node._cache){node._cache.length=0;}}return _daa;},unrender:function(_dad,_dae){return this.nodelist.unrender(_dad,_dae);}});dd.DomBuffer=dojo.extend(function(_daf){this._parent=_daf;this._cache=[];},{concat:function(node){var _db1=this._parent;if(_db1&&node.parentNode&&node.parentNode===_db1&&!_db1._dirty){return this;}if(node.nodeType==1&&!this.rootNode){this.rootNode=node||true;return this;}if(!_db1){if(node.nodeType==3&&dojo.trim(node.data)){throw new Error("Text should not exist outside of the root node in template");}return this;}if(this._closed){if(node.nodeType==3&&!dojo.trim(node.data)){return this;}else{throw new Error("Content should not exist outside of the root node in template");}}if(_db1._dirty){if(node._drawn&&node.parentNode==_db1){var _db2=_db1._cache;if(_db2){for(var i=0,_db4;_db4=_db2[i];i++){this.onAddNode&&this.onAddNode(_db4);_db1.insertBefore(_db4,node);this.onAddNodeComplete&&this.onAddNodeComplete(_db4);}_db2.length=0;}}_db1._dirty=false;}if(!_db1._cache){_db1._cache=[];this._cache.push(_db1);}_db1._dirty=true;_db1._cache.push(node);return this;},remove:function(obj){if(typeof obj=="string"){if(this._parent){this._parent.removeAttribute(obj);}}else{if(obj.nodeType==1&&!this.getRootNode()&&!this._removed){this._removed=true;return this;}if(obj.parentNode){this.onRemoveNode&&this.onRemoveNode(obj);if(obj.parentNode){obj.parentNode.removeChild(obj);}}}return this;},setAttribute:function(key,_db7){var old=dojo.attr(this._parent,key);if(this.onChangeAttribute&&old!=_db7){this.onChangeAttribute(this._parent,key,old,_db7);}if(key=="style"){this._parent.style.cssText=_db7;}else{dojo.attr(this._parent,key,_db7);}return this;},addEvent:function(_db9,type,fn,args){if(!_db9.getThis()){throw new Error("You must use Context.setObject(instance)");}this.onAddEvent&&this.onAddEvent(this.getParent(),type,fn);var _dbd=fn;if(dojo.isArray(args)){_dbd=function(e){this[fn].apply(this,[e].concat(args));};}return dojo.connect(this.getParent(),type,_db9.getThis(),_dbd);},setParent:function(node,up,root){if(!this._parent){this._parent=this._first=node;}if(up&&root&&node===this._first){this._closed=true;}if(up){var _dc2=this._parent;var _dc3="";var ie=dojo.isIE&&_dc2.tagName=="SCRIPT";if(ie){_dc2.text="";}if(_dc2._dirty){var _dc5=_dc2._cache;var _dc6=(_dc2.tagName=="SELECT"&&!_dc2.options.length);for(var i=0,_dc8;_dc8=_dc5[i];i++){if(_dc8!==_dc2){this.onAddNode&&this.onAddNode(_dc8);if(ie){_dc3+=_dc8.data;}else{_dc2.appendChild(_dc8);if(_dc6&&_dc8.defaultSelected&&i){_dc6=i;}}this.onAddNodeComplete&&this.onAddNodeComplete(_dc8);}}if(_dc6){_dc2.options.selectedIndex=(typeof _dc6=="number")?_dc6:0;}_dc5.length=0;_dc2._dirty=false;}if(ie){_dc2.text=_dc3;}}this._parent=node;this.onSetParent&&this.onSetParent(node,up,root);return this;},getParent:function(){return this._parent;},getRootNode:function(){return this.rootNode;}});dd._DomNode=dojo.extend(function(node){this.contents=node;},{render:function(_dca,_dcb){this._rendered=true;return _dcb.concat(this.contents);},unrender:function(_dcc,_dcd){if(!this._rendered){return _dcd;}this._rendered=false;return _dcd.remove(this.contents);},clone:function(_dce){return new this.constructor(this.contents);}});dd._DomNodeList=dojo.extend(function(_dcf){this.contents=_dcf||[];},{push:function(node){this.contents.push(node);},unshift:function(node){this.contents.unshift(node);},render:function(_dd2,_dd3,_dd4){_dd3=_dd3||dd.DomTemplate.prototype.getBuffer();if(_dd4){var _dd5=_dd3.getParent();}for(var i=0;i<this.contents.length;i++){_dd3=this.contents[i].render(_dd2,_dd3);if(!_dd3){throw new Error("Template node render functions must return their buffer");}}if(_dd5){_dd3.setParent(_dd5);}return _dd3;},dummyRender:function(_dd7,_dd8,_dd9){var div=document.createElement("div");var _ddb=_dd8.getParent();var old=_ddb._clone;_ddb._clone=div;var _ddd=this.clone(_dd8,div);if(old){_ddb._clone=old;}else{_ddb._clone=null;}_dd8=dd.DomTemplate.prototype.getBuffer();_ddd.unshift(new dd.ChangeNode(div));_ddd.unshift(new dd._DomNode(div));_ddd.push(new dd.ChangeNode(div,true));_ddd.render(_dd7,_dd8);if(_dd9){return _dd8.getRootNode();}var html=div.innerHTML;return (dojo.isIE)?html.replace(/\s*_(dirty|clone)="[^"]*"/g,""):html;},unrender:function(_ddf,_de0,_de1){if(_de1){var _de2=_de0.getParent();}for(var i=0;i<this.contents.length;i++){_de0=this.contents[i].unrender(_ddf,_de0);if(!_de0){throw new Error("Template node render functions must return their buffer");}}if(_de2){_de0.setParent(_de2);}return _de0;},clone:function(_de4){var _de5=_de4.getParent();var _de6=this.contents;var _de7=new dd._DomNodeList();var _de8=[];for(var i=0;i<_de6.length;i++){var _dea=_de6[i].clone(_de4);if(_dea instanceof dd.ChangeNode||_dea instanceof dd._DomNode){var item=_dea.contents._clone;if(item){_dea.contents=item;}else{if(_de5!=_dea.contents&&_dea instanceof dd._DomNode){var node=_dea.contents;_dea.contents=_dea.contents.cloneNode(false);_de4.onClone&&_de4.onClone(node,_dea.contents);_de8.push(node);node._clone=_dea.contents;}}}_de7.push(_dea);}for(var i=0,_dea;_dea=_de8[i];i++){_dea._clone=null;}return _de7;},rtrim:function(){while(1){var i=this.contents.length-1;if(this.contents[i] instanceof dd._DomTextNode&&this.contents[i].isEmpty()){this.contents.pop();}else{break;}}return this;}});dd._DomVarNode=dojo.extend(function(str){this.contents=new dd._Filter(str);},{render:function(_def,_df0){var str=this.contents.resolve(_def);var type="text";if(str){if(str.render&&str.getRootNode){type="injection";}else{if(str.safe){if(str.nodeType){type="node";}else{if(str.toString){str=str.toString();type="html";}}}}}if(this._type&&type!=this._type){this.unrender(_def,_df0);}this._type=type;switch(type){case "text":this._rendered=true;this._txt=this._txt||document.createTextNode(str);if(this._txt.data!=str){var old=this._txt.data;this._txt.data=str;_df0.onChangeData&&_df0.onChangeData(this._txt,old,this._txt.data);}return _df0.concat(this._txt);case "injection":var root=str.getRootNode();if(this._rendered&&root!=this._root){_df0=this.unrender(_def,_df0);}this._root=root;var _df5=this._injected=new dd._DomNodeList();_df5.push(new dd.ChangeNode(_df0.getParent()));_df5.push(new dd._DomNode(root));_df5.push(str);_df5.push(new dd.ChangeNode(_df0.getParent()));this._rendered=true;return _df5.render(_def,_df0);case "node":this._rendered=true;if(this._node&&this._node!=str&&this._node.parentNode&&this._node.parentNode===_df0.getParent()){this._node.parentNode.removeChild(this._node);}this._node=str;return _df0.concat(str);case "html":if(this._rendered&&this._src!=str){_df0=this.unrender(_def,_df0);}this._src=str;if(!this._rendered){this._rendered=true;this._html=this._html||[];var div=(this._div=this._div||document.createElement("div"));div.innerHTML=str;var _df7=div.childNodes;while(_df7.length){var _df8=div.removeChild(_df7[0]);this._html.push(_df8);_df0=_df0.concat(_df8);}}return _df0;default:return _df0;}},unrender:function(_df9,_dfa){if(!this._rendered){return _dfa;}this._rendered=false;switch(this._type){case "text":return _dfa.remove(this._txt);case "injection":return this._injection.unrender(_df9,_dfa);case "node":if(this._node.parentNode===_dfa.getParent()){return _dfa.remove(this._node);}return _dfa;case "html":for(var i=0,l=this._html.length;i<l;i++){_dfa=_dfa.remove(this._html[i]);}return _dfa;default:return _dfa;}},clone:function(){return new this.constructor(this.contents.getExpression());}});dd.ChangeNode=dojo.extend(function(node,up,root){this.contents=node;this.up=up;this.root=root;},{render:function(_e00,_e01){return _e01.setParent(this.contents,this.up,this.root);},unrender:function(_e02,_e03){if(!_e03.getParent()){return _e03;}return _e03.setParent(this.contents);},clone:function(){return new this.constructor(this.contents,this.up,this.root);}});dd.AttributeNode=dojo.extend(function(key,_e05){this.key=key;this.value=_e05;this.contents=_e05;if(this._pool[_e05]){this.nodelist=this._pool[_e05];}else{if(!(this.nodelist=dd.quickFilter(_e05))){this.nodelist=(new dd.Template(_e05,true)).nodelist;}this._pool[_e05]=this.nodelist;}this.contents="";},{_pool:{},render:function(_e06,_e07){var key=this.key;var _e09=this.nodelist.dummyRender(_e06);if(dd.BOOLS[key]){_e09=!(_e09=="false"||_e09=="undefined"||!_e09);}if(_e09!==this.contents){this.contents=_e09;return _e07.setAttribute(key,_e09);}return _e07;},unrender:function(_e0a,_e0b){this.contents="";return _e0b.remove(this.key);},clone:function(_e0c){return new this.constructor(this.key,this.value);}});dd._DomTextNode=dojo.extend(function(str){this.contents=document.createTextNode(str);this.upcoming=str;},{set:function(data){this.upcoming=data;return this;},render:function(_e0f,_e10){if(this.contents.data!=this.upcoming){var old=this.contents.data;this.contents.data=this.upcoming;_e10.onChangeData&&_e10.onChangeData(this.contents,old,this.upcoming);}return _e10.concat(this.contents);},unrender:function(_e12,_e13){return _e13.remove(this.contents);},isEmpty:function(){return !dojo.trim(this.contents.data);},clone:function(){return new this.constructor(this.contents.data);}});dd._DomParser=dojo.extend(function(_e14){this.contents=_e14;},{i:0,parse:function(_e15){var _e16={};var _e17=this.contents;if(!_e15){_e15=[];}for(var i=0;i<_e15.length;i++){_e16[_e15[i]]=true;}var _e19=new dd._DomNodeList();while(this.i<_e17.length){var _e1a=_e17[this.i++];var type=_e1a[0];var _e1c=_e1a[1];if(type==dd.TOKEN_CUSTOM){_e19.push(_e1c);}else{if(type==dd.TOKEN_CHANGE){var _e1d=new dd.ChangeNode(_e1c,_e1a[2],_e1a[3]);_e1c[_e1d.attr]=_e1d;_e19.push(_e1d);}else{if(type==dd.TOKEN_ATTR){var fn=ddt.getTag("attr:"+_e1a[2],true);if(fn&&_e1a[3]){if(_e1a[3].indexOf("{%")!=-1||_e1a[3].indexOf("{{")!=-1){_e1c.setAttribute(_e1a[2],"");}_e19.push(fn(null,new dd.Token(type,_e1a[2]+" "+_e1a[3])));}else{if(dojo.isString(_e1a[3])){if(_e1a[2]=="style"||_e1a[3].indexOf("{%")!=-1||_e1a[3].indexOf("{{")!=-1){_e19.push(new dd.AttributeNode(_e1a[2],_e1a[3]));}else{if(dojo.trim(_e1a[3])){try{dojo.attr(_e1c,_e1a[2],_e1a[3]);}catch(e){}}}}}}else{if(type==dd.TOKEN_NODE){var fn=ddt.getTag("node:"+_e1c.tagName.toLowerCase(),true);if(fn){_e19.push(fn(null,new dd.Token(type,_e1c),_e1c.tagName.toLowerCase()));}_e19.push(new dd._DomNode(_e1c));}else{if(type==dd.TOKEN_VAR){_e19.push(new dd._DomVarNode(_e1c));}else{if(type==dd.TOKEN_TEXT){_e19.push(new dd._DomTextNode(_e1c.data||_e1c));}else{if(type==dd.TOKEN_BLOCK){if(_e16[_e1c]){--this.i;return _e19;}var cmd=_e1c.split(/\s+/g);if(cmd.length){cmd=cmd[0];var fn=ddt.getTag(cmd);if(typeof fn!="function"){throw new Error("Function not found for "+cmd);}var tpl=fn(this,new dd.Token(type,_e1c));if(tpl){_e19.push(tpl);}}}}}}}}}}if(_e15.length){throw new Error("Could not find closing tag(s): "+_e15.toString());}return _e19;},next_token:function(){var _e21=this.contents[this.i++];return new dd.Token(_e21[0],_e21[1]);},delete_first_token:function(){this.i++;},skip_past:function(_e22){return dd._Parser.prototype.skip_past.call(this,_e22);},create_variable_node:function(expr){return new dd._DomVarNode(expr);},create_text_node:function(expr){return new dd._DomTextNode(expr||"");},getTemplate:function(loc){return new dd.DomTemplate(ddh.getTemplate(loc));}});})();}if(!dojo._hasResource["dojox.dtl.html"]){dojo._hasResource["dojox.dtl.html"]=true;dojo.provide("dojox.dtl.html");dojo.deprecated("dojox.dtl.html","All packages and classes in dojox.dtl that start with Html or html have been renamed to Dom or dom");dojox.dtl.HtmlTemplate=dojox.dtl.DomTemplate;}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ItemListEditor"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ItemListEditor"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ItemListEditor");dojo.declare("nox.ext.apps.commonui.coreui.ItemListEditor",dijit.Dialog,{templateString:"<div class=\"dijitDialog item-list-editor\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\" title=\"${buttonCancel}\">\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\">\n\t\t<div dojoAttachPoint=\"layoutContainer\" class=\"item-list-editor-layout\"\n\t\t\tdojoType=\"dijit.layout.BorderContainer\" design=\"headline\">\n\t\t\t<div dojoType=\"dijit.layout.BorderContainer\" class=\"item-list-editor-main-container\"\n\t\t\t\tdesign=\"sidebar\" region=\"center\">\n\t\t\t\t<div dojoAttachPoint=\"left\" region=\"left\" class=\"item-list-editor-left item-list-editor-list-container\"\n\t\t\t\t\tdojoType=\"dijit.layout.BorderContainer\" design=\"headline\">\n\t\t\t\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"top\" class=\"item-list-editor-list-header\">\n\t\t\t\t\t\tGroups\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- list goes here -->\n\t\t\t\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"bottom\" class=\"item-list-editor-list-footer\">\n\t\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"addGroup\" dojoAttachEvent=\"onClick: onAddGroup\" iconClass=\"addGroup\"></button>\n\t\t\t\t\t\t<button dojoType=\"dijit.form.Button\" disabled=\"true\" dojoAttachPoint=\"editGroup\" dojoAttachEvent=\"onClick: onEditGroup\" iconClass=\"editGroup\"></button>\n\t\t\t\t\t\t<button dojoType=\"dijit.form.Button\" disabled=\"true\" dojoAttachPoint=\"remGroup\" dojoAttachEvent=\"onClick: onRemoveGroup\" iconClass=\"remGroup\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div dojoAttachPoint=\"center\" region=\"center\" class=\"item-list-editor-center\"\n\t\t\t\t\tdojoType=\"dijit.layout.ContentPane\">\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"addOne\" dojoAttachEvent=\"onClick: onAddOne\">&gt;&gt;</button>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"remOne\" dojoAttachEvent=\"onClick: onRemOne\">&lt;&lt;</button>\n\t\t\t\t\t<hr/>\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"addAll\" dojoAttachEvent=\"onClick: onAddAll\">All &gt;&gt;</button>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"remAll\" dojoAttachEvent=\"onClick: onRemAll\">&lt;&lt; All</button>\n\t\t\t\t</div>\n\t\t\t\t<div dojoAttachPoint=\"right\" region=\"right\" class=\"item-list-editor-right item-list-editor-list-container\"\n\t\t\t\t\tdojoType=\"dijit.layout.BorderContainer\" design=\"headline\">\n\t\t\t\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"top\" class=\"item-list-editor-list-header\">\n\t\t\t\t\t\tSelected\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- list goes here -->\n\t\t\t\t\t<!--<div dojoType=\"dijit.layout.ContentPane\" region=\"center\">\n\t\t\t\t\t\t<select multiple=\"true\" dojoAttachPoint=\"allGroups\" class=\"item-list-editor-list\">\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>-->\n\t\t\t\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"bottom\" class=\"item-list-editor-list-footer\">\n\t\t\t\t\t\t<input type=\"text\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"quickAddText\" dojoAttachEvent=\"onFocus: onQuickAddTextFocus, onBlur: onQuickAddTextBlur\" value=\"${quickAddDefaultText}\"/>\n\t\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"quickAddButton\" dojoAttachEvent=\"onClick: onQuickAddClicked\" iconClass=\"addGroup\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div dojoType=\"dijit.layout.ContentPane\" class=\"item-list-editor-dialog-buttons-container\" region=\"bottom\">\n\t\t\t\t<hr/>\n\t\t\t\t<div class=\"item-list-editor-dialog-buttons\">\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelButton\" dojoAttachEvent=\"onClick: onCancel\" >Cancel</button>\n\t\t\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"doneButton\" dojoAttachEvent=\"onClick: onExecute\">Done</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n",widgetsInTemplate:true,quickAddDefaultText:"Quick Add (comma separated)",layoutContainer:null,selectedStore:null,allStore:null,postCreate:function(){this.inherited(arguments);var d1=new dojo.Deferred();var d2=new dojo.Deferred();var dl=new dojo.DeferredList([d1,d2]);dl.addCallback(this,function(_e29){var _e2a=_e29[0][1];var _e2b=_e29[1][1];var _e2c=function(item){for(var i=0,j;j=_e2b[i];i++){if(j.getValue("name")==item.getValue("name")){return true;}}return false;};var _e30=[];for(var i=0,item;item=_e2a[i];i++){if(!_e2c(item)){_e30.push({name:item.getValue("name"),displayName:item.displayName()});}}this.tempAllStore=new dojo.data.ItemFileWriteStore({data:{items:_e30}});var _e33=[{name:"Groups",field:"displayName",width:"100%",editable:true,type:dojox.grid.cells._Widget}];var _e34=this.leftGrid=new dojox.grid.DataGrid({store:this.tempAllStore,query:{},structure:_e33,region:"center"});this.connect(_e34.selection,"onChanged",function(){if(_e34.edit.isEditing()){this.editGroup.attr("disabled",true);this.remGroup.attr("disabled",true);}else{var _e35=_e34.selection.getSelectedCount();this.editGroup.attr("disabled",(_e35!=1));this.remGroup.attr("disabled",(_e35<1));}});this.connect(_e34.edit,"start",function(){this.addGroup.attr("disabled",true);this.editGroup.attr("disabled",true);this.remGroup.attr("disabled",true);});this.connect(_e34.edit,"apply",function(){this.addGroup.attr("disabled",false);this.editGroup.attr("disabled",false);this.remGroup.attr("disabled",false);});this.connect(_e34.edit,"cancel",function(){this.addGroup.attr("disabled",false);this.editGroup.attr("disabled",false);this.remGroup.attr("disabled",false);});this.left.addChild(_e34);_e34.startup();_e30=[];for(var i=0,item;item=_e2b[i];i++){_e30.push({name:item.getValue("name"),displayName:item.displayName()});}this.tempSelectedStore=new dojo.data.ItemFileWriteStore({data:{items:_e30}});var _e36=[{name:"Groups",field:"displayName",width:"100%"}];var _e37=this.rightGrid=new dojox.grid.DataGrid({store:this.tempSelectedStore,query:{},structure:_e36,region:"center"});this.right.addChild(_e37);_e37.startup();this.layoutContainer.resize();});this.allStore.fetch({query:{},onComplete:function(_e38){d1.callback(_e38);}});this.selectedStore.fetch({query:{},onComplete:function(_e39){d2.callback(_e39);}});},_moveItems:function(grid,_e3b,_e3c){var _e3d=grid.selection.getSelected();dojo.forEach(_e3d,function(item){_e3c.newItem({name:item.name,displayName:item.displayName});_e3b.deleteItem(item);});_e3c.save();_e3b.save();},_moveAll:function(_e3f,_e40){_e3f.fetch({query:{},onComplete:function(_e41){dojo.forEach(_e41,function(item){_e40.newItem({name:item.name,displayName:item.displayName});_e3f.deleteItem(item);});_e40.save();_e3f.save();}});},onAddOne:function(){this._moveItems(this.leftGrid,this.tempAllStore,this.tempSelectedStore);},onRemOne:function(){this._moveItems(this.rightGrid,this.tempSelectedStore,this.tempAllStore);},onAddAll:function(){this._moveAll(this.tempAllStore,this.tempSelectedStore);},onRemAll:function(){this._moveAll(this.tempSelectedStore,this.tempAllStore);},onAddGroup:function(){var item=this.tempAllStore.newItem({name:"New Item",displayName:"New Item"});var _e44=this.leftGrid.getItemIndex(item);this.leftGrid.edit.setEditCell(this.leftGrid.layout.cells[0],_e44);},onEditGroup:function(){var _e45=this.leftGrid.selection.getSelected();var _e46=this.leftGrid.getItemIndex(_e45[0]);this.leftGrid.edit.setEditCell(this.leftGrid.layout.cells[0],_e46);},onRemoveGroup:function(){dojo.forEach(this.leftGrid.selection.getSelected(),function(item){this.tempAllStore.deleteItem(item);},this);},onQuickAddTextFocus:function(){var text=dojo.trim(this.quickAddText.attr("value"));if(text==this.quickAddDefaultText){this.quickAddText.attr("value","");this.quickAddText.focus();}},onQuickAddTextBlur:function(){var text=dojo.trim(this.quickAddText.attr("value"));if(text==""){this.quickAddText.attr("value",this.quickAddDefaultText);}},onQuickAddClicked:function(){var text=dojo.trim(this.quickAddText.attr("value"));if(text!=this.quickAddDefaultText&&text!=""){var _e4b=text.split(/\s*,\s*/);for(var i=0,name;name=_e4b[i];i++){this.tempSelectedStore.newItem({name:name,displayName:name});}}},onDoneClicked:function(){this.hide();}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ItemTable"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ItemTable"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ItemTable");dojo.declare("nox.ext.apps.commonui.coreui.ItemTable",[dijit._Widget,dijit._Templated,nox.ext.apps.commonui.coreui._ItemSort],{templateString:"<table class=\"item-table\"><thead><tr dojoAttachPoint=\"headerrow\" class=\"headerRow\"></tr></thead><tbody dojoAttachPoint=\"itemrows\" class=\"itemRows\"></tbody></table>\n",widgetsInTemplate:false,store:null,model:null,ignoreNull:false,changeAnimFn:null,contextMenu:null,displayValidity:false,editAllowed:null,constructor:function(_e4e){this.id_base=dijit.getUniqueId("ItemTable");this._editCell=null;this._editInfo=null;this._editItem=null;this._editor=null;this._editValue=null;this._mouse2down=false;this._menus={};},_get_item_id:function(item){return this.id_base+"-"+this.store.getIdentity(item);},_get_cell_id:function(item,_e51){return this._get_item_id(item)+"-"+_e51;},_get_item_dom_node:function(item){return dojo.byId(this._get_item_id(item));},_get_dom_node_item:function(node){return this.store.fetchItemByIdentity(node.id.substr(this.id_base.length+1));},_get_num_item_dom_nodes:function(){return this.itemrows.rows.length;},_get_item_dom_node_idx:function(idx){return this.itemrows.rows[idx];},_get_store:function(){return this.store;},_item_column_value:function(item,_e56){if(_e56.get!=null){var _e57=_e56.get(item);}else{if(_e56.attr!=null&&_e56.attr!=""){_e57=this.store.getValue(item,_e56.attr,null);}else{_e57=null;}}return _e57;},_value_domtree:function(_e58){if(_e58==null){_e58=document.createTextNode((this.ignoreNull)?"":"-");}else{if(typeof (_e58)=="string"||typeof (_e58)=="number"){_e58=document.createTextNode(_e58.toString());}}var s=document.createElement("span");dojo.addClass(s,"item-table-value-wrapper");s.appendChild(_e58);return s;},_get_edit_value:function(){if(this._editInfo.getEdit!=null){var _e5a=this._editInfo.getEdit(this._editItem);}else{if(this._editInfo.editAttr!=null&&this._editInfo.editAttr!=""){_e5a=this.store.getValue(this._editItem,this._editInfo.editAttr);}else{if(this._editInfo.get!=null){_e5a=this._editInfo.get(this._editItem);}else{if(this._editInfo.attr!=null&&this._editInfo.attr!=""){_e5a=this.store.getValue(this._editItem,this._editInfo.attr);}else{_e5a=null;}}}}if(typeof (_e5a)=="function"){_e5a=_e5a.call(this._editItem);}return _e5a;},_set_value:function(info,item,_e5d){if(info.editSet!=null){info.editSet(item,_e5d);}else{if(info.editAttr!=null&&info.editAttr!=""){this.store.setValue(item,info.editAttr,_e5d);}else{if(info.attr!=null&&info.attr!=""){this.store.setValue(item,info.attr,_e5d);}}}},_destroy_editor:function(){if(this._editCell==null){return;}this._editCell.tabIndex=0;this._editInfo=null;this._editCell=null;this._editItem=null;this._editValue=null;this._editor=null;},_edit_cancel:function(){if(this._editCell==null){return;}this._editCell.replaceChild(this._editValue,this._editCell.childNodes[0]);this._destroy_editor();},_edit_change:function(){if(this._editCell==null){return;}if(typeof (this._editor.isValid)=="function"&&!this._editor.isValid()){return;}this._editCell.replaceChild(this._editValue,this._editCell.childNodes[0]);var info=this._editInfo;var item=this._editItem;var v=this._editor.getValue();this._destroy_editor();this._set_value(info,item,v);},_edit_keypress:function(_e61){switch(_e61.keyCode){case dojo.keys.ESCAPE:this._edit_cancel();break;case dojo.keys.ENTER:this._edit_change();break;}},_edit_start:function(_e62){if(this._mouse2down){this._mouse2down=false;return;}if(this._editCell!=null){if(_e62.currentTarget!=this._editCell){this._edit_cancel();}else{return;}}this._editCell=_e62.currentTarget;this._editInfo=this.model[this._editCell.cellIndex];this._editItem=this._get_dom_node_item(this._editCell.parentNode);if(this._editInfo.editAllowed!=null){if(!this._editInfo.editAllowed.call(this,this._editItem)){this._editCell=null;this._editInfo=null;this._editItem=null;return;}}this._editCell.tabIndex=-1;this._editValue=this._editCell.childNodes[0];this._editor=new this._editInfo.editor(this._editInfo.editorProps);this._editor.setValue(this._get_edit_value());this._editor.focus();dojo.connect(this._editor,"onChange",this,"_edit_change");dojo.connect(this._editor,"onBlur",this,"_edit_cancel");dojo.connect(this._editor.domNode,"onkeypress",this,"_edit_keypress");this._editCell.replaceChild(this._editor.domNode,this._editCell.childNodes[0]);},_create_contextmenu:function(item){var m=new dijit.Menu;if(item!=null){var _e65=this.store.getIdentity(item);if(this._menus[_e65]!=null){this._menus[_e65].destroy();}this._menus[_e65]=m;}dojo.forEach(this.contextMenu,function(_e66){if(item==null&&_e66.includeOnHeader!=true){return;}var _e67=new dijit.MenuItem({label:_e66.label});dojo.connect(_e67,"onClick",this,function(evt){_e66.handler.call(this,item);});m.addChild(_e67);},this);return m;},_display_validity:function(item,row){if(this.displayValidity==true){if(this.store.isValid(item)){dojo.removeClass(row,"item-table-invalid");}else{dojo.addClass(row,"item-table-invalid");}}},_onNewItem:function(item,_e6c){var i=this.itemrows.rows.length;var n=this._node_to_insert_before(item);if(n!=null){i=n.sectionRowIndex;}var r=this.itemrows.insertRow(i);this._display_validity(item,r);r.id=this._get_item_id(item);if(this.contextMenu!=null){var m=this._create_contextmenu(item);m.bindDomNode(r);}dojo.addClass(r,"item-table-item-row");for(i=this.model.length;i>0;i--){var c=r.insertCell(0);var m=this.model[i-1];c.id=this._get_cell_id(item,m.name);dojo.addClass(c,m.name);var v=this._item_column_value(item,m);if(m.editor!=null){dojo.connect(c,"onclick",this,"_edit_start");dojo.connect(c,"onfocus",this,"_edit_start");dojo.connect(c,"onmousedown",this,function(e){if(e.button==2){this._mouse2down=true;}});}c.appendChild(this._value_domtree(v));if(((this.store.isDirty==null)||(!this.store.isDirty(item)))&&this.changeAnimFn!=null){this.changeAnimFn(c).play();}}},_onItemChange:function(item,_e75,_e76,_e77){var r=this._get_item_dom_node(item);if(r==null){return;}this._display_validity(item,r);for(var i=0;i<this.model.length;i++){var m=this.model[i];var c=r.childNodes[i];if(this._editCell!=null&&c==this._editCell){continue;}var v=this._item_column_value(item,m);var t=this._value_domtree(v);if(!nox.ext.apps.commonui.coreui.base.equivDomTrees(t,c.childNodes[0])){c.replaceChild(t,c.childNodes[0]);if(this.changeAnimFn!=null){this.changeAnimFn(c).play();}}}},_onDeleteItem:function(item){var r=this._get_item_dom_node(item);var _e80=this.store.getIdentity(item);if(this._menus[_e80]!=null){var m=this._menus[_e80];m.unBindDomNode(r);m.destroy();delete this._menus[_e80];}r.parentNode.removeChild(r);},postCreate:function(){dojo.connect(this.store,"onNew",this,"_onNewItem");dojo.connect(this.store,"onSet",this,"_onItemChange");dojo.connect(this.store,"onDelete",this,"_onDeleteItem");if(this.header!=false){var m=this._create_contextmenu(null);m.bindDomNode(this.headerrow);for(var i=this.model.length;i>0;i--){var cell=this.headerrow.insertCell(0);cell.appendChild(document.createTextNode(this.model[i-1].header));}}this.store.fetch({query:{},onItem:dojo.hitch(this,"_onNewItem")});}});}if(!dojo._hasResource["dojox.dtl._Templated"]){dojo._hasResource["dojox.dtl._Templated"]=true;dojo.provide("dojox.dtl._Templated");dojo.declare("dojox.dtl._Templated",dijit._Templated,{_dijitTemplateCompat:false,buildRendering:function(){var node;if(this.domNode&&!this._template){return;}if(!this._template){var t=this.getCachedTemplate(this.templatePath,this.templateString,this._skipNodeCache);if(t instanceof dojox.dtl.Template){this._template=t;}else{node=t;}}if(!node){var _e87=dojo._toDom(this._template.render(new dojox.dtl._Context(this)));if(_e87.nodeType!==1&&_e87.nodeType!==3){for(var i=0,l=_e87.childNodes.length;i<l;++i){node=_e87.childNodes[i];if(node.nodeType==1){break;}}}else{node=_e87;}}this._attachTemplateNodes(node);if(this.widgetsInTemplate){var _e8a=dojo.parser.parse(node);this._attachTemplateNodes(_e8a,function(n,p){return n[p];});}if(this.domNode){dojo.place(node,this.domNode,"before");this.destroyDescendants();dojo.destroy(this.domNode);}this.domNode=node;this._fillContent(this.srcNodeRef);},_templateCache:{},getCachedTemplate:function(_e8d,_e8e,_e8f){var _e90=this._templateCache;var key=_e8e||_e8d;if(_e90[key]&&!_e8f){return _e90[key];}_e8e=dojo.string.trim(_e8e||dijit._Templated._sanitizeTemplateString(dojo._getText(_e8d)));if(this._dijitTemplateCompat&&(_e8f||_e8e.match(/\$\{([^\}]+)\}/g))){_e8e=this._stringRepl(_e8e);}if(_e8f||!_e8e.match(/\{[{%]([^\}]+)[%}]\}/g)){return _e90[key]=dojo._toDom(_e8e);}else{return _e90[key]=new dojox.dtl.Template(_e8e);}},render:function(){this.buildRendering();}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.ItemInspector"]){dojo._hasResource["nox.ext.apps.commonui.coreui.ItemInspector"]=true;dojo.provide("nox.ext.apps.commonui.coreui.ItemInspector");dojo.declare("nox.ext.apps.commonui.coreui.ItemInspector",[dijit._Widget,dojox.dtl._Templated],{templateString:"<!--{% load dojox.dtl.contrib.dijit %}-->\n<table class=\"item-inspector\" dojoAttachPoint=\"table\">\n<!--{% for m in model %}-->\n<!--{% if m.separator %}-->\n\t<tr>\n\t\t<td class=\"item-inspector-separator item-inspector-label {{ m.name }}\" colspan=\"2\">{% if m.header %}{{ m.header }}{% endif %}</td>\n\t</tr>\n<!--{% else %}-->\n\t<tr>\n\t\t<td class=\"item-inspector-label\">{{ m.header }}:</td>\n\t\t<td class=\"{{ m.name }} item-inspector-value{% if m.editable or m.editAttr or m.editorProps %} item-inspector-editable{% endif %}{% if m.dialogEditor %} item-inspector-editable-dialog{% endif %}\"><span class=\"item-inspector-value-wrapper\">?</span><!--{% if m.editable or m.editAttr or m.editorProps %}--><img src=\"{{ editIconPath }}\"class=\"item-inspector-edit-icon\" style=\"visibility: hidden;\" /><!--{% endif %}--></td>\n\t</tr>\n<!--{% endif %}-->\n<!--{% endfor %}-->\n</table>\n",editIconPath:dojo.moduleUrl("nox.ext.apps.commonui.coreui","images/editIndicator.png"),widgetsInTemplate:false,item:null,model:null,ignoreNullValues:false,constructor:function(){this._initialized=false;this._editValue=null;this._editRow=null;this._editor=null;},_get_value:function(_e92){if(_e92.get!=null){var _e93=_e92.get(this.item);}else{if(_e92.attr!=null&&_e92.attr!=""){_e93=this.item.getValue(_e92.attr);}else{_e93=null;}}if(typeof (_e93)=="function"){_e93=_e93.call(this.item);}if(_e93==null){_e93=document.createTextNode((this.ignoreNullValues)?"":"?");}else{if(typeof (_e93)=="string"){_e93=document.createTextNode(_e93);}else{if(typeof (_e93)=="number"){_e93=document.createTextNode(String(_e93));}}}return _e93;},_get_edit_value:function(_e94){if(_e94.getEdit!=null){var _e95=_e94.getEdit(this.item);}else{if(_e94.editAttr!=null&&_e94.editAttr!=""){_e95=this.item.getValue(_e94.editAttr);}else{if(_e94.get!=null){_e95=_e94.get(this.item);}else{if(_e94.attr!=null&&_e94.attr!=""){_e95=this.item.getValue(_e94.attr);}else{_e95=null;}}}}if(typeof (_e95)=="function"){_e95=_e95.call(this.item);}return _e95;},_set_value:function(_e96,v){if(_e96.editSet!=null){_e96.editSet(this.item,v);}else{if(_e96.editAttr!=null&&_e96.editAttr!=""){this.item.setValue(_e96.editAttr,v);}else{if(_e96.attr!=null&&_e96.attr!=""){this.item.setValue(_e96.attr,v);}}}},_get_row_value:function(i){return this.table.rows[i].cells[1].childNodes[0];},_set_row_value:function(i,v){this.table.rows[i].cells[1].replaceChild(v,this._get_row_value(i));},_update_row:function(i){var m=this.model[i];if(!m){return;}if(m.separator==null||m.separator!=true){if(this._initialized&&m.noupdate==true){return;}var _e9d=document.createElement("span");dojo.addClass(_e9d,"item-inspector-value-wrapper");_e9d.appendChild(this._get_value(m));var _e9e=this._get_row_value(i);if(!nox.ext.apps.commonui.coreui.base.equivDomTrees(_e9e,_e9d)){this._set_row_value(i,_e9d);if(this.changeAnimFn!=null){this.changeAnimFn(_e9d.parentNode).play();}}}},update:function(){for(var i=0;i<this.model.length;i++){if(this._editRow!=i){this._update_row(i);}}},_destroy_editor:function(){if(this._editRow==null){return;}this.table.rows[this._editRow].cells[1].tabIndex=0;this._editRow=null;this._editValue=null;var e=this._editor;this._editor=null;},_edit_cancel:function(_ea1){if(this._editRow==null){return;}this._set_row_value(this._editRow,this._editValue);this._update_row(this._editRow);if(!_ea1){this._destroy_editor();}},_edit_change:function(_ea2){if(this._editRow==null){return;}if(this._editor.isValid==undefined||(this._editor.isValid&&this._editor.isValid())){this._set_row_value(this._editRow,this._editValue);this._set_value(this.model[this._editRow],this._editor.getValue());this._update_row(this._editRow);if(!_ea2){this._destroy_editor();}}else{this._edit_cancel(_ea2);}},_edit_keypress:function(_ea3){switch(_ea3.keyCode){case dojo.keys.ESCAPE:this._edit_cancel();break;case dojo.keys.ENTER:this._edit_change();break;}},_edit_common:function(_ea4){var _ea5=_ea4.target;while(_ea5&&_ea5.tagName&&_ea5.tagName.toLowerCase()!="td"&&!dojo.hasClass(_ea5,"item-inspector-value")){_ea5=_ea5.parentNode;}_ea5.tabIndex=-1;var i=_ea5.parentNode.rowIndex;if(this._editRow!=null&&i!=this._editRow){this._edit_cancel();}this._editRow=i;this._editValue=this._get_row_value(i);return i;},_edit_start:function(_ea7){var i=this._edit_common(_ea7);this._editor=new this.model[i].editor(this.model[i].editorProps);var val=this._get_edit_value(this.model[i])||"";this._editor.setDisplayedValue(val);dojo.connect(this._editor,"onBlur",this,"_edit_cancel");dojo.connect(this._editor.domNode,"onkeypress",this,"_edit_keypress");this._set_row_value(i,this._editor.domNode);this._editor.focus();},_edit_dialog_start:function(_eaa){var i=this._edit_common(_eaa);var _eac=this.model[i].editor;if(_eac){this._editor=new _eac(this.model[i].editorProps);}else{this._editor=new dijit.Dialog(this.model[i].editorProps);}this._editor.show();dojo.connect(this._editor,"onCancel",dojo.hitch(this,"_edit_cancel",true));dojo.connect(this._editor,"onExecute",dojo.hitch(this,"_edit_apply",true));dojo.connect(this._editor._fadeOut,"onEnd",this,"_destroy_editor");},postCreate:function(){this.inherited(arguments);dojo.query("td.item-inspector-editable",this.table).forEach(function(cell){if(!dojo.hasClass(cell,"item-inspector-editable-dialog")){var _eae,_eaf=false;this.connect(cell,"onmousedown",(function(){return function(e){clearTimeout(_eae);if(_eaf){dojo.stopEvent(e);this._edit_start(e);}_eaf=true;_eae=setTimeout(function(){_eaf=false;},500);};})());this.connect(cell,"onfocus",function(e){if(!_eaf){this._edit_start(e);}});this.connect(cell,"onkeypress",function(e){if(e.keyCode==dojo.keys.ENTER&&this._editRow!=null){this._edit_start(e);}});var _eb3=dojo.query("img.item-inspector-edit-icon",cell)[0];this.connect(_eb3,"onclick","_edit_start");}else{var _eb3=dojo.query("img.item-inspector-edit-icon",cell)[0];this.connect(_eb3,"onclick","_edit_dialog_start");}},this);this.update();this._initialized=true;}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.png"]){dojo._hasResource["nox.ext.apps.commonui.coreui.png"]=true;dojo.provide("nox.ext.apps.commonui.coreui.png");(function(){if(dojo.isIE&&dojo.isIE<7&&document.styleSheets&&document.styleSheets[0]&&document.styleSheets[0].addRule){var _eb4=dojo.moduleUrl("nox.ext.apps.commonui.coreui.png","iepngfix.htc");document.styleSheets[0].addRule("*","behavior: url(\""+_eb4.path+"\")");}})();}if(!dojo._hasResource["dojo.io.iframe"]){dojo._hasResource["dojo.io.iframe"]=true;dojo.provide("dojo.io.iframe");dojo.io.iframe={create:function(_eb5,_eb6,uri){if(window[_eb5]){return window[_eb5];}if(window.frames[_eb5]){return window.frames[_eb5];}var _eb8=null;var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));}var _eba=dojo.isIE?"<iframe name=\""+_eb5+"\" src=\""+turi+"\" onload=\""+_eb6+"\">":"iframe";_eb8=dojo.doc.createElement(_eba);with(_eb8){name=_eb5;setAttribute("name",_eb5);id=_eb5;}dojo.body().appendChild(_eb8);window[_eb5]=_eb8;with(_eb8.style){if(!(dojo.isSafari<3)){position="absolute";}left=top="1px";height=width="1px";visibility="hidden";}if(!dojo.isIE){this.setSrc(_eb8,turi,true);_eb8.onload=new Function(_eb6);}return _eb8;},setSrc:function(_ebb,src,_ebd){try{if(!_ebd){if(dojo.isWebKit){_ebb.location=src;}else{frames[_ebb.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit>521){idoc=_ebb.contentWindow.document;}else{if(dojo.isSafari){idoc=_ebb.document;}else{idoc=_ebb.contentWindow;}}if(!idoc){_ebb.location=src;return;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_ebf){var doc=_ebf.contentDocument||(((_ebf.name)&&(_ebf.document)&&(document.getElementsByTagName("iframe")[_ebf.name].contentWindow)&&(document.getElementsByTagName("iframe")[_ebf.name].contentWindow.document)))||((_ebf.name)&&(document.frames[_ebf.name])&&(document.frames[_ebf.name].document))||null;return doc;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _ec5=null;try{var _ec6=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _ec9=_ec6.handleAs;_ec5=ifd;if(_ec9!="html"){if(_ec9=="xml"){if(dojo.isIE){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _eca=(dii._frame.contentWindow.document).documentElement.innerText;_eca=_eca.replace(/>\s+</g,"><");_eca=dojo.trim(_eca);var _ecb={responseText:_eca};_ec5=dojo._contentHandlers["xml"](_ecb);}}else{_ec5=ifd.getElementsByTagName("textarea")[0].value;if(_ec9=="json"){_ec5=dojo.fromJson(_ec5);}else{if(_ec9=="javascript"){_ec5=dojo.eval(_ec5);}}}}}catch(e){_ec5=e;}finally{_ec6._callNext();}return _ec5;},function(_ecc,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _ecc;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}var dfd=this._currentDfd=this._dfdQueue.shift();var _ed2=dfd.ioArgs;var args=_ed2.args;_ed2._contentToClean=[];var fn=dojo.byId(args["form"]);var _ed5=args["content"]||{};if(fn){if(_ed5){var _ed6=function(name,_ed8){var tn;if(dojo.isIE){tn=dojo.doc.createElement("<input type='hidden' name='"+name+"'>");}else{tn=dojo.doc.createElement("input");tn.type="hidden";tn.name=name;}tn.value=_ed8;fn.appendChild(tn);_ed2._contentToClean.push(name);};for(var x in _ed5){var val=_ed5[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_ed6(x,val[i]);}}else{if(!fn[x]){_ed6(x,val);}else{fn[x].value=val;}}}}var _edd=fn.getAttributeNode("action");var _ede=fn.getAttributeNode("method");var _edf=fn.getAttributeNode("target");if(args["url"]){_ed2._originalAction=_edd?_edd.value:null;if(_edd){_edd.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_ede||!_ede.value){if(_ede){_ede.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_ed2._originalTarget=_edf?_edf.value:null;if(_edf){_edf.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;fn.submit();}else{var _ee0=args.url+(args.url.indexOf("?")>-1?"&":"?")+_ed2.query;this.setSrc(this._frame,_ee0,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _ee2=dfd.ioArgs;var args=_ee2.args;var _ee4=dojo.byId(args.form);if(_ee4){var _ee5=_ee2._contentToClean;for(var i=0;i<_ee5.length;i++){var key=_ee5[i];for(var j=0;j<_ee4.childNodes.length;j++){var _ee9=_ee4.childNodes[j];if(_ee9.name==key){dojo.destroy(_ee9);break;}}}if(_ee2["_originalAction"]){_ee4.setAttribute("action",_ee2._originalAction);}if(_ee2["_originalTarget"]){_ee4.setAttribute("target",_ee2._originalTarget);_ee4.target=_ee2._originalTarget;}}_ee2._finished=true;}};}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.simple_config"]){dojo._hasResource["nox.ext.apps.commonui.coreui.simple_config"]=true;dojo.provide("nox.ext.apps.commonui.coreui.simple_config");coreui=nox.ext.apps.commonui.coreui;dojo.declare("nox.ext.apps.commonui.coreui.simple_config",[],{_put_error_handlers:{401:function(_eea,_eeb,item,_eed){coreui.UpdateErrorHandler.showError("You are not currently logged in. "+" Log in via another browser window "+" to avoid losing unsaved changes on the current page.",{header_msg:"Updating Configuration Failed:"});},400:function(_eee,_eef,item,_ef1){coreui.UpdateErrorHandler.showError(_eee.responseText,{header_msg:"Updating Configuration Failed: Bad Request:"});},500:function(_ef2,_ef3,item,_ef5){coreui.UpdateErrorHandler.showError(_ef2.responseText,{header_msg:"Updating Configuration Failed: Server Error:"});}},_get_error_handlers:{400:function(_ef6,_ef7,item,_ef9){coreui.UpdateErrorHandler.showError(_ef6.responseText,{header_msg:"Retrieving Configuration Data Failed: Bad Request:"});},500:function(_efa,_efb,item,_efd){coreui.UpdateErrorHandler.showError(_efa.responseText,{header_msg:"Retrieving Configuration Data Failed: Server Error:"});}},formToObject:function(_efe){var f=dojo.formToObject(_efe);var _f00="#"+_efe+" input[type='checkbox']";dojo.forEach(dojo.query(_f00),function(x){if(x.checked){f[x.name]=1;}else{f[x.name]=0;}});_f00="#"+_efe+" input[type='integer']";dojo.forEach(dojo.query(_f00),function(x){f[x.name]=parseInt(f[x.name]);});return f;},submit_form:function(_f03){this.submit_form_with_callback(_f03,null);},submit_form_with_callback:function(_f04,_f05){var f=this.formToObject(_f04);if(!f["section_id"]){console_log("Error, form must have element with id 'section_id'");return;}var _f07=f["section_id"];delete f.section_id;for(key in f){if(key.indexOf("ignore_")==0){delete f[key];}}this.submit_config(_f07,f,_f05);},submit_config:function(_f08,_f09,_f0a){var _f0b={url:"/ws.v1/config/"+_f08,headers:{"content-type":"application/json"},putData:dojo.toJson(_f09),load:dojo.hitch(this,function(){this._signal_update_success("Update Successful");if(_f0a){_f0a(arguments);}}),timeout:1000000,errorHandlers:this._put_error_handlers};this._set_status_text("Update in Progress...");nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut(_f0b);},submit_file_form:function(_f0c,cb){var f=this.formToObject(_f0c);if(!f["section_id"]){console_log("Error, form must have element with id 'section_id'");return;}var _f0f=f["section_id"];delete f.section_id;dojo.io.iframe.send({form:_f0c,contentType:"multipart/form-data",handleAs:"html",url:"/ws.v1/config_base64/"+_f0f,load:function(_f10,_f11){if(cb!=null){cb();}return _f10;},errorHandlers:this._put_error_handlers});},_checkbox_value:function(key,_f13){if(_f13==1){return true;}if(_f13!=0){console_log("error, field '"+key+"' should"+" be either 0 or 1");}return false;},clear_form:function(_f14){var _f15=dojo.byId(_f14);for(key in _f15){if(!_f15[key]){continue;}var type=_f15[key].type;if(!type){continue;}if(type=="text"){_f15[key].value="";}else{if(type=="checkbox"){_f15[key].checked=false;}else{if(type=="select-one"){_f15[key].selectedIndex=-1;}}}}},fill_form:function(_f17,_f18){var _f19=dojo.byId(_f18);this.clear_form(_f18);for(key in _f17){if(!_f19[key]){console_log("form has no field with name "+key);continue;}var _f1a=_f17[key];var type=_f19[key].type;if(type=="text"||type=="textarea"||type=="hidden"){_f19[key].value=_f1a;}else{if(type=="checkbox"){_f19[key].checked=this._checkbox_value(key,_f1a);}else{if(type=="select-one"){for(i=0;i<_f19[key].options.length;i++){var op=_f19[key].options[i].innerHTML;var _f1d=op.replace(/^\s+|\s+$/g,"");if(_f1d==_f1a){_f19[key].selectedIndex=i;break;}}}else{console_log("element has unknown type '"+type+"'");}}}}},fill_form_from_config:function(_f1e,cb){var _f20=dojo.byId(_f1e);var _f21=_f20["section_id"].value;var _f22=dojo.hitch(this,function(_f23,_f24){this.fill_form(_f23,_f1e);cb();});this.get_config_as_object(_f21,_f22);},get_config_as_object:function(_f25,cb){this._set_status_text("Loading Configuration Data...");nox.ext.apps.commonui.coreui.getUpdateMgr().xhrGet({url:"/ws.v1/config/"+_f25,load:dojo.hitch(this,function(_f27,_f28){this._signal_update_success("Data Successfully Loaded");cb(_f27);}),timeout:1000000,handleAs:"json",errorHandlers:this._get_error_handlers});},_set_status_text:function(msg){var _f2a=dojo.byId("simple_config_status");if(_f2a!=null){_f2a.innerHTML=msg;}},_signal_update_success:function(msg){var _f2c=dojo.byId("simple_config_status");if(_f2c!=null){_f2c.style.opacity=1;_f2c.innerHTML="<span><font color='green'>"+msg+"</font></span>";var anim=dojo.fadeOut({node:_f2c,duration:5000});anim.play();}}});(function(){var _f2e=null;nox.ext.apps.commonui.coreui.getSimpleConfig=function(){if(_f2e==null){_f2e=new nox.ext.apps.commonui.coreui.simple_config();}return _f2e;};})();}if(!dojo._hasResource["nox.ext.apps.commonui.coreui._UpdatingItem"]){dojo._hasResource["nox.ext.apps.commonui.coreui._UpdatingItem"]=true;dojo.provide("nox.ext.apps.commonui.coreui._UpdatingItem");dojo.declare("nox.ext.apps.commonui.coreui._UpdatingItem",[],{coreui:nox.ext.apps.commonui.coreui,identityAttributes:[],labelAttributes:[],constructor:function(_f2f){this.initialized=false;this.initialData={};this.store=null;this.generation=0;this.updateList=[];this.timeout=30000;this.localChanges=[];this.updateTypes={};this.derivedAttributes={};this.updatemgr=this.coreui.getUpdateMgr();dojo.mixin(this,_f2f);if(this.initialGeneration!=undefined){this.generation=this.initialGeneration;}this._data={};this._derivedData={};this._queuedUpdates=[];this._inProgressUpdates=null;this._pendingUpdateTypes=[];this._queuedSaves=[];this._inProgressSaves=null;this._pendingUpdateTypeSaveCnt=0;this._conflictList=[];this._onLoadCallbacks=[];this._flags=[];this._updateBasicData(this.initialData);this.initialized=true;},update:function(_f30){if(this.hasFlag("deleted")){return;}if(_f30==undefined){_f30={};}_f30.errhandler=this.coreui.UpdateErrorHandler.kwCreate(_f30);if(_f30.conflictHandler==null){_f30.conflictHandler=this._defaultConflictHandler;}this._queuedUpdates.push(_f30);if(this._inProgressUpdates!=null){return;}this._startUpdate();},_startUpdate:function(){this._inProgressUpdates=this._queuedUpdates;this._queuedUpdates=[];this.generation++;if(this.initialized){this.onUpdateStart(this);}this._conflictList=[];dojo.forEach(this._inProgressUpdates,function(a){if(a.onComplete!=undefined){this._onLoadCallbacks.push({scope:a.scope,onItem:a.onComplete});}if(a.newData!=undefined){this._updateBasicData(a.newData);}},this);this._pendingUpdateTypes=dojo.clone(this.updateList);this._startNextUpdate();},_startNextUpdate:function(){if(this._pendingUpdateTypes.length>0){var ut=this._pendingUpdateTypes.shift();var fn=this.updateTypes[ut].load;if(fn==undefined){throw new Error("Unknown update type: ",ut);}var d=fn.call(this);if(d==null){this._startNextUpdate();}else{d.addCallback(dojo.hitch(this,this._startNextUpdate));}}else{var kw=this._inProgressUpdates[this._inProgressUpdates.length-1];if(this._conflictList.length>0){var d=kw.conflictHandler.call(kw.scope,this._conflictList);if(d instanceof dojo.Deferred){d.addCallback(this._handleResolvedConflicts);}else{this._handleResolvedConflicts(d);}}else{this._finishUpdate();}}},_defaultConflictHandler:function(l){return l;},_updateBasicData:function(_f37){var _f38=[];for(var a in _f37){var _f3a=dojo.filter(this.localChanges,function(c){return c.attribute==a;});var _f3c=_f3a.length;if(_f3c>0&&_f3a[_f3c-1].newValue!=_f37[a]){if(_f3a[0].oldValue!=_f37[a]){var _f3d=_f3a[_f3c-1].newValue;this.onConflictDetected(i,a,_f3d,_f37[a]);this._conflictList.push({attribute:a,oldValue:_f3d,newValue:_f37[a]});}}else{var _f3e=this._updateBasicAttribute(a,_f37[a]);if(_f3e!=null){_f38.push(_f3e);if(this.initialized){this.onChange(this,_f3e.attribute,_f3e.oldValue,_f3e.newValue);}}}}this._handleDerivedChanges(_f38);},_updateBasicAttribute:function(_f3f,_f40){var _f41=this._data[_f3f];if(_f41==_f40){return null;}this._data[_f3f]=_f40;return {"attribute":_f3f,"oldValue":_f41,"newValue":_f40};},_handleDerivedChanges:function(_f42){for(var a in this.derivedAttributes){var da=this.derivedAttributes[a];if((da.isAvailable==undefined||da.isAvailable.call(this))&&(da.hasChanged==undefined||da.hasChanged.call(this,_f42))){var _f45=this._derivedData[a];var _f46=this._getAttribute(a);if(_f45!=_f46){this._derivedData[a]=_f46;if(this.initialized){this.onChange(this,a,_f45,_f46);}}}}},_handleResolvedConflicts:function(_f47){dojo.forEach(_f47,function(c){if(c.resolution==undefined||c.resolution==c.oldValue){}else{if(c.resolution==c.newValue){this.localChanges=dojo.filter(this.localChanges,function(l){return l.attribute!=c.attribute;});this._updateBasicAttribute(c.attribute,c.resolution);this._handleDerivedChanges([{attribute:c.attribute,oldValue:c.oldValue,newValue:c.resolution}]);}else{var _f4a=this.setAttribute(c.attribute,c.resolution);if(_f4a!=null){this.localChanges.push(_f4a);this.onChange(this,_f4a.attribute,_f4a.oldValue,_f4a.newValue);this._handleDerivedChanges([_f4a]);}}}this.onConflictResolved(this,c.attribute,c.resolution);},this);this._conflictList=[];this._finishUpdate();},_finishUpdate:function(){this._doLoadCallbacks();this.onUpdateComplete(this);this._inProgressUpdates=null;if(this._queuedUpdates.length>0){this._startUpdate();}},_doLoadCallbacks:function(){dojo.forEach(this._onLoadCallbacks,function(c){c.onItem.call(c.scope==undefined?dojo.global:c.scope,this);},this);this._onLoadCallbacks=[];},basicDataChanged:function(_f4c,_f4d){return dojo.some(_f4d,function(c){dojo.some(_f4c,function(a){return a==c.attribute;});});},isLoaded:function(){return (this.initialized&&this._pendingUpdateTypes.length==0&&this._conflictList.length==0&&this._inProgressUpdates!=null);},load:function(_f50){this._onLoadCallbacks.push(_f50);if(this.isLoaded()){this._doLoadCallbacks();}},_xhrGetMixin:function(_f51,url,_f53){var d=new dojo.Deferred();this.updatemgr.xhrGet({url:url,load:dojo.hitch(this,function(_f55,_f56){if(_f53!=null){_f55=_f53.call(this,_f55);}this._updateBasicData(_f55);d.callback();}),error:dojo.hitch(this,function(err,_f58){var kw=this._inProgressUpdates[this._inProgressUpdates.length-1];var v=kw.errhandler.call(null,err,_f58,this,_f51);if(!v){d.callback();}return v;}),timeout:this.timeout,handleAs:"json"});return d;},_storeQueryMixin:function(_f5b,_f5c,_f5d,_f5e,_f5f){var d=new dojo.Deferred();var _f61=dojo.hitch(this,function(){_f5d.fetch({query:_f5e,onComplete:dojo.hitch(this,function(_f62,_f63){if(_f5f!=null){_f62=_f5f.call(this,_f62);}var data={};data[_f5c]=_f62;this._updateBasicData(data);d.callback();})});});_f5d.update({onComplete:_f61,onError:dojo.hitch(this,function(_f65,_f66){var kw=this._inProgressUpdates[this._inProgressUpdates.length-1];var v=kw.errhandler.call(null,_f65,_f66,this,_f5b);if(!v){d.callback();}return v;})});return d;},getValue:function(_f69,_f6a){v=this._getAttribute(_f69);if(v==undefined){return _f6a;}return dojo.isArray(v)?v[0]:v;},getValues:function(_f6b){v=this._getAttribute(_f6b);if(v==undefined){return [];}return dojo.isArray(v)?v:[v];},_getAttribute:function(_f6c){var v=undefined;var da=this.derivedAttributes[_f6c];if(da!=null){if(da.get!=null){v=da.get.call(this);this._derivedData[_f6c]=v;}else{throw new Error("No get function for derived attribute: "+_f6c);}}else{v=this._data[_f6c];}return v;},setValue:function(_f6f,_f70){this.setAttribute(_f6f,dojo.isArray(_f70)?_f70[0]:_f70);},setValues:function(_f71,_f72){this.setAttribute(_f71,dojo.isArray(_f72)?_f72:[_f72]);},unsetAttribute:function(_f73){this.setAttribute(_f73,undefined);},setAttribute:function(_f74,_f75){var da=this.derivedAttributes[_f74];if(da!=null){if(da.set==null){throw new Error("No set function for derived attribute: "+_f74);}else{da.set.call(this,_f75);}}else{var _f77=this._updateBasicAttribute(_f74,_f75);if(_f77!=null){this.localChanges.push(_f77);this.onChange(this,_f77.attribute,_f77.oldValue,_f77.newValue);this._handleDerivedChanges([_f77]);}}},revert:function(){var _f78={};dojo.forEach(this.localChanges.reverse(),function(i){_f78[i.attribute]=i.oldValue;},this);for(var a in _f78){var v=_f78[a];if(dojo.isArray(v)&&v.length>0&&v[0]==undefined){this.setAttribute(a,v[0]);}this.setAttribute(a,v);}this.localChanges=[];},acceptLocalChanges:function(){this.localChanges=[];},getAttributes:function(){attrlist=[];for(var a in this._data){attrlist.push(a);}for(a in this.derivedAttributes){if(this.derivedAttributes[a].isAvailable!=undefined){if(this.derivedAttributes[a].isAvailable.call(this)){attrlist.push(a);}}else{attrlist.push(a);}}return attrlist;},hasAttribute:function(_f7d){return ((this._data[_f7d]!=undefined)||(this.derivedAttributes[a]!=undefined&&this.derivedAttributes[a].isAvailable.call(this)));},containsValue:function(_f7e,_f7f){return dojo.some(this.getValues(_f7e),function(i){return i==_f7f;});},getIdentity:function(){if(this.identityAttributes.length==0){throw new Error("This item does not support identities");}return dojo.map(this.identityAttributes,"return this._data[item];",this).join(":");},getIdentityAttributes:function(){if(this.identityAttributes.length==0){throw new Error("This item does not support identities");}return this.identityAttributes;},getLabel:function(){if(this.labelAttributes.length==0){throw new Error("This item does not support labels");}return dojo.map(this.labelAttributes,"return this._data[item];",this).join(":");},getLabelAttributes:function(){if(this.labelAttributes.length==0){throw new Error("This item does not support labels");}return this.labelAttributes;},isDirty:function(){return this.localChanges.length!=0;},flags:function(){return this._flags;},hasFlag:function(_f81){return dojo.some(this._flags,function(i){return i==_f81;});},setFlag:function(_f83){if(!this.hasFlag(_f83)){this._flags.push(_f83);}},unsetFlag:function(_f84){this._flags=dojo.filter(this._flags,function(i){return i!=_f84;});},isValid:function(){return true;},createOnServer:function(_f86){throw new Error("This item does not know how to create itself on the server.");},deleteOnServer:function(_f87){throw new Error("This item does not know how to delete itself from the server.");},save:function(_f88){if(_f88==undefined){_f88={};}_f88.errhandler=this.coreui.UpdateErrorHandler.kwCreate(_f88);this._queuedSaves.push(_f88);if(this._inProgressSaves!=null){return;}this._startSave();},_startSave:function(){this._inProgresSaves=this._queuedSaves;this._queuedSaves=[];this._pendingUpdateTypeSaveCnt=this.updateList.length;dojo.forEach(this.updateList,function(ut){try{var fn=this.updateTypes[ut].save;}catch(e){fn=null;}if(fn==null){this._pendingUpdateTypeSaveCnt--;return;}var d=fn.call(this);if(d==null){this._pendingUpdateTypeSaveCnt--;return;}d.addCallback(dojo.hitch(this,"_handleSaveComplete"));},this);if(this._pendingUpdateTypeSaveCnt==0){this._finishSave();}},_handleSaveComplete:function(_f8c,err){if(--this._pendingUpdateTypeSaveCnt==0){this._finishSave();}},_finishSave:function(){this.acceptLocalChanges();dojo.forEach(this._inProgressSaves,function(kw){if(kw.onComplete!=undefined){kw.onComplete.call(kw.scope);}},this);this._inProgressSaves=null;},_xhrPutData:function(_f8f,url,_f91){var d=new dojo.Deferred();if(_f91!=undefined){data=_f91(this);}this.updatemgr.rawXhrPut({url:url,headers:{"content-type":"application/json"},putData:dojo.toJson(this._data),load:dojo.hitch(this,function(_f93,_f94){d.callback();}),error:dojo.hitch(this,function(err,_f96){var kw=this._inProgressSaves[this._inProgressSaves.length-1];var v=kw.errhandler.call(null,err,_f96,this,_f8f);if(!v){d.callback();}return v;}),timeout:this.timeout,handleAs:"json"});return d;},onUpdateStart:function(item){},onChange:function(item,_f9b,_f9c,_f9d){},onConflictDetected:function(item,_f9f,_fa0,_fa1){},onConflictResolved:function(item,_fa3,_fa4){},onUpdateComplete:function(item){},installDebugLogging:function(){dojo.connect(this,"onUpdateStart",this,function(i){console_log("Item: ",i," update started.");});dojo.connect(this,"onChange",this,function(i,a,o,n){console_log("Item: ",i," attribute: ",a," changed from: ",o," to: ",n);});dojo.connect(this,"onConflictDetected",this,function(i,a,l,s){console_log("Item: ",i," conflict detected in attribute: ",a," local value: ",l," server value: ",s);});dojo.connect(this,"onConflictResolved",this,function(i,a,f){console_log("Item: ",i," conflict resolved in attribute: ",a," final value: ",f);});dojo.connect(this,"onUpdateComplete",this,function(i){console_log("Item: ",i," updated completed.");});}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui._NamedEntity"]){dojo._hasResource["nox.ext.apps.commonui.coreui._NamedEntity"]=true;dojo.provide("nox.ext.apps.commonui.coreui._NamedEntity");dojo.declare("nox.ext.apps.commonui.coreui._NamedEntity",[nox.ext.apps.commonui.coreui._UpdatingItem],{identityAttributes:["name"],labelAttributes:["name"],constructor:function(_fb3){dojo.mixin(this.derivedAttributes,{displayName:{get:this.displayName,hasChanged:this.nameHasChanged}});if(this._data.name==undefined){this._data.name=null;}},isNull:function(){return this._data.name==null||this._data.name=="";},nameHasChanged:function(l){return dojo.some(l,"return item.attribute == 'name';");},displayName:function(){return this._data.name;},check_name:function(name){if(name==""||name.indexOf("#")!=-1||name.indexOf(";")!=-1||name.indexOf("'")!=-1||name.indexOf("\"")!=-1){return false;}return true;}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.Directory"]){dojo._hasResource["nox.ext.apps.commonui.directory.Directory"]=true;dojo.provide("nox.ext.apps.commonui.directory.Directory");dojo.declare("nox.ext.apps.commonui.directory.Directory",[nox.ext.apps.commonui.coreui._NamedEntity],{principal_types:["user","host","switch","location","hostnetname"],group_types:["user","host","switch","location","dladdr","nwaddr","hostnetname"],constructor:function(_fb6){dojo.mixin(this.updateTypes,{"info":{load:dojo.hitch(this,"updateInfo"),save:dojo.hitch(this,"storeInfo")}});dojo.forEach(this.principal_types,function(_fb7){if(this._data.name=="discovered"){this._data["enabled_principals"][_fb7]="RO";}if(this._data.enabled_principals[_fb7]=="RW"){this._data["read_"+_fb7+"_enabled"]=true;this._data["write_"+_fb7+"_enabled"]=true;}else{if(this._data.enabled_principals[_fb7]=="RO"){this._data["read_"+_fb7+"_enabled"]=true;this._data["write_"+_fb7+"_enabled"]=false;}else{this._data["read_"+_fb7+"_enabled"]=false;this._data["write_"+_fb7+"_enabled"]=false;}}},this);dojo.forEach(this.group_types,function(_fb8){if(this._data.name=="discovered"){this._data["enabled_groups"][_fb8]="RO";}if(this._data.enabled_groups[_fb8]=="RW"){this._data["read_"+_fb8+"group_enabled"]=true;this._data["write_"+_fb8+"group_enabled"]=true;}else{if(this._data.enabled_groups[_fb8]=="RO"){this._data["read_"+_fb8+"group_enabled"]=true;this._data["write_"+_fb8+"group_enabled"]=false;}else{this._data["read_"+_fb8+"group_enabled"]=false;this._data["write_"+_fb8+"group_enabled"]=false;}}},this);delete this._data.enabled_principals;delete this._data.enabled_groups;},wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/directory/instance/"+this.displayName();},updateInfo:function(_fb9){return this._xhrGetMixin("info",this.wsv1Path());},storeInfo:function(_fba){return this._xhrPutData("info",this.wsv1Path());}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui._UpdatingStore"]){dojo._hasResource["nox.ext.apps.commonui.coreui._UpdatingStore"]=true;dojo.provide("nox.ext.apps.commonui.coreui._UpdatingStore");dojo.declare("nox.ext.apps.commonui.coreui._UpdatingStore",[],{coreui:nox.ext.apps.commonui.coreui,url:null,timeout:30000,autoUpdate:null,_handling_server_response:false,constructor:function(_fbb){this.itemConstructor=nox.ext.apps.commonui.coreui._UpdatingItem;this.itemParameters={};if(_fbb==null){_fbb={};}dojo.mixin(this,_fbb);this.updatemgr=this.coreui.getUpdateMgr();this._internals_init();if(this.autoUpdate!=null){this._updateItemsFromServer(this.autoUpdate);}else{this.initialized=true;}},_internals_init:function(){this.generation=0;this._items=[];this._oldItems=null;this._localItems=0;this.initialized=false;this._pendingFetches=[];this._queuedUpdates=[];this._inProgressUpdates=null;this._pendingItemUpdates=0;this._queuedSaves=[];this._queueAllSaves=false;this._inProgressSaves=null;this._pendingItemSaves=0;this._update=null;this._byId={};this._changingIdentity=false;},destroy:function(){if(this._update!=null){this._update.cancel();}dojo.forEach(this._items,function(i){this._deleteItem(i);},this);this._internals_init();},update_url:function(url){this.destroy();this.url=url;this.initialized=true;if(this.autoUpdate!=null){this._updateItemsFromServer(this.autoUpdate);}else{this.initialized=true;}},update:function(_fbe){if(this.autoUpdate!=null&&this.initialized){this.updatemgr.updateNow();}else{this._updateItemsFromServer(_fbe);}},_updateItemsFromServer:function(_fbf){if(_fbf==undefined){_fbf={};}_fbf.errhandler=this.coreui.UpdateErrorHandler.kwCreate(_fbf);this._queuedUpdates.push(_fbf);if(this._inProgressUpdates!=null){return;}this._startUpdate();},_startUpdate:function(){this._inProgressUpdates=this._queuedUpdates;this._queuedUpdates=[];this._update=this.updatemgr.xhrGet({url:this.url,load:dojo.hitch(this,"_handleServerResponse"),error:this._inProgressUpdates.slice(-1)[0].errhandler,timeout:this.timeout,handleAs:"json",recur:this.autoUpdate!=null});},_handleServerResponse:function(_fc0,_fc1){var _fc2=this._items;this._items=[];this._handlingServerResponse=true;var _fc3=this._unpackData(_fc0);this._pendingItemUpdates=_fc3.length;dojo.forEach(_fc3,function(d){var i=this._findOrCreateItem(d);i.update({newData:d,scope:this,onComplete:this._updateCompleteHandler,onError:this._inProgressUpdates.slice(-1)[0].errhandler});},this);this.generation++;this._removeDeletedItems(_fc2);this._handlingServerResponse=false;if(_fc3.length==0){this._finishUpdate();}this._handlePendingFetches();},_unpackData:function(_fc6){return _fc6;},_findOrCreateItem:function(_fc7){var _fc8={};dojo.mixin(_fc8,this.itemParameters);dojo.mixin(_fc8,{store:this,initialData:_fc7,initialGeneration:this.generation,onChange:dojo.hitch(this,this._itemChangeHandler)});var i=new this.itemConstructor(_fc8);var id=i.getIdentity();var o=this.fetchItemByIdentity(id);if(o!=null&&o.hasFlag("new")){o.unsetFlag("new");}return (o!=null)?this._insertItem(o,-1):this._addItem(i,-1);},_itemChangeHandler:function(item,_fcd,_fce,_fcf){if(!this._changingIdentity){this.onSet(item,_fcd,_fce,_fcf);}},_insertItem:function(item,_fd1){if(_fd1>=0){var i=Math.min(_fd1,this._items.length);}else{i=Math.max(this._items.length+(_fd1+1),0);}this._items.splice(i,0,item);return item;},_addItem:function(item,_fd4){var id=item.getIdentity();if(this._byId[id]!=undefined){if(!this._byId[id].hasFlag("deleted")){throw new Error("Item already exists with id: ",id);}}this._byId[id]=item;this._insertItem(item,_fd4);if(this.initialized){this.onNew(item,null);}return item;},_updateCompleteHandler:function(item){if(--this._pendingItemUpdates==0){this._finishUpdate();}},_removeDeletedItems:function(_fd7){this._localItems=0;dojo.forEach(_fd7,function(i){if(i.generation<this.generation){var _fd9=i.hasFlag("deleted");if(i.hasFlag("new")&&!_fd9){this._localItems++;this._items.unshift(i);}else{if(i.isDirty()&&!_fd9){this._localItems++;this._items.unshift(i);}else{if(!_fd9){this._deleteItem(i);}i.store=null;delete this._byId[i.getIdentity()];}}}},this);},_deleteItem:function(item){if(item.hasFlag("deleted")){return;}item.setFlag("deleted");if(this.initialized){this.onDelete(item);}},_finishUpdate:function(){if(this.initialized==false){this.initialized=true;this._handlePendingFetches();}dojo.forEach(this._inProgressUpdates,function(kw){if(kw.onComplete!=null){kw.onComplete.call(kw.scope);}},this);if(this.autoUpdate==null){this._inProgressUpdates=null;if(this._queuedUpdates.length>0){this._startUpdate();}}else{if(this._queuedUpdates.length>0){this._queuedUpdates=[];}}},getFeatures:function(){return {"dojo.data.api.Identity":true,"dojo.data.api.Read":true,"dojo.data.api.Write":true,"dojo.data.api.Notification":true};},getIdentity:function(item){return item.getIdentity();},getIdentityAttributes:function(item){return item.getIdentityAttributes();},fetchItemByIdentity:function(_fde){if(typeof _fde=="string"){return this._byId[_fde];}else{var item=this._byId[_fde.identity];_fde.onItem.call(_fde.scope,item);}},getValue:function(item,_fe1,_fe2){return item.getValue(_fe1,_fe2);},getValues:function(item,_fe4){return item.getValues(_fe4);},getAttributes:function(item){return item.getAttributes();},hasAttribute:function(item,_fe7){return item.hasAttribute(_fe7);},containsValue:function(item,_fe9,_fea){return item.containsValue(_fe9,_fea);},isItem:function(item){return item.store==this;},isItemLoaded:function(item){return item.isLoaded();},loadItem:function(_fed){_fed.item.load(_fed);},_item_matches_query:function(item,_fef,_ff0){if(item.hasFlag("deleted")){return false;}if(this.preQuery&&!this.preQuery(item)){return false;}for(var k in _fef){var _ff2=false;var ev=_fef[k];var re=_ff0[k];var _ff5=this.getValues(item,k);for(var i=0;i<_ff5.length&&!_ff2;i++){var v=_ff5[i];if(typeof (v)=="string"&&re!=null){_ff2=v.match(re);}else{if(typeof (ev)=="function"){_ff2=ev(v);}else{_ff2=v==ev;}}}if(!_ff2){return false;}}return true;},_handlePendingFetches:function(){for(var i=0;i<this._pendingFetches.length;i++){this._pendingFetches[i].call(this);}this._pendingFetches=[];},_fetchItems:function(_ff9,_ffa,_ffb){var _ffc=_ff9.queryOptions?_ff9.queryOptions.ignoreCase:false;var _ffd={};var _ffe=_ff9["query"];if(_ffe!=null){for(var k in _ffe){var v=_ffe[k];if(typeof (v)=="string"){_ffd[k]=dojo.data.util.filter.patternToRegExp(v,_ffc);}}}var f=function(){var items=[];for(var i=0;i<this._items.length;i++){var item=this._items[i];if(!this._item_matches_query(item,_ffe,_ffd)){continue;}items.push(item);}_ffa(items,_ff9);};if(this.initialized&&!this._handlingServerResponse){f.call(this);}else{this._pendingFetches.push(f);}},close:function(){},getLabel:function(item){return item.getLabel();},getLabelAttributes:function(item){return item.getLabelAttributes();},_clearItems:function(){var _1007=this._items;this._items=[];dojo.forEach(_1007,function(i){if(i.hasFlag("new")||i.hasFlag("deleted")||i.isDirty()){this._items.push(i);}else{i.store!=null;delete this._byId[i.getIdentity()];if(this.initialized){this.onDelete(i);}}},this);},newItem:function(kwarg,_100a){var i=new this.itemConstructor({store:this,initialData:kwarg,initialGeneration:this.generation,onChange:dojo.hitch(this,this._itemChangeHandler)});i.setFlag("new");this._addItem(i,0);},deleteItem:function(item){this._deleteItem(item,true);},setValue:function(item,_100e,value){this._prepareForAnyIdentityChange(item,_100e);item.setValue(_100e,value);this._completeAnyIdentityChange(item);},setValues:function(item,_1011,_1012){this._prepareForAnyIdentityChange(item,_1011);item.setValues(_1011,_1012);this._completeAnyIdentityChange(item);},_prepareForAnyIdentityChange:function(item,_1014){if(dojo.some(item.getIdentityAttributes(),function(a){return a==_1014;})){this._changingIdentity=true;this.queueAllSaves();delete this._byId[item.getIdentity()];this.onDelete.call(dojo.global,item);}},_completeAnyIdentityChange:function(item){if(this._changingIdentity){this._byId[item.getIdentity()]=item;this.onNew.call(dojo.global,item);this._changingIdentity=false;this.releaseQueuedSaves();}},unsetAttribute:function(item,_1018,_1019){item.unsetAttribute(_1018);},isDirty:function(item){return item.isDirty();},save:function(kwarg){if(kwarg==undefined){kwarg={};}kwarg.errhandler=this.coreui.UpdateErrorHandler.kwCreate(kwarg);this._queuedSaves.push(kwarg);if(this._inProgressSaves!=null||this._queueAllSaves){return;}this._startSave();},queueAllSaves:function(){this._queueAllSaves=true;},releaseQueuedSaves:function(){if(this._queueAllSaves==false){return;}this._queueAllSaves=false;if(this._inProgressSaves==null&&this._queuedSaves.length>0){this._startSave();}},_startSave:function(){this._inProgressSaves=this._queuedSaves;this._queuedSaves=[];var data=this._packData();if(data=="abort"){return;}if(data!=null){this.updatemgr.rawXhrPut({url:this.url,headers:{"content-type":"application/json"},putData:dojo.toJson(data),timeout:this.timeout,load:dojo.hitch(this,function(_101d,_101e){this._finishSave();},this),error:this._inProgressSaves.slice(-1)[0].errhandler});}else{this._pendingItemSaves=this._items.length;dojo.forEach(this._items,function(i){var kw={scope:this,onComplete:dojo.hitch(this,"_itemSaveComplete"),onError:this._inProgressSaves.slice(-1)[0].errhandler};if(i.hasFlag("new")){i.createOnServer(kw);}else{if(i.hasFlag("deleted")){i.deleteOnServer(kw);}else{if(i.isDirty()){i.save(kw);}else{this._itemSaveComplete();}}}},this);}},_packData:function(){return null;},_packDataList:function(kwarg){var _1022=false;var _1023=[];dojo.forEach(this._items,function(i){if(!i.hasFlag("deleted")){if(i.isValid()){if(kwarg.packFn==null){_1023.push(i._data);}else{_1023.push(kwarg.packFn(i));}}else{_1022=true;}}},this);if(_1022&&kwarg.abortOnInvalid){return "abort";}if(kwarg.name==null){return _1023;}else{var o={};o[kwarg.name]=_1023;return dojo.mixin(o,kwarg.otherData);}},_itemSaveComplete:function(body,_1027){if(--this._pendingItemSaves==0){this._finishSave();}},_finishSave:function(){this.acceptLocalChanges();dojo.forEach(this._inProgressSaves,function(kw){if(kw.onComplete!=null){kw.onComplete.call(kw.scope);}},this);this._inProgressSaves=null;if(this._queuedSaves.length>0){this._startSave();}},acceptLocalChanges:function(){var _1029=this._items;this._items=[];dojo.forEach(_1029,function(item){if(item.hasFlag("deleted")){item.store=null;delete this._byId[item.getIdentity()];return;}if(item.isValid()){if(item.hasFlag("new")){item.unsetFlag("new");}item.acceptLocalChanges();}item.generation=this.generation;this._items.push(item);},this);},revert:function(){dojo.forEach(this._items,function(i){if(i.isDirty()){i.revert();}if(i.hasFlag("new")&&!i.hasFlag("deleted")){i.unsetFlag("new");this._deleteItem(i,false);}else{if(i.hasFlag("deleted")){i.unsetFlag("deleted");this.onNew(i,null);}}},this);},onSet:function(item,_102d,_102e,_102f){},onNew:function(_1030,_1031){},onDelete:function(_1032){},isValid:function(item){return item.isValid();},itemCount:function(){return this._items.length;},cloneItem:function(item){return new this.itemConstructor({initialData:item._data});},installDebugLogging:function(){dojo.connect(this,"onSet",function(item,_1036,_1037,_1038){console_log("Item ",item," attribute ",_1036," changed from ",_1037," to ",_1038);});dojo.connect(this,"onNew",function(_1039,_103a){console_log("Item ",_1039," added with parent ",_103a);});dojo.connect(this,"onDelete",function(_103b){console_log("Item ",_103b," deleted");});}});dojo.extend(nox.ext.apps.commonui.coreui._UpdatingStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.DirectoryStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.DirectoryStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.DirectoryStore");dojo.declare("nox.ext.apps.commonui.directory.DirectoryStore",[nox.ext.apps.commonui.coreui._UpdatingStore],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){this.itemConstructor=this.dmws.Directory;if(this.url==null){this.url="/ws.v1/directory/instance";}},_unpackData:function(_103d){var i=0;return dojo.map(_103d.items,function(d){d.search_order=i++;return d;});}});dojo.extend(nox.ext.apps.commonui.directory.DirectoryStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.Directories"]){dojo._hasResource["nox.ext.apps.commonui.directory.Directories"]=true;dojo.provide("nox.ext.apps.commonui.directory.Directories");(function(){var dmws=nox.ext.apps.commonui.directory;var d=dmws.Directories;principal_types=["user","host","switch","location"];d.primary={user:null,host:null,"switch":null,location:null};d.read_default={user:null,host:null,"switch":null,location:null};d.num_read={user:0,host:0,"switch":0,location:0};d.write_default={user:null,host:null,"switch":null,location:null};d.num_write={user:0,host:0,"switch":0,location:0};function _1042(){dojo.forEach(principal_types,function(ptype){d.primary[ptype]=null;d.read_default[ptype]=null;d.write_default[ptype]=null;var a={query:{},sort:[{attribute:"search_order"}],onComplete:function(items){d.num_read[ptype]=items.length;if(items.length<=0){return;}var name=d.datastore.getValue(items[0],"name");d.read_default[ptype]=name;if(items.length==1){d.primary[ptype]=name;}},onError:function(error){console_log("Error occured in nox.ext.apps.commonui.directory.Directories._determine_primaries_and_defaults() while attempting read fetch.");}};a.query["read_"+ptype+"_enabled"]=true;d.datastore.fetch(a);a={query:{},sort:[{attribute:"search_order"}],onComplete:function(items){d.num_write[ptype]=items.length;if(items.length<=0){return;}var name=d.datastore.getValue(items[0],"name");d.write_default[ptype]=name;},onError:function(error){console_log("Error occured in nox.ext.apps.commonui.directory.Directories._determine_primaries_and_defaults() while attempting write fetch.");}};a.query["write_"+ptype+"_enabled"]=true;d.datastore.fetch(a);dojo.publish("update_completions",["nox.ext.apps.commonui.directory.Directories"]);});};d.page_init=function(){d.datastore=new dmws.DirectoryStore({url:"/ws.v1/directory/instance"});d.datastore.update({onComplete:function(){_1042();dojo.connect(d.datastore,"onNew",_1042);dojo.connect(d.datastore,"onDelete",_1042);}});};})();dojo.addOnLoad(nox.ext.apps.commonui.directory.Directories.page_init);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.PrincipalModifyDialog"]){dojo._hasResource["nox.ext.apps.commonui.directory.PrincipalModifyDialog"]=true;dojo.provide("nox.ext.apps.commonui.directory.PrincipalModifyDialog");var coreui=nox.ext.apps.commonui.coreui;dojo.declare("nox.ext.apps.commonui.directory.PrincipalModifyDialog",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"content\" > \n  <div dojoType=\"dijit.Dialog\" dojoAttachPoint=\"main_dialog\" \n      title=\"${title}\" > \n      <table>\n        <tr dojoAttachPoint=\"dir_row\"> <td> Directory: \n            <!-- We need to dynamically generate the store for this textbox\n            --> \n            <span dojoType=\"dijit.layout.ContentPane\" \n              dojoAttachPoint=\"dir_textbox_div\"> </span> \n       </td></tr> \n        <tr> <td> Name:\n        <input dojoType=\"dijit.form.TextBox\" type=\"text\" trim=\"true\" dojoAttachPoint=\"name\"/>\n        </td> </tr> \n        <tr><td> \n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"addBtn\">Add</button>\n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelBtn\">Cancel</button>\n        </td></tr>\n        </table> \n      </div>\n</div> \n",widgetsInTemplate:true,principal:null,ctor:null,principal_type:null,title:null,type:null,group_ctor:null,onChange:function(){},_set_widget_values:function(){if(!this.principal){return;}var dir=this.principal.directoryName();if(dir!="discovered"){this.directory.setDisplayedValue(dir);}},_cancel:function(){this.main_dialog.hide();},_done:function(){var g=new this.ctor({});if(!g.check_name(this.name.getValue())){coreui.UpdateErrorHandler.showError("'"+this.name.getValue()+"' is an invalid name",{header_msg:"Operation Failed:",hide_retry:true,validation_error:true});return;}if(!g.check_name(this.directory.getValue())){coreui.UpdateErrorHandler.showError("'"+this.directory.getValue()+"' is an invalid directory "+"name",{header_msg:"Operation Failed:",hide_retry:true,validation_error:true});return;}if(!this.directory.validate()){this.directory._hasBeenBlurred=true;this.directory.focus();return;}this.main_dialog.hide();this.principal_name=this.name.getValue();this.principal_directory=this.directory.getValue();if(this.type=="add_principal"){var ptype=this.principal_type;var name=this.directory.getValue()+";"+this.name.getValue();this.principal=new this.ctor({initialData:{name:name}});this.principal.create(function(e){var p=ptype.substring(0,1).toUpperCase()+ptype.substring(1);top.location.pathname="/Monitors/"+p+"s/"+p+"Info?name="+encodeURIComponent(name);});}else{if(this.type=="add_to_group"||this.type=="add_to_role"){var _1051=this.directory.getValue()+";"+this.name.getValue();var _1052=this.principal.getValue("name");var group=new this.group_ctor({initialData:{name:_1051},updateList:[]});var args={name:this.principal.principalName(),directory:this.principal.directoryName(),ctor:this.ctor,principal_type:this.principal_type};group.modify_direct_member("PUT",args);}else{console_log("unknown principal modify type: "+this.type);}}this.onChange(this.principal);},_name_keypress:function(event){switch(event.keyCode){case dojo.keys.ENTER:this._done();break;}},show:function(){this.main_dialog.show();this.name.focus();},postCreate:function(){this.main_dialog.closeButtonNode.style.display="none";dojo.connect(this.name.domNode,"onkeypress",this,"_name_keypress");dojo.connect(this.addBtn,"onClick",this,"_done");dojo.connect(this.cancelBtn,"onClick",this,"_cancel");query={};query["write_"+this.principal_type+"_enabled"]=true;this.directory=new dijit.form.FilteringSelect({store:dmws.Directories.datastore,searchAttr:"name",query:query});this.dir_textbox_div.domNode.appendChild(this.directory.domNode);if(this.type=="add_to_role"){this.directory.setValue("Built-in");dojo.style(this.dir_row,{display:"none"});}var d=this.directory;dmws.Directories.datastore.fetch({onComplete:function(items){if(items.length==2){dojo.forEach(items,function(item){if(item.displayName()!="discovered"){d.setDisplayedValue(item.displayName());}});}}});this._set_widget_values();}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory._Principal"]){dojo._hasResource["nox.ext.apps.commonui.directory._Principal"]=true;dojo.provide("nox.ext.apps.commonui.directory._Principal");dojo.declare("nox.ext.apps.commonui.directory._Principal",[nox.ext.apps.commonui.coreui._NamedEntity],{coreui:nox.ext.apps.commonui.coreui,dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){dojo.mixin(this.derivedAttributes,{fullName:{get:dojo.hitch(this,"fullName"),set:dojo.hitch(this,"fullNameSet"),hasChanged:dojo.hitch(this,"nameHasChanged")},directoryName:{get:dojo.hitch(this,"directoryName"),set:dojo.hitch(this,"directoryNameSet"),hasChanged:dojo.hitch(this,"nameHasChanged")},principalName:{get:dojo.hitch(this,"principalName"),set:dojo.hitch(this,"principalNameSet"),hasChanged:dojo.hitch(this,"nameHasChanged")},wsv1Path:{get:dojo.hitch(this,"wsv1Path"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorPath:{get:dojo.hitch(this,"uiMonitorPath"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorLink:{get:dojo.hitch(this,"uiMonitorLink"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorLinkText:{get:dojo.hitch(this,"uiMonitorLinkText"),hasChanged:dojo.hitch(this,"nameHasChanged")},statusNode:{get:dojo.hitch(this,"statusNode"),hasChanged:dojo.hitch(this,"statusHasChanged")},statusMarkup:{get:dojo.hitch(this,"statusMarkup"),hasChanged:dojo.hitch(this,"statusHasChanged")}});dojo.mixin(this.updateTypes,{"status":{load:dojo.hitch(this,"updateStatus")}});},isNull:function(){return (this._data.name==null);},fullName:function(){return this._data.name;},fullNameSet:function(v){this.setValue("name",v);},directoryName:function(){try{return this._data.name.split(";",2)[0];}catch(e){return null;}},directoryNameSet:function(v){var pname=this.principalName();this.setValue("name",v+";"+pname);},principalName:function(){try{return this._data.name.split(";",2)[1];}catch(e){return null;}},principalNameSet:function(v){var dname=this.directoryName();this.setValue("name",dname+";"+v);},displayName:function(){return this.getValue("name");},statusHasChanged:function(l){return dojo.some(l,"return item.attribute == 'status';");},statusNode:function(){var s=document.createElement("span");var txt="unknown";s.className="errormsg";var stat=this.getValue("status");if(stat){txt=this.getValue("status");if(txt=="active"){s.className="successmsg";}}s.appendChild(document.createTextNode(txt));return s;},statusMarkup:function(){var cl="errormsg";var txt="unknown";var stat=this.getValue("status");if(stat){txt=stat;if(stat=="active"){cl="successmsg";}}return "<span class='"+cl+"'>"+txt+"</span>";},wsv1Path:function(){throw Error("Method must be overridden by subclass");},uiMonitorPath:function(){throw Error("Method must be overridden by subclass");},uiMonitorLink:function(_1066){var name=((_1066==true)?this.getValue("name"):this.principalName());var p=this.uiMonitorPath();if(p==null){return document.createTextNode(name);}else{return nox.ext.apps.commonui.coreui.base.createLink(p,name);}},uiMonitorLinkText:function(_1069){var name=((_1069==true)?this.getValue("name"):this.principalName());return "<a href='"+this.uiMonitorPath()+"'>"+name+"</a>";},updateStatus:function(kwarg){return this._xhrGetMixin("status",this.wsv1Path()+"/active",function(r){return {"status":r?"active":"inactive"};});},deleteOnServer:function(kwarg){this._do_modify_request(this.wsv1Path(),"DELETE",kwarg.onComplete);},create:function(_106e){onExisting=dojo.hitch(this,function(){coreui.UpdateErrorHandler.showError("Principal '"+this.principalName()+"' already exists"+" in directory "+this.directoryName(),{header_msg:"Create Failed:",hide_retry:true,validation_error:true});});onNonexisting=dojo.hitch(this,function(){this._do_modify_request(this.wsv1Path(),"PUT",_106e);});this.check_exist(onExisting,onNonexisting);},check_exist:function(_106f,_1070){cb=function(_1071){if(_1071){_106f.call(dojo.global);}else{_1070.call(dojo.global);}};this.exists(dojo.hitch(this,cb));},exists:function(_1072){nox.ext.apps.commonui.coreui.getUpdateMgr().xhrGet({url:this.wsv1Path(),headers:{"content-type":"application/json"},load:function(_1073,_1074){_1072.call(dojo.global,true);},error:function(_1075,_1076){_1072.call(dojo.global,false);},timeout:30000});},change_directory:function(arg){arg.directory=arg.name;arg.name=this.principalName();this.full_rename(arg);},rename:function(arg){arg.directory=this.directoryName();this.full_rename(arg);},full_rename:function(arg){if(this.check_name(arg.name)==false){coreui.UpdateErrorHandler.showError("'"+arg.name+"' is an invalid name",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});return;}if(this.check_name(arg.directory)==false){coreui.UpdateErrorHandler.showError("'"+arg.directory+"' is an invalid directory name",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});return;}var _107a=arg.directory+";"+arg.name;if(_107a==this._data.name){if(arg.onComplete!=null){arg.onComplete.call(dojo.global,this);}return;}var _107b=new this.constructor();_107b.setValue("name",_107a);onExisting=dojo.hitch(coreui.UpdateErrorHandler,"showError","Principal '"+arg.name+"' already exists.",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});onNonexisting=function(){nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut({url:this.wsv1Path(),headers:{"content-type":"application/json"},putData:dojo.toJson({name:_107a}),load:dojo.hitch(_107b,function(_107c,_107d){if(arg.onComplete!=null){arg.onComplete.call(dojo.global,_107b);}}),timeout:30000,errorHandlers:{400:function(_107e,_107f,item,_1081){coreui.UpdateErrorHandler.showError(_107e.responseText,{auto_show:true,header_msg:"Rename Failed:"});}}});};_107b.check_exist(onExisting,dojo.hitch(this,onNonexisting));},_do_modify_request:function(path,_1083,_1084){var _1085=nox.ext.apps.commonui.coreui;_1085.getUpdateMgr().xhr(_1083,{url:path,headers:{"content-type":"application/json"},putData:dojo.toJson({}),load:function(_1086,_1087){if(_1084!=null){_1084.call(dojo.global);}},error:function(_1088,_1089){_1085.UpdateErrorHandler.showError("Failed to modify/remove "+ptype+" "+this.principalName()+" from directory "+this.directoryName(),{header_msg:"Modify Failed:"});},timeout:30000});},delete_binding:function(_108a){var _108b=this.getValue("principalName");var _108c=this.getValue("directoryName");coreui.getUpdateMgr().xhr("DELETE",{url:this.wsv1Path()+"/binding",headers:{"content-type":"application/json"},load:function(_108d){if(_108a!=null){_108a(_108d);}},putData:dojo.toJson({}),timeout:30000,handleAs:"json",recur:false,error:nox.ext.apps.commonui.coreui.UpdateErrorHandler.create()});}});dojo.declare("nox.ext.apps.commonui.directory.PrincipalUtil",[],{dmws:nox.ext.apps.commonui.directory,show_modify_dialog:function(ptype,_108f,title,ctor){var appr=dijit.byId("modify_principal_id");if(appr){appr.destroy();}var props={principal:_108f,title:title,ctor:ctor,principal_type:ptype,type:"add_principal"};appr=new dmws.PrincipalModifyDialog(props);dojo.body().appendChild(appr.domNode);appr.startup();appr.show();return appr;},setup_listpage_edit_hooks:function(ptype,_1095,ctor,grid){var _1098=dijit.byId("add_principal_button");if(_1098!=null){dojo.connect(_1098,"onClick",function(){var title="Add "+ptype.substring(0,1).toUpperCase()+ptype.substring(1)+" Principal";var _109a=dmws.getPrincipalUtil().show_modify_dialog(ptype,null,title,ctor);dojo.connect(_109a,"onChange",_1095,"update");});}var _109b=dijit.byId("remove_principal_button");if(_109b!=null){dojo.connect(_109b,"onClick",function(){var _109c=grid.selection.getSelected();for(var i in _109c){var item=_109c[i];var _109f=item.getValue("directoryName");var q={name:_109f};q["write_"+ptype+"_enabled"]=true;var _10a1=false;dmws.Directories.datastore.fetch({query:q,onItem:function(_10a2){if(_10a1){return;}_10a1=true;_1095.deleteItem(item);_1095.save();},onComplete:function(){if(!_10a1){coreui.UpdateErrorHandler.showError("Cannot remove a "+ptype+" from read-only directory '"+_109f+"'",{header_msg:"Removal Failed:",hide_retry:true,validation_error:true});}}});}});_109b.setAttribute("disabled",true);dojo.connect(grid.selection,"onChanged",function(){var _10a3=grid.selection.getSelectedCount();_109b.setAttribute("disabled",!(_10a3>0));});}},setup_listpage_deauth_hooks:function(ptype,grid){var _10a6=dijit.byId("deauth_principal_button");if(_10a6!=null){dojo.connect(_10a6,"onClick",function(){var _10a7=grid.selection.getSelected();for(var i in _10a7){var item=_10a7[i];item.delete_binding(function(){coreui.getUpdateMgr().updateNow();});}});_10a6.setAttribute("disabled",true);dojo.connect(grid.selection,"onChanged",function(){var _10aa=grid.selection.getSelectedCount();_10a6.setAttribute("disabled",!(_10aa>0));});}},get_listpage_store_error_handler:function(_10ab){return function(error,_10ad,item,_10af){var ueh=nox.ext.apps.commonui.coreui.UpdateErrorHandler;if(item==undefined||item==null){var _10b1=ueh.get_error_type(error);if(_10b1==404&&_10af!=null){}else{if(_10b1!=500&&_10b1!=400&&_10b1!=404&&ueh.defaultHandlers[_10b1]!=null){ueh.defaultHandlers[_10b1].apply(dojo.global,[error,_10ad]);}else{ueh.showError("Unable to retrieve list of "+_10ab,{header_msg:"Server Error:"});}}return true;}};},get_principal_not_found_fn:function(type,_10b3){var first=type.substring(0,1).toUpperCase();var _10b5=first+type.substring(1);return function(error,_10b7){coreui.UpdateErrorHandler.showError("No "+type+" named "+_10b3+" exists.",{hide_dismiss:true,header_msg:_10b5+" Not Found:"});};}});(function(){var dmws=nox.ext.apps.commonui.directory;var _10b9=null;dmws.getPrincipalUtil=function(){if(_10b9==null){_10b9=new dmws.PrincipalUtil();}return _10b9;};})();}if(!dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalStore"]){dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalStore"]=true;dojo.provide("nox.ext.apps.commonui.directory._PrincipalStore");dojo.declare("nox.ext.apps.commonui.directory._PrincipalStore",[nox.ext.apps.commonui.coreui._UpdatingStore],{dmws:nox.ext.apps.commonui.directory,_unpackData:function(r){return dojo.map(r,"return { name: item };");}});dojo.extend(nox.ext.apps.commonui.directory._PrincipalStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.User"]){dojo._hasResource["nox.ext.apps.commonui.directory.User"]=true;dojo.provide("nox.ext.apps.commonui.directory.User");var AUTH_SIMPLE="simple_auth";dojo.declare("nox.ext.apps.commonui.directory.User",[nox.ext.apps.commonui.directory._Principal],{constructor:function(kwarg){dojo.mixin(this.updateTypes,{"info":{load:dojo.hitch(this,"updateInfo")},"cred":{load:dojo.hitch(this,"updateCred")}});dojo.mixin(this.derivedAttributes,{"passwd_set":{get:dojo.hitch(this,"passwd_set")}});},wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/user/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.principalName());},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Users/UserInfo?name="+encodeURIComponent(this._data.name);},passwd_set:function(){if(this._data.cred!=null&&this._data.cred[AUTH_SIMPLE]!=null){return "Yes";}return "No";},updateInfo:function(kwarg){return this._xhrGetMixin("info",this.wsv1Path());},updateCred:function(kwarg){return this._xhrGetMixin("cred",this.wsv1Path()+"/cred",function(_10be){return {"cred":_10be};});},hostStore:function(kwarg){return new this.dmws.HostStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/active/host","userObj":this}));},groupStore:function(kwarg){return new this.dmws.UserGroupStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/group","userObj":this}));},save:function(kwarg){var uinfo={name:this._data.name};if(this._data.user_id!=null){uinfo["user_id"]=this._data.user_id;}if(this._data.user_real_name!=null){uinfo["user_real_name"]=this._data.user_real_name;}if(this._data.description!=null){uinfo["description"]=this._data.description;}if(this._data.phone!=null){uinfo["phone"]=this._data.phone;}if(this._data.user_email!=null){uinfo["user_email"]=this._data.user_email;}if(this._data.location!=null){uinfo["location"]=this._data.location;}var _10c3;if(kwarg!=null&&kwarg["errorHandlers"]!=null){_10c3=kwarg["errorHandlers"];}else{_10c3={400:function(_10c4,_10c5,item,_10c7){nox.ext.apps.commonui.coreui.UpdateErrorHandler.showError(_10c4.responseText,{header_msg:"Save failed"});}};}nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut({url:this.wsv1Path(),headers:{"content-type":"application/json"},putData:dojo.toJson(uinfo),timeout:30000,errorHandlers:_10c3});},saveCred:function(pwd,kwarg){var _10ca;if(kwarg!=null&&kwarg["errorHandlers"]!=null){_10ca=kwarg["errorHandlers"];}else{_10ca={400:function(_10cb,_10cc,item,_10ce){nox.ext.apps.commonui.coreui.UpdateErrorHandler.showError(_10cb.responseText,{auto_show:true,header_msg:"Save credentials failed."});}};}var cred={};if(pwd!=null){cred[AUTH_SIMPLE]=[{password:pwd}];}nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut({url:this.wsv1Path()+"/cred",headers:{"content-type":"application/json"},putData:dojo.toJson(cred),timeout:30000,errorHandlers:_10ca});this._updateBasicData({"cred":cred});}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.GroupModifyDialog"]){dojo._hasResource["nox.ext.apps.commonui.directory.GroupModifyDialog"]=true;dojo.provide("nox.ext.apps.commonui.directory.GroupModifyDialog");var coreui=nox.ext.apps.commonui.coreui;var dmws=nox.ext.apps.commonui.directory;dojo.declare("nox.ext.apps.commonui.directory.GroupModifyDialog",[dijit._Widget,dijit._Templated],{templateString:"<div dojoType=\"dijit.layout.ContentPane\" dojoAttachPoint=\"content\" > \n  <div dojoType=\"dijit.Dialog\" dojoAttachPoint=\"main_dialog\" title=\"${title}\"> \n        <table> \n          <tr> <td> Directory:\n           <span dojoType=\"dijit.layout.ContentPane\" dojoAttachPoint=\"dir_div\"> \n           </span> \n        </td></tr> \n        <tr> <td> Name:\n        <input dojoType=\"dijit.form.TextBox\" type=\"text\" trim=\"true\" dojoAttachPoint=\"name\"/>\n        </td> </tr> \n        <tr><td> \n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"addBtn\">Add</button>\n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelBtn\">Cancel</button>\n        </td></tr>\n        </table> \n      </div>\n</div> \n",widgetsInTemplate:true,group:null,type:null,title:null,ctor:null,principal_type:null,onChange:function(){},_set_widget_values:function(){if(!this.group){return;}var dir=this.group.directoryName();if(dir!="discovered"){this.directory.setDisplayedValue(dir);}},_cancel:function(){this.main_dialog.hide();},_done:function(){var g=new this.ctor({});if(!g.check_name(this.name.getValue())){coreui.UpdateErrorHandler.showError("'"+this.name.getValue()+"' is an invalid name",{header_msg:"Operation Failed:",hide_retry:true,validation_error:true});return;}if(!g.check_name(this.directory.getValue())){coreui.UpdateErrorHandler.showError("'"+this.directory.getValue()+"' is an invalid directory "+"name",{header_msg:"Operation Failed:",hide_retry:true,validation_error:true});return;}if(!this.directory.validate()){this.directory._hasBeenBlurred=true;this.directory.focus();return;}this.main_dialog.hide();this.group_name=this.name.getValue();this.group_directory=this.directory.getValue();args={name:this.group_name,directory:this.group_directory,ctor:this.ctor,principal_type:this.principal_type};if(this.type=="parent"){this.group.modify_parent("PUT",args);}else{if(this.type=="subgroup"){this.group.modify_subgroup("PUT",args);}else{if(this.type=="member"){this.group.modify_direct_member("PUT",args);}else{if(this.type=="group"){var name=this.group_directory+";"+this.group_name;this.group=new this.ctor({initialData:{name:name}});this.group.create(function(e){window.location.pathname=window.location.pathname.replace(/Groups$/,"GroupInfo?name="+encodeURIComponent(name));});}else{throw "unknown group modify type '"+type+"'";}}}}this.onChange(this.group);},show:function(){this.main_dialog.show();this.name.focus();},_name_keypress:function(event){switch(event.keyCode){case dojo.keys.ENTER:this._done();break;}},postCreate:function(){this.inherited(arguments);this.main_dialog.closeButtonNode.style.display="none";if(this.type=="parent"||this.type=="group"){var _10d5="write_"+this.principal_type+"_enabled";}else{if(this.type=="subgroup"){var _10d5="read_"+this.principal_type+"_enabled";}else{var _10d5="read_"+this.principal_type+"_enabled";}}var query={};query[_10d5]=true;this.directory=new dijit.form.FilteringSelect({store:dmws.Directories.datastore,searchAttr:"name",query:query});this.dir_div.domNode.appendChild(this.directory.domNode);this._set_widget_values();var d=this.directory;dmws.Directories.datastore.fetch({onComplete:function(items){if(items.length==2){dojo.forEach(items,function(item){if(item.displayName()!="discovered"){d.setDisplayedValue(item.displayName());}});}}});dojo.connect(this.name.domNode,"onkeypress",this,"_name_keypress");dojo.connect(this.addBtn,"onClick",this,"_done");dojo.connect(this.cancelBtn,"onClick",this,"_cancel");}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalGroup"]){dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalGroup"]=true;dojo.provide("nox.ext.apps.commonui.directory._PrincipalGroup");dojo.declare("nox.ext.apps.commonui.directory._PrincipalGroup",[nox.ext.apps.commonui.coreui._NamedEntity],{coreui:nox.ext.apps.commonui.coreui,dmws:nox.ext.apps.commonui.directory,count_subgroups:null,count_members:null,constructor:function(name,_10db){dojo.mixin(this.derivedAttributes,{directoryName:{get:dojo.hitch(this,"directoryName"),hasChanged:dojo.hitch(this,"nameHasChanged")},groupName:{get:dojo.hitch(this,"groupName"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorLink:{get:dojo.hitch(this,"uiMonitorLink")},uiMonitorPath:{get:dojo.hitch(this,"uiMonitorPath")},uiMonitorLinkText:{get:dojo.hitch(this,"uiMonitorLinkText")},uiRoleLink:{get:dojo.hitch(this,"uiRoleLink")},uiRolePath:{get:dojo.hitch(this,"uiRolePath")},uiRoleLinkText:{get:dojo.hitch(this,"uiRoleLinkText")}});dojo.mixin(this.updateTypes,{"info":{load:this.updateInfo}});},isNull:function(){return this._data.name==null;},nameHasChanged:function(l){return dojo.some(l,"return item.attribute == 'name';");},directoryName:function(){try{return this._data.name.split(";",2)[0];}catch(e){return null;}},groupName:function(){try{return this._data.name.split(";",2)[1];}catch(e){return null;}},wsv1Path:function(){throw Error("Method must be overridden by subclass");},uiMonitorPath:function(){throw Error("Method must be overridden by subclass");},uiMonitorLink:function(_10dd){var name=(_10dd==true||this.force_use_mangled)?this._data.name:this.groupName();return nox.ext.apps.commonui.coreui.base.createLink(this.uiMonitorPath(),name);},uiMonitorLinkText:function(_10df){var name=(_10df==true||this.force_use_mangled)?this._data.name:this.groupName();return "<a href='"+this.uiMonitorPath()+"'>"+name+"</a>";},uiRolePath:function(){return "/Monitors/Roles/RoleInfo?name="+encodeURIComponent(this.getValue("groupName"));},uiRoleLink:function(){var p=this.uiRolePath();var name=this.getValue("groupName");return nox.ext.apps.commonui.coreui.base.createLink(p,name);},uiRoleLinkText:function(){return "<a href='"+this.uiRolePath()+"'>"+this.getValue("groupName")+"</a>";},change_directory:function(arg){arg.directory=arg.name;arg.name=this.groupName();this.full_rename(arg);},rename:function(arg){arg.directory=this.directoryName();this.full_rename(arg);},full_rename:function(arg){if(this.check_name(arg.name)==false){coreui.UpdateErrorHandler.showError("'"+arg.name+"' is an invalid name",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});return;}if(this.check_name(arg.directory)==false){coreui.UpdateErrorHandler.showError("'"+arg.directory+"' is an invalid directory name",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});return;}var _10e6=arg.directory+";"+arg.name;if(_10e6==this._data.name){return;}var _10e7=new this.constructor();_10e7.setValue("name",_10e6);onExisting=dojo.hitch(coreui.UpdateErrorHandler,"showError","Group '"+arg.name+"' already exists.",{header_msg:"Rename Failed:",hide_retry:true,validation_error:true});onNonexisting=function(){nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut({url:this.wsv1Path(),headers:{"content-type":"application/json"},putData:dojo.toJson({name:_10e6}),load:dojo.hitch(_10e7,function(_10e8,_10e9){if(arg.onComplete!=null){arg.onComplete.call(dojo.global,_10e7);}}),timeout:30000,errorHandlers:{400:function(_10ea,_10eb,item,_10ed){coreui.UpdateErrorHandler.showError(_10ea.responseText,{auto_show:true,header_msg:"Rename Failed:"});}}});};_10e7.check_exist(onExisting,dojo.hitch(this,onNonexisting));},parentGroupStore:function(){throw Error("Method must be overridden by subclass");},principalMemberStore:function(){throw Error("Method must be overridden by subclass");},subgroupMemberStore:function(){throw Error("Method must be overridden by subclass");},updateInfo:function(kwarg){return this._xhrGetMixin("info",this.wsv1Path());},direct_member_path:function(_10ef,_10f0){return this.wsv1Path()+"/principal/"+encodeURIComponent(_10ef)+"/"+encodeURIComponent(_10f0);},subgroup_path:function(_10f1,_10f2){return this.wsv1Path()+"/subgroup/"+encodeURIComponent(_10f1)+"/"+encodeURIComponent(_10f2);},exists:function(_10f3){nox.ext.apps.commonui.coreui.getUpdateMgr().xhrGet({url:this.wsv1Path(),headers:{"content-type":"application/json"},load:function(_10f4,_10f5){_10f3.call(dojo.global,true);},error:function(_10f6,_10f7){_10f3.call(dojo.global,false);},timeout:30000});},deleteOnServer:function(_10f8){this._do_modify_request(this.wsv1Path(),"DELETE",_10f8);},create:function(_10f9){this._do_modify_request(this.wsv1Path(),"PUT",_10f9);},check_exist:function(_10fa,_10fb){cb=function(_10fc){if(_10fc){_10fa.call(dojo.global);}else{_10fb.call(dojo.global);}};this.exists(dojo.hitch(this,cb));},_patch_callback:function(args){return function(){nox.ext.apps.commonui.coreui.getUpdateMgr().updateNow();if(args.onComplete!=null){args.onComplete(arguments);}};},delete_parent:function(ctor,_10ff){var a=_10ff.split(";",2);var args={directory:a[0],name:a[1],ctor:ctor};this.modify_parent("DELETE",args);},modify_parent:function(_1102,args){var _1104=args.directory+";"+args.name;var _1105=new args.ctor({initialData:{name:_1104}});if(_1105.isNull()){throw "invalid parent group name";}var path=_1105.subgroup_path(this.directoryName(),this.groupName());var _1107=this._patch_callback(args);var cb=dojo.hitch(_1105,"_do_modify_request",path,_1102,_1107);var _1109=dojo.hitch(coreui.UpdateErrorHandler,"showError","Group '"+args.name+"' does not exist.",{header_msg:"Modify Failed:",hide_retry:true,validation_error:true});_1105.check_exist(cb,_1109);},delete_subgroup:function(ctor,_110b){var a=_110b.split(";",2);var args={directory:a[0],name:a[1],ctor:ctor};this.modify_subgroup("DELETE",args);},modify_subgroup:function(_110e,args){var _1110=args.directory+";"+args.name;var _1111=new args.ctor({initialData:{name:_1110}});if(_1111.isNull()){throw "invalid subgroup name";}var path=this.subgroup_path(args.directory,args.name);var _1113=this._patch_callback(args);var cb=dojo.hitch(this,"_do_modify_request",path,_110e,_1113);var _1115=dojo.hitch(coreui.UpdateErrorHandler,"showError","Group '"+args.name+"' does not exist.",{header_msg:"Modify Failed:",hide_retry:true,validation_error:true});_1111.check_exist(cb,_1115);},delete_direct_member:function(_1116){var a=_1116.split(";",2);var args={directory:a[0],name:a[1]};this.modify_direct_member("DELETE",args);},modify_direct_member:function(_1119,args){var path=this.direct_member_path(args.directory,args.name);var _111c=this._patch_callback(args);if(args.principal_type!=null&&args.principal_type!="hostnetname"){var ctor;if(args.principal_type=="switch"){ctor=this.dmws.Switch;}else{if(args.principal_type=="location"){ctor=this.dmws.Location;}else{if(args.principal_type=="user"){ctor=this.dmws.User;}else{if(args.principal_type=="host"){ctor=this.dmws.Host;}else{throw "unknown principal type";}}}}var _111e=args.directory+";"+args.name;var _111f=new ctor({initialData:{name:_111e}});if(_111f.isNull()){throw "invalid member name";}var cb=dojo.hitch(this,"_do_modify_request",path,_1119,_111c);var _1121=function(){var ptype=args.principal_type.substring(0,1).toUpperCase()+args.principal_type.substring(1);coreui.UpdateErrorHandler.showError(ptype+" '"+args.name+"' in directory '"+args.directory+"' does not exist.",{header_msg:"Modify Failed:",hide_retry:true,validation_error:true});};_111f.check_exist(cb,_1121);}else{this._do_modify_request(path,_1119,_111c);}},_do_modify_request:function(path,_1124,_1125){nox.ext.apps.commonui.coreui.getUpdateMgr().xhr(_1124,{url:path,headers:{"content-type":"application/json"},putData:dojo.toJson({}),load:function(_1126,_1127){if(_1125!=null){_1125.call(dojo.global);}},timeout:30000});},track_counts:function(){this.count_subgroups=this.subgroupMemberStore({autoUpdate:{onComplete:dojo.hitch(this,function(){this.setValue("subgroup_cnt",this.count_subgroups.itemCount());})}});this.count_members=this.principalMemberStore({autoUpdate:{onComplete:dojo.hitch(this,function(){this.setValue("member_cnt",this.count_members.itemCount());})}});},saveGroup:function(kwarg){var ginfo={name:this._data.name};if(this._data.description!=null){ginfo["description"]=this._data.description;}var _112a;if(kwarg!=null&&kwarg["errorHandlers"]!=null){_112a=kwarg["errorHandlers"];}else{_112a={400:function(_112b,_112c,item,_112e){nox.ext.apps.commonui.coreui.UpdateErrorHandler.showError(_112b.responseText,{auto_show:true,header_msg:"Save failed"});}};}nox.ext.apps.commonui.coreui.getUpdateMgr().rawXhrPut({url:this.wsv1Path(),headers:{"content-type":"application/json"},putData:dojo.toJson(ginfo),timeout:30000,errorHandlers:_112a});}});dojo.declare("nox.ext.apps.commonui.directory.PrincipalGroupUtil",[],{dmws:nox.ext.apps.commonui.directory,show_modify_dialog:function(ptype,group,type,title,ctor){var appr=dijit.byId("modify_group_id");if(appr){appr.destroy();}var props={id:"modify_group_id",group:group,type:type,title:title,ctor:ctor,principal_type:ptype};appr=new nox.ext.apps.commonui.directory.GroupModifyDialog(props);dojo.body().appendChild(appr.domNode);appr.startup();appr.show();return appr;},setup_infopage_edit_hooks:function(ptype,group,ctor,grid,_113a){if(principal_group_editable){var _113b=dojo.byId("add_direct_member_link");if(_113b!=null){dojo.connect(_113b,"onclick",dojo.hitch(this,"show_modify_dialog",ptype,group,"member","Add "+ptype.substring(0,1).toUpperCase()+ptype.substring(1)+" Member",ctor));}var _113c=dijit.byId("delete_direct_member_link");if(_113c!=null){dojo.connect(_113c,"onClick",function(){var _113d=grid.selection.getSelected();dojo.forEach(_113d,function(item){group.delete_direct_member(item.fullName());_113a.deleteItem(item);});});}}else{dijit.byId("add_direct_member_link").attr("disabled",true);dijit.byId("delete_direct_member_link").attr("disabled",true);}},setup_listpage_edit_hooks:function(ptype,_1140,ctor,grid,_1143){dojo.connect(dijit.byId("add_group_button"),"onClick",function(){var _1144=dmws.getPrincipalGroupUtil().show_modify_dialog(ptype,null,"group","Add "+ptype.substring(0,1).toUpperCase()+ptype.substring(1)+" Group",ctor);dojo.connect(_1144,"onChange",_1140,"update");});dojo.connect(dijit.byId("remove_group_button"),"onClick",function(){var _1145=grid.selection.getSelected();for(var i in _1145){var item=_1145[i];if(_1143!=undefined&&!_1143(item.groupName())){coreui.UpdateErrorHandler.showError("Removing '"+item.groupName()+"' not allowed",{header_msg:"Remove Failed:",hide_retry:true,validation_error:true});return;}var _1148=item.getValue("directoryName");var q={name:_1148};q["write_"+ptype+"_enabled"]=true;var _114a=false;dmws.Directories.datastore.fetch({query:q,onItem:function(_114b){if(_114a){return;}_114a=true;item.deleteOnServer(function(){_1140.deleteItem(item);if(item.count_subgroups){item.count_subgroups.destroy();}if(item.count_members){item.count_members.destroy();}coreui.getUpdateMgr().updateNow();});},onComplete:function(){if(!_114a){coreui.UpdateErrorHandler.showError("Cannot remove a group from read-only directory '"+_1148+"'",{header_msg:"Directory Removal Failed:",hide_retry:true,validation_error:true});}}});}});},get_group_not_found_fn:function(type,_114d){return function(error,_114f){coreui.UpdateErrorHandler.showError("No "+type+" group named "+_114d+" exists.",{hide_dismiss:true,header_msg:"Group Not Found:"});};}});(function(){var dmws=nox.ext.apps.commonui.directory;var _1151=null;dmws.getPrincipalGroupUtil=function(){if(_1151==null){_1151=new dmws.PrincipalGroupUtil();}return _1151;};})();}if(!dojo._hasResource["nox.ext.apps.commonui.directory.UserStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.UserStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.UserStore");dojo.declare("nox.ext.apps.commonui.directory.UserStore",[nox.ext.apps.commonui.directory._PrincipalStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.User;if(this.url==null){this.url="/ws.v1/user";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalGroupStore"]){dojo._hasResource["nox.ext.apps.commonui.directory._PrincipalGroupStore"]=true;dojo.provide("nox.ext.apps.commonui.directory._PrincipalGroupStore");dojo.declare("nox.ext.apps.commonui.directory._PrincipalGroupStore",[nox.ext.apps.commonui.coreui._UpdatingStore],{dmws:nox.ext.apps.commonui.directory,_unpackData:function(r){return dojo.map(r,"return { name: item };");}});dojo.extend(nox.ext.apps.commonui.directory._PrincipalGroupStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.UserGroupStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.UserGroupStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.UserGroupStore");dojo.declare("nox.ext.apps.commonui.directory.UserGroupStore",[nox.ext.apps.commonui.directory._PrincipalGroupStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.UserGroup;if(this.url==null){this.url="/ws.v1/group/user";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.UserGroup"]){dojo._hasResource["nox.ext.apps.commonui.directory.UserGroup"]=true;dojo.provide("nox.ext.apps.commonui.directory.UserGroup");dojo.declare("nox.ext.apps.commonui.directory.UserGroup",[nox.ext.apps.commonui.directory._PrincipalGroup],{wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/group/user/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.groupName());},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Groups/UserGroupInfo?name="+encodeURIComponent(this._data.name);},parentGroupStore:function(kwarg){return new nox.ext.apps.commonui.directory.UserGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/parent"}));},principalMemberStore:function(kwarg){return new nox.ext.apps.commonui.directory.UserStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/principal"}));},subgroupMemberStore:function(kwarg){return new nox.ext.apps.commonui.directory.UserGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/subgroup"}));}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostStore");dojo.declare("nox.ext.apps.commonui.directory.HostStore",[nox.ext.apps.commonui.directory._PrincipalStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.Host;if(this.url==null){this.url="/ws.v1/host";}}});dojo.extend(nox.ext.apps.commonui.directory.HostStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostGroup"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostGroup"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostGroup");dojo.declare("nox.ext.apps.commonui.directory.HostGroup",[nox.ext.apps.commonui.directory._PrincipalGroup],{wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/group/host/"+encodeURIComponent(this.getValue("directoryName"))+"/"+encodeURIComponent(this.getValue("groupName"));},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Groups/HostGroupInfo?name="+encodeURIComponent(this._data.name);},parentGroupStore:function(kwarg){return new this.dmws.HostGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/parent"}));},principalMemberStore:function(kwarg){return new this.dmws.HostStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/principal"}));},subgroupMemberStore:function(kwarg){return new this.dmws.HostGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/subgroup"}));}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostGroupStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostGroupStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostGroupStore");dojo.declare("nox.ext.apps.commonui.directory.HostGroupStore",[nox.ext.apps.commonui.directory._PrincipalGroupStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.HostGroup;if(this.url==null){this.url="/ws.v1/group/host";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostBinding"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostBinding"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostBinding");dojo.declare("nox.ext.apps.commonui.directory.HostBinding",[nox.ext.apps.commonui.coreui._UpdatingItem],{identityAttributes:["name","dladdr","nwaddr","dpid","port"],labelAttributes:["name","dladdr","nwaddr","dpid","port"],constructor:function(data){dojo.mixin(this.derivedAttributes,{intfType:{get:dojo.hitch(this,"intfType"),set:dojo.hitch(this,"setIntfType")}});},intfType:function(){if(this._data.is_gateway&&this._data.is_gateway!="False"){return "Gateway";}else{if(this._data.is_router&&this._data.is_router!="False"){return "Router";}else{return "End-Host";}}},setIntfType:function(v){if(v=="Gateway"){this.setValue("is_gateway","True");this.setValue("is_router","False");}else{if(v=="Router"){this.setValue("is_gateway","False");this.setValue("is_router","True");}else{this.setValue("is_gateway","False");this.setValue("is_router","False");}}},isValid:function(){var _115f=false;dojo.forEach(["dladdr","nwaddr","location"],function(t){if(this._data[t]!=null&&this._data[t]!=""){if(_115f==false){_115f=true;}else{return false;}}},this);if(!_115f){return false;}if((!(this._data.is_gateway=="True"||this._data.is_gateway=="False"))||(!(this._data.is_router=="True"||this._data.is_router=="False"))){return false;}return true;}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostBindingStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostBindingStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostBindingStore");dojo.declare("nox.ext.apps.commonui.directory.HostBindingStore",[nox.ext.apps.commonui.coreui._UpdatingStore],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){this.itemConstructor=this.dmws.HostBinding;if(this.hostObj==undefined){throw new Error("HostBindingStore must be initialized with the associated host object");}this.itemParameters["hostObj"]=this.hostObj;if(this.url==null){this.url=this.hostObj.wsv1Path();}},_unpackData:function(_1162){return _1162.netinfos;},_packData:function(){var _1163={name:this.hostObj.getValue("name")};var desc=this.hostObj.getValue("description");if(desc!=null){_1163["description"]=desc;}return this._packDataList({name:"netinfos",otherData:_1163,packFn:dojo.hitch(this,"_extractSaveData")});},_extractSaveData:function(i){var r={};dojo.forEach(["name","dladdr","nwaddr","dpid","port","is_router","is_gateway"],function(a){var d=this.getValue(i,a);if(d!=null&&d!=""){r[a]=d;}},this);return r;}});dojo.extend(nox.ext.apps.commonui.directory.HostBindingStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.SwitchPort"]){dojo._hasResource["nox.ext.apps.commonui.directory.SwitchPort"]=true;dojo.provide("nox.ext.apps.commonui.directory.SwitchPort");dojo.declare("nox.ext.apps.commonui.directory.SwitchPort",[nox.ext.apps.commonui.coreui._NamedEntity],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){if(this.switchObj==undefined){throw new Error("SwitchPort must be initialized with the associated switch object");}dojo.mixin(this.derivedAttributes,{uiMonitorPath:{get:dojo.hitch(this,"uiMonitorPath"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorLink:{get:dojo.hitch(this,"uiMonitorLink"),hasChanged:dojo.hitch(this,"nameHasChanged")},uiMonitorLinkText:{get:dojo.hitch(this,"uiMonitorLinkText"),hasChanged:dojo.hitch(this,"nameHasChanged")},"uiSwitchAndPortMonitorLinks":{get:dojo.hitch(this,"uiSwitchAndPortMonitorLinks")},speed:{get:dojo.hitch(this,"speed")},port_no:{get:dojo.hitch(this,"port_no")},locationDirectoryName:{get:dojo.hitch(this,"locationDirectoryName"),set:dojo.hitch(this,"locationDirectoryNameSet"),hasChanged:dojo.hitch(this,"locationHasChanged")},locationPrincipalName:{get:dojo.hitch(this,"locationPrincipalName"),set:dojo.hitch(this,"locationPrincipalNameSet"),hasChanged:dojo.hitch(this,"locationHasChanged")}});dojo.mixin(this.updateTypes,{"stat":{load:dojo.hitch(this,"updateStat")},"config":{load:dojo.hitch(this,"updateConfig")}});},wsv1Path:function(){return this.switchObj.wsv1Path()+"/port/"+this._data.name;},uiMonitorPath:function(){return "/Monitors/Switches/SwitchPortInfo?switch="+encodeURIComponent(this.switchObj.getValue("name"))+"&port="+encodeURIComponent(this.getValue("name"));},uiMonitorLink:function(){var a=document.createElement("a");a.href=this.uiMonitorPath();a.appendChild(document.createTextNode(this._data.name));return a;},uiMonitorLinkText:function(){return "<a href='"+this.uiMonitorPath()+"'>"+this._data.name+"</a>";},uiSwitchAndPortMonitorLinks:function(){var s=document.createElement("span");s.appendChild(this.switchObj.uiMonitorLink());s.appendChild(document.createTextNode(":"));s.appendChild(this.uiMonitorLink());return s;},updateStat:function(kwarg){return this._xhrGetMixin("stat",this.wsv1Path()+"/stat");},updateConfig:function(kwarg){return this._xhrGetMixin("config",this.wsv1Path()+"/config");},userStore:function(kwarg){return new this.dmws.UserStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/user"}));},hostStore:function(kwarg){return new this.dmws.HostStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/host"}));},speed:function(){if(this._data.stat_speed==null){return this._data.config_speed;}return this._data.stat_speed;},port_no:function(){if(this._data.stat_port_no==null){return this._data.config_port_no;}return this._data.stat_port_no;},locationDirectoryName:function(){try{return this._data.location.split(";",2)[0];}catch(e){return null;}},locationDirectoryNameSet:function(v){var pname=this.locationPrincipalName();this.setValue("location",v+";"+pname);},locationPrincipalName:function(){try{return this._data.location.split(";",2)[1];}catch(e){return null;}},locationPrincipalNameSet:function(v){var dname=this.locationDirectoryName();this.setValue("location",dname+";"+v);},locationHasChanged:function(l){return dojo.some(l,"return item.attribute == 'location';");}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.SwitchPortStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.SwitchPortStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.SwitchPortStore");dojo.declare("nox.ext.apps.commonui.directory.SwitchPortStore",[nox.ext.apps.commonui.directory._PrincipalStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.SwitchPort;if(this.switchObj==undefined){throw new Error("SwitchPortStore must be initialized with the related switch object.");}this.itemParameters["switchObj"]=this.switchObj;if(this.url==null){this.url=this.switchObj.wsv1Path()+"/port";}}});dojo.extend(nox.ext.apps.commonui.directory.SwitchPortStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.SwitchStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.SwitchStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.SwitchStore");dojo.declare("nox.ext.apps.commonui.directory.SwitchStore",[nox.ext.apps.commonui.directory._PrincipalStore],{url:"",data:null,constructor:function(kwarg){this.itemConstructor=this.dmws.Switch;if(this.url==null){this.url="/ws.v1/switch";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.SwitchGroup"]){dojo._hasResource["nox.ext.apps.commonui.directory.SwitchGroup"]=true;dojo.provide("nox.ext.apps.commonui.directory.SwitchGroup");dojo.declare("nox.ext.apps.commonui.directory.SwitchGroup",[nox.ext.apps.commonui.directory._PrincipalGroup],{wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/group/switch/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.groupName());},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Groups/SwitchGroupInfo?name="+encodeURIComponent(this._data.name);},parentGroupStore:function(kwarg){return new this.dmws.SwitchGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/parent"}));},principalMemberStore:function(kwarg){return new this.dmws.SwitchStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/principal"}));},subgroupMemberStore:function(kwarg){return new this.dmws.SwitchGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/subgroup"}));}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.SwitchGroupStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.SwitchGroupStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.SwitchGroupStore");dojo.declare("nox.ext.apps.commonui.directory.SwitchGroupStore",[nox.ext.apps.commonui.directory._PrincipalGroupStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.SwitchGroup;if(this.url==null){this.url="/ws.v1/group/switch";}}});}if(!dojo._hasResource["dijit.form.SimpleTextarea"]){dojo._hasResource["dijit.form.SimpleTextarea"]=true;dojo.provide("dijit.form.SimpleTextarea");dojo.declare("dijit.form.SimpleTextarea",dijit.form.TextBox,{baseClass:"dijitTextArea",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{rows:"textbox",cols:"textbox"}),rows:"3",cols:"20",templatePath:null,templateString:"<textarea ${nameAttrSetting} dojoAttachPoint='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},filter:function(value){if(value){value=value.replace(/\r/g,"");}return this.inherited(arguments);},postCreate:function(){this.inherited(arguments);if(dojo.isIE&&this.cols){dojo.addClass(this.domNode,"dijitTextAreaCols");}},_previousValue:"",_onInput:function(e){if(this.maxLength){var _117d=parseInt(this.maxLength);var value=this.textbox.value.replace(/\r/g,"");var _117f=value.length-_117d;if(_117f>0){dojo.stopEvent(e);var _1180=this.textbox;if(_1180.selectionStart){var pos=_1180.selectionStart;var cr=0;if(dojo.isOpera){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=value.substring(0,pos-_117f-cr)+value.substring(pos-cr);_1180.setSelectionRange(pos-_117f,pos-_117f);}else{if(dojo.doc.selection){_1180.focus();var range=dojo.doc.selection.createRange();range.moveStart("character",-_117f);range.text="";range.select();}}}this._previousValue=this.textbox.value;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.Textarea"]){dojo._hasResource["dijit.form.Textarea"]=true;dojo.provide("dijit.form.Textarea");dojo.declare("dijit.form.Textarea",dijit.form.SimpleTextarea,{cols:"",_previousNewlines:0,_strictMode:(dojo.doc.compatMode!="BackCompat"),_getHeight:function(_1184){var newH=_1184.scrollHeight;if(dojo.isIE){newH+=_1184.offsetHeight-_1184.clientHeight-((dojo.isIE<8&&this._strictMode)?dojo._getPadBorderExtents(_1184).h:0);}else{if(dojo.isMoz){newH+=_1184.offsetHeight-_1184.clientHeight;}else{if(dojo.isWebKit&&!(dojo.isSafari<4)){newH+=dojo._getBorderExtents(_1184).h;}else{newH+=dojo._getPadBorderExtents(_1184).h;}}}return newH;},_estimateHeight:function(_1186){_1186.style.maxHeight="";_1186.style.height="auto";_1186.rows=(_1186.value.match(/\n/g)||[]).length+1;},_needsHelpShrinking:dojo.isMoz||dojo.isWebKit,_onInput:function(){this.inherited(arguments);if(this._busyResizing){return;}this._busyResizing=true;var _1187=this.textbox;if(_1187.scrollHeight){var newH=this._getHeight(_1187)+"px";if(_1187.style.height!=newH){_1187.style.maxHeight=_1187.style.height=newH;}if(this._needsHelpShrinking){if(this._setTimeoutHandle){clearTimeout(this._setTimeoutHandle);}this._setTimeoutHandle=setTimeout(dojo.hitch(this,"_shrink"),0);}}else{this._estimateHeight(_1187);}this._busyResizing=false;},_busyResizing:false,_shrink:function(){this._setTimeoutHandle=null;if(this._needsHelpShrinking&&!this._busyResizing){this._busyResizing=true;var _1189=this.textbox;var empty=false;if(_1189.value==""){_1189.value=" ";empty=true;}var _118b=_1189.scrollHeight;if(!_118b){this._estimateHeight(_1189);}else{var _118c=_1189.style.paddingBottom;var _118d=dojo._getPadExtents(_1189);_118d=_118d.h-_118d.t;_1189.style.paddingBottom=_118d+1+"px";var newH=this._getHeight(_1189)-1+"px";if(_1189.style.maxHeight!=newH){_1189.style.paddingBottom=_118d+_118b+"px";_1189.scrollTop=0;_1189.style.maxHeight=this._getHeight(_1189)-_118b+"px";}_1189.style.paddingBottom=_118c;}if(empty){_1189.value="";}this._busyResizing=false;}},resize:function(){this._onInput();},_setValueAttr:function(){this.inherited(arguments);this.resize();},postCreate:function(){this.inherited(arguments);dojo.style(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});this.connect(this.textbox,"onscroll",this._onInput);this.connect(this.textbox,"onresize",this._onInput);this.connect(this.textbox,"onfocus",this._onInput);setTimeout(dojo.hitch(this,"resize"),0);}});}if(!dojo._hasResource["nox.ext.apps.commonui.switch_approval.SwitchApprover"]){dojo._hasResource["nox.ext.apps.commonui.switch_approval.SwitchApprover"]=true;dojo.provide("nox.ext.apps.commonui.switch_approval.SwitchApprover");dmws=nox.ext.apps.commonui.directory;dojo.declare("nox.ext.apps.commonui.switch_approval.SwitchApprover",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"content\">\n  <div dojoType=\"dijit.Dialog\" dojoAttachPoint=\"main_dialog\" \n        title=\"Register Switch\">\n  <form dojoType=\"dijit.form.Form\">\n    <div dojoAttachPoint=\"register_msg\">  </div> \n    <table> \n    <tr> \n      <td> <b> Directory:</b>  </td> \n      <td>\n        <span dojoType=\"dijit.layout.ContentPane\" dojoAttachPoint=\"dir_div\"> \n        </span> \n  </td> \n</tr> \n    <tr> \n      <td> <b> Switch Name:</b> </td> \n      <td> <input type=\"text\" dojoType=\"dijit.form.TextBox\"\n            trim=\"true\" dojoAttachPoint=\"name\"/>\n      </td> \n    </tr> \n</table> \n    <div class=\"rule-buttons\">\n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"registerBtn\">Register</button>\n    <button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelBtn\">Cancel</button>\n    </div>\n  </form>\n</div> \n</div>\n",widgetsInTemplate:true,onComplete:null,load_new_switch_page:false,switch_obj:null,_set_widget_values:function(){var fp=this.switch_obj.get_fingerprint();if(fp==""){msg="Warning: No SSL fingerprint known for this switch. Register insecure switch?";}else{msg="Register switch with SSL fingerprint '"+fp+"' ?";}this.register_msg.innerHTML=msg;this.name.setValue(this.switch_obj.principalName());var dir=this.switch_obj.directoryName();if(dir!="discovered"){this.directory.setDisplayedValue(dir);}},_cancel:function(){this.main_dialog.hide();},_done:function(){if(!this.directory.validate()){this.directory._hasBeenBlurred=true;this.directory.focus();return;}this.main_dialog.hide();this.switch_name=this.name.getValue();this.switch_directory=this.directory.getValue();var _1191=dojo.hitch(this,function(){var _1192=this.switch_directory+";"+this.switch_name;var _1193=new dmws.Switch({initialData:{name:_1192}});var cb=dojo.hitch(this,function(sw){if(this.onComplete!=null){this.onComplete();}if(this.load_new_switch_page){document.location=sw.uiMonitorPath();}});_1193.set_approval(true,cb);});this.switch_obj.full_rename({directory:this.switch_directory,name:this.switch_name,onComplete:_1191});},startup:function(){this.inherited("startup",arguments);this.directory=new dijit.form.FilteringSelect({store:dmws.Directories.datastore,searchAttr:"name",query:{write_switch_enabled:true}});this.dir_div.domNode.appendChild(this.directory.domNode);this._set_widget_values();this.main_dialog.closeButtonNode.style.display="none";this.main_dialog.show();this.directory.focus();dojo.connect(this.registerBtn,"onClick",this,"_done");dojo.connect(this.cancelBtn,"onClick",this,"_cancel");}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.Switch"]){dojo._hasResource["nox.ext.apps.commonui.directory.Switch"]=true;dojo.provide("nox.ext.apps.commonui.directory.Switch");dojo.declare("nox.ext.apps.commonui.directory.Switch",[nox.ext.apps.commonui.directory._Principal],{constructor:function(kwarg){dojo.mixin(this.updateTypes,{"config":{load:dojo.hitch(this,"updateConfig")},"stat":{load:dojo.hitch(this,"updateStat")},"approval":{load:dojo.hitch(this,"updateApproval")},"info":{load:dojo.hitch(this,"updateInfo")},"desc":{load:dojo.hitch(this,"updateDesc")}});},wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/switch/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.principalName());},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Switches/SwitchInfo?name="+encodeURIComponent(this.getValue("name"));},updateInfo:function(){return this._xhrGetMixin("info",this.wsv1Path(),function(r){return {dpid:r.dpid};});},updateConfig:function(){return this._xhrGetMixin("config",this.wsv1Path()+"/config");},updateDesc:function(){return this._xhrGetMixin("desc",this.wsv1Path()+"/desc");},updateStat:function(){return this._xhrGetMixin("stat",this.wsv1Path()+"/stat");},updateApproval:function(){return this._xhrGetMixin("approval",this.wsv1Path()+"/approval");},portStore:function(kwarg){return new this.dmws.SwitchPortStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/port","switchObj":this}));},groupStore:function(kwarg){return new this.dmws.SwitchGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/group"}));},set_approval:function(_119a,_119b){var _119c=nox.ext.apps.commonui.coreui.getUpdateMgr();var path=this.wsv1Path()+"/approval?approved="+_119a;_119c.rawXhrPut({handleAs:"json",url:path,headers:{"content-type":"application/json"},putData:{},timeout:5000,load:dojo.hitch(this,function(_119e,_119f){nox.ext.apps.commonui.coreui.getUpdateMgr().updateNow();if(_119b!=null){_119b(this);}return null;})});},is_registered:function(){var _11a0=false;if(this._data.fp_credentials){dojo.forEach(this._data.fp_credentials,function(cred){if(cred.is_approved){_11a0=true;}});}return _11a0;},get_fingerprint:function(){if(this._data.fp_credentials&&this._data.fp_credentials.length>0){return this._data.fp_credentials[0].fingerprint;}return "";}});dojo.declare("nox.ext.apps.commonui.directory.SwitchUtil",[],{register_switch:function(_11a2,_11a3){if(_11a2.length==0){coreui.UpdateErrorHandler.showError("Must select a switch to register.",{hide_retry:true,header_msg:"Invalid Operation:",validation_error:true});return;}if(_11a2.length>1){coreui.UpdateErrorHandler.showError("Cannot register multiple switches simultaneously.",{hide_retry:true,header_msg:"Invalid Operation:",validation_error:true});return;}var item=_11a2[0];item.update({onComplete:dojo.hitch(this,function(){this.show_switch_reg_dialog(item,{load_new_switch_page:false,onComplete:_11a3});})});},show_switch_reg_dialog:function(_11a5,props){if(_11a5.is_registered()){coreui.UpdateErrorHandler.showError("You must deregister the switch, then register it again.",{hide_retry:true,header_msg:"Switch Already Registered:",validation_error:true});return;}var appr=dijit.byId("approve_id");if(appr){appr.destroy();}if(props==null){props={};}props.id="approve_id";props.switch_obj=_11a5;appr=new nox.ext.apps.commonui.switch_approval.SwitchApprover(props);dojo.body().appendChild(appr.domNode);appr.startup();},get_status_cell:function(){var _11a8={name:"status",header:"Status",get:function(item){var s=document.createElement("span");var txt=item.getValue("status");s.className="errormsg";if(txt!="inactive"){s.className="successmsg";}s.appendChild(document.createTextNode(txt));return s;}};return _11a8;}});(function(){var _11ac=null;nox.ext.apps.commonui.directory.getSwitchUtil=function(){if(_11ac==null){_11ac=new nox.ext.apps.commonui.directory.SwitchUtil();}return _11ac;};})();}if(!dojo._hasResource["nox.ext.apps.commonui.directory.LocationStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.LocationStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.LocationStore");dojo.declare("nox.ext.apps.commonui.directory.LocationStore",[nox.ext.apps.commonui.directory._PrincipalStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.Location;if(this.url==null){this.url="/ws.v1/location";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.LocationGroup"]){dojo._hasResource["nox.ext.apps.commonui.directory.LocationGroup"]=true;dojo.provide("nox.ext.apps.commonui.directory.LocationGroup");dojo.declare("nox.ext.apps.commonui.directory.LocationGroup",[nox.ext.apps.commonui.directory._PrincipalGroup],{wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/group/location/"+encodeURIComponent(this.getValue("directoryName"))+"/"+encodeURIComponent(this.getValue("groupName"));},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Groups/LocationGroupInfo?name="+encodeURIComponent(this._data.name);},parentGroupStore:function(kwarg){return new this.dmws.LocationGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/parent"}));},principalMemberStore:function(kwarg){return new this.dmws.LocationStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/principal"}));},subgroupMemberStore:function(kwarg){return new this.dmws.LocationGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/subgroup"}));}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.LocationGroupStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.LocationGroupStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.LocationGroupStore");dojo.declare("nox.ext.apps.commonui.directory.LocationGroupStore",[nox.ext.apps.commonui.directory._PrincipalGroupStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.LocationGroup;if(this.url==null){this.url="/ws.v1/group/location";}}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.Location"]){dojo._hasResource["nox.ext.apps.commonui.directory.Location"]=true;dojo.provide("nox.ext.apps.commonui.directory.Location");dojo.declare("nox.ext.apps.commonui.directory.Location",[nox.ext.apps.commonui.directory._Principal],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){if(this.switchObj==undefined){this.switchObj=null;}if(this.switchPortObj==undefined){this.switchPortObj=null;}dojo.mixin(this.derivedAttributes,{"uiSwitchMonitorLink":{get:dojo.hitch(this,"uiSwitchMonitorLink"),hasChanged:dojo.hitch(this,"basicDataChanged",["switch_name"])},"uiSwitchMonitorLinkText":{get:dojo.hitch(this,"uiSwitchMonitorLinkText"),hasChanged:dojo.hitch(this,"basicDataChanged",["switch_name"])},"uiSwitchPortMonitorLink":{get:dojo.hitch(this,"uiSwitchPortMonitorLink"),hasChanged:dojo.hitch(this,"basicDataChanged",["switch_name","port_name"])},"uiSwitchPortMonitorLinkText":{get:dojo.hitch(this,"uiSwitchPortMonitorLinkText"),hasChanged:dojo.hitch(this,"basicDataChanged",["switch_name","port_name"])}});dojo.mixin(this.updateTypes,{"info":{load:dojo.hitch(this,"updateInfo")},"config":{load:dojo.hitch(this,"updateConfig")}});},wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/location/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.principalName());},uiMonitorPath:function(){if(this.isNull()){return null;}if(this.switchPortObj==null){return null;}return this.switchPortObj.uiMonitorPath();},uiSwitchMonitorLink:function(){if(this.switchObj==null){return null;}return this.switchObj.uiMonitorLink();},uiSwitchMonitorLinkText:function(){if(this.switchObj==null){return null;}return this.switchObj.uiMonitorLinkText();},uiSwitchPortMonitorLink:function(){if(this.switchPortObj==null){return null;}return this.switchPortObj.uiMonitorLink();},uiSwitchPortMonitorLinkText:function(){if(this.switchPortObj==null){return null;}return this.switchPortObj.uiMonitorLinkText();},updateConfig:function(){return this._xhrGetMixin("config",this.wsv1Path()+"/config",function(r){this.switchObj=new this.dmws.Switch({initialData:{name:r.switch_name}});this.switchPortObj=new this.dmws.SwitchPort({initialData:{name:r.port_name},switchObj:this.switchObj});return r;});},updateInfo:function(){return this._xhrGetMixin("info",this.wsv1Path());},hostStore:function(kwarg){return new this.dmws.HostStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/host","locationObj":this}));},userStore:function(kwarg){return new this.dmws.UserStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/user","locationObj":this}));},groupStore:function(kwarg){return new this.dmws.LocationGroupStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/group","locationObj":this}));}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostInterface"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostInterface"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostInterface");dojo.declare("nox.ext.apps.commonui.directory.HostInterface",[nox.ext.apps.commonui.coreui._NamedEntity],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){this.itemConstructor=this.dmws.HostInterface;if(this.hostObj==undefined){throw new Error("HostInterface must be initialized with the associated host object");}dojo.mixin(this.derivedAttributes,{uiLocationMonitorLink:{get:dojo.hitch(this,"uiLocationMonitorLink")},uiLocationMonitorLinkText:{get:dojo.hitch(this,"uiLocationMonitorLinkText")},uiSwitchMonitorLink:{get:dojo.hitch(this,"uiSwitchMonitorLink")},uiSwitchPortMonitorLink:{get:dojo.hitch(this,"uiSwitchPortMonitorLink")},uiSwitchAndPortMonitorLinks:{get:dojo.hitch(this,"uiSwitchAndPortMonitorLinks")}});dojo.mixin(this.updateTypes,{"info":{load:dojo.hitch(this,"updateInfo")}});},wsv1Path:function(){return this.hostObj.wsv1Path()+"/interface/"+this._data.name;},uiMonitorPath:function(){return "/Monitors/Hosts/HostInfo?name="+encodeURIComponent(this.hostObj.getValue("name"))+"&interface="+encodeURIComponent(this._data.name);},uiLocationMonitorLink:function(){if(this.location==null){return null;}else{return this.location.uiMonitorLink();}},uiLocationMonitorLinkText:function(){if(this.location==null){return null;}else{return this.location.uiMonitorLinkText();}},uiSwitchMonitorLink:function(){if(this.switchObj==null){return null;}return this.switchObj.uiMonitorLink();},uiSwitchPortMonitorLink:function(){if(this.switchPortObj==null){return null;}return this.switchPortObj.uiMonitorLink();},uiSwitchAndPortMonitorLinks:function(){if(this.switchPortObj==null){return null;}else{return this.switchPortObj.uiSwitchAndPortMonitorLinks();}},updateInfo:function(kwarg){return this._xhrGetMixin("info",this.wsv1Path(),function(_11b9){if(_11b9["switch_name"]){this.switchObj=new nox.ext.apps.commonui.directory.Switch({initialData:{name:_11b9["switch_name"]}});if(_11b9["port_name"]){this.switchPortObj=new nox.ext.apps.commonui.directory.SwitchPort({switchObj:this.switchObj,initialData:{name:_11b9["port_name"]}});if(_11b9["location_name"]){this.location=new nox.ext.apps.commonui.directory.Location({initialData:{name:_11b9["location_name"]},updateList:["config"],switchObj:this.switchObj,switchPortObj:this.switchPortObj});}}}if(_11b9.gateway){_11b9.intftype="Gateway";}else{if(_11b9.router){_11b9.intftype="Router";}else{_11b9.intftype="End-Host";}}return _11b9;});}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.HostInterfaceStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.HostInterfaceStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.HostInterfaceStore");dojo.declare("nox.ext.apps.commonui.directory.HostInterfaceStore",[nox.ext.apps.commonui.coreui._UpdatingStore],{dmws:nox.ext.apps.commonui.directory,constructor:function(kwarg){this.itemConstructor=this.dmws.HostInterface;if(this.hostObj==undefined){throw new Error("HostInterfaceStore must be initialized with host object.");}this.itemParameters["hostObj"]=this.hostObj;if(this.url==null){this.url=this.hostObj.wsv1Path()+"active/interface";}},_unpackData:function(r){return dojo.map(r,"return { name: item };");}});dojo.extend(nox.ext.apps.commonui.directory.HostInterfaceStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.directory.Host"]){dojo._hasResource["nox.ext.apps.commonui.directory.Host"]=true;dojo.provide("nox.ext.apps.commonui.directory.Host");dojo.declare("nox.ext.apps.commonui.directory.Host",[nox.ext.apps.commonui.directory._Principal],{constructor:function(kwarg){dojo.mixin(this.updateTypes,{"info":{load:dojo.hitch(this,"updateInfo")},"osFingerprint":{load:dojo.hitch(this,"updateOSFingerprint")},"lastSeen":{load:dojo.hitch(this,"updateLastSeen")},"activeInterfaces":{load:dojo.hitch(this,"updateActiveInterfaces")}});},wsv1Path:function(){if(this.isNull()){return null;}return "/ws.v1/host/"+encodeURIComponent(this.directoryName())+"/"+encodeURIComponent(this.principalName());},uiMonitorPath:function(){if(this.isNull()){return null;}return "/Monitors/Hosts/HostInfo?name="+encodeURIComponent(this._data.name);},updateInfo:function(kwarg){return this._xhrGetMixin("info",this.wsv1Path());},updateOSFingerprint:function(){return this._xhrGetMixin("osFingerprint",this.wsv1Path()+"/os_fingerprint");},updateLastSeen:function(){return this._xhrGetMixin("lastSeen",this.wsv1Path()+"/last_seen");},updateActiveInterfaces:function(){if(this.activeInterfacesStore==null){this.activeInterfacesStore=this.interfaceStore({hostObj:this,itemParameters:{updateList:["info"]}});}return this._storeQueryMixin("updateActiveInterfaces","active_interfaces",this.activeInterfacesStore,{},null);},groupStore:function(kwarg){return new this.dmws.HostGroupStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/group"}));},userStore:function(kwarg){return new this.dmws.UserStore(dojo.mixin(kwarg,{url:this.wsv1Path()+"/active/user"}));},bindingStore:function(kwarg){return new this.dmws.HostBindingStore(dojo.mixin(kwarg,{"url":this.wsv1Path(),"hostObj":this}));},interfaceStore:function(kwarg){return new this.dmws.HostInterfaceStore(dojo.mixin(kwarg,{"url":this.wsv1Path()+"/active/interface","hostObj":this}));},save:function(){var bs=this.bindingStore({});bs.update({onComplete:function(){bs.save();bs.destroy();}});}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.NWAddr"]){dojo._hasResource["nox.ext.apps.commonui.directory.NWAddr"]=true;dojo.provide("nox.ext.apps.commonui.directory.NWAddr");dojo.declare("nox.ext.apps.commonui.directory.NWAddr",[nox.ext.apps.commonui.coreui._UpdatingItem],{identityAttributes:["ip_str"],labelAttributes:["ip_str"],constructor:function(data){},isValid:function(){return true;}});}if(!dojo._hasResource["nox.ext.apps.commonui.directory.NWAddrStore"]){dojo._hasResource["nox.ext.apps.commonui.directory.NWAddrStore"]=true;dojo.provide("nox.ext.apps.commonui.directory.NWAddrStore");dojo.declare("nox.ext.apps.commonui.directory.NWAddrStore",[nox.ext.apps.commonui.directory._PrincipalStore],{constructor:function(kwarg){this.itemConstructor=this.dmws.NWAddr;},_unpackData:function(_11c5){var arr=[];dojo.forEach(_11c5,function(i){arr.push({"ip_str":i});});return arr;}});dojo.extend(nox.ext.apps.commonui.directory.NWAddrStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEventsFormatter"]){dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEventsFormatter"]=true;dojo.provide("nox.ext.apps.commonui.networkevents.NetEventsFormatter");(function(){var nef=nox.ext.apps.commonui.networkevents.NetEventsFormatter;var dmws=nox.ext.apps.commonui.directory;var _11ca={"switch":dmws.Switch,"location":null,"host":dmws.Host,"user":dmws.User,"switch group":dmws.SwitchGroup,"location group":dmws.LocationGroup,"host group":dmws.HostGroup,"user group":dmws.UserGroup};function _11cb(_11cc,name){if(name=="<unknown>"){return "unknown "+_11cc;}return _11cc+" "+_11ce(_11cc,name);};function _11cf(_11d0,_11d1){var _11d2=0;var l=[];dojo.forEach(_11d1,function(n){if(n=="<unknown>"){l.push("unknown"+_11d2++);}else{l.push(_11ce(_11d0,n));}});if(_11d0=="switch"){return _11d0+"es "+l.join(", ");}else{return _11d0+"s "+l.join(", ");}};function _11ce(_11d5,_11d6){var _11d7=null;var c=_11ca[_11d5];if(_11d5=="location"){return _11d9(_11d6);}else{if(c){var o=new c({initialData:{name:_11d6}});return o.uiMonitorLinkText(true);}else{console_log("unknown principal type '"+_11d5+" for name '"+_11d6+"' in get_link");return _11d6;}}};function _11db(s){return s.replace(/\\\\/g,"\\");};function _11d9(_11dd){var _11de=_11df(_11dd);return "<a href='/Monitors/Switches/SwitchPortInfo?switch="+encodeURIComponent(_11de[1])+"&port="+encodeURIComponent(_11de[2])+"'>"+_11de[0]+"</a>";};function _11df(_11e0){var _11e1=_11e0.split(/(\\*)#/);var _11e2=[];_11e2.push(_11db(_11e1[0]));for(var i=1;i<_11e1.length;i+=2){var sep=_11e1[i];var len=_11e1[i].length;if(len>0){_11e2.push(_11e2.pop()+_11db(sep.substring(0,len-1)));}if(len&1==1){_11e2.push(_11e2.pop()+"#"+_11db(_11e1[i+1]));}else{_11e2.push(_11db(_11e1[i+1]));}}return _11e2;};function _11e6(match,type,value){var _11ea=["user","host","location","switch","user group","host group","location group","switch group"];var _11eb=dojo.map(_11ea,function(t){return t+"s";});if(type=="switches"){return _11cf("switch",value.split(","));}else{if(dojo.indexOf(_11ea,type)!=-1){return _11cb(type,value);}else{if(dojo.indexOf(_11eb,type)!=-1){var _11ed=type.substring(0,type.length-1);return _11cf(_11ed,value.split(","));}else{return match;}}}};nef.format_msg=function(m){return m.replace(/{([^\|]*)\|([^}]*)}/g,_11e6);};})();}if(!dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEvents"]){dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEvents"]=true;dojo.provide("nox.ext.apps.commonui.networkevents.NetEvents");dojo.declare("nox.ext.apps.commonui.networkevents.NetEventsTable",[],{_new_item:function(item){if(this.table_elem.rows.length>=this.max_size){this.table_elem.deleteRow(-1);}this.highest_logid=item.logid;var row=this.table_elem.insertRow(0);var dt=new Date(item.timestamp*1000);row.innerHTML="<td class='priority msg-level-"+item.level+"'>"+item.level+"</td><td class='timestamp msg-level-"+item.level+"'>"+dt.toLocaleString()+"</td><td class='msg msg-level-"+item.level+"'>"+nox.ext.apps.commonui.networkevents.NetEventsFormatter.format_msg(item.msg)+"</td>";},_get_error:function(error,_11f3){console_log("Error retrieving netevents");},constructor:function(_11f4,_11f5,_11f6){this.table_elem=_11f4;this.max_size=_11f5;this.filter_str=_11f6;this.highest_logid=0;var _11f7=nox.ext.apps.commonui.coreui;_11f7.getUpdateMgr().suspendDuringMousemoveOn(this.table_elem);var _11f8=function(){return "/ws.v1/networkevents?end="+this.max_size+"&after="+this.highest_logid+"&"+this.filter_str;};_11f7.getUpdateMgr().xhrGet({url_fn:dojo.hitch(this,_11f8),load:dojo.hitch(this,function(_11f9,_11fa){for(var i=0;i<_11f9.items.length;i++){this._new_item(_11f9.items[i]);}}),sort:[{attribute:"logid",descending:false}],timeout:30000,handleAs:"json",recur:true,error:this._get_error});}});}if(!dojo._hasResource["nox.ext.apps.commonui.coreui.noxcore"]){dojo._hasResource["nox.ext.apps.commonui.coreui.noxcore"]=true;dojo.provide("nox.ext.apps.commonui.coreui.noxcore");}dojo.i18n._preloadLocalizations("nox.ext.apps.commonui.coreui.nls.noxcore",["ROOT","ar","ca","cs","da","de","de-de","el","en","en-gb","en-us","es","es-es","fi","fi-fi","fr","fr-fr","he","he-il","hu","it","it-it","ja","ja-jp","ko","ko-kr","nb","nl","nl-nl","pl","pt","pt-br","pt-pt","ru","sk","sl","sv","th","tr","xx","zh","zh-cn","zh-tw"]);
