/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEvents"]){dojo._hasResource["nox.ext.apps.commonui.networkevents.NetEvents"]=true;dojo.provide("nox.ext.apps.commonui.networkevents.NetEvents");dojo.require("nox.ext.apps.commonui.coreui.UpdateMgr");dojo.require("nox.ext.apps.commonui.networkevents.NetEventsFormatter");dojo.declare("nox.ext.apps.commonui.networkevents.NetEventsTable",[],{_new_item:function(_1){if(this.table_elem.rows.length>=this.max_size){this.table_elem.deleteRow(-1);}this.highest_logid=_1.logid;var _2=this.table_elem.insertRow(0);var dt=new Date(_1.timestamp*1000);_2.innerHTML="<td class='priority msg-level-"+_1.level+"'>"+_1.level+"</td><td class='timestamp msg-level-"+_1.level+"'>"+dt.toLocaleString()+"</td><td class='msg msg-level-"+_1.level+"'>"+nox.ext.apps.commonui.networkevents.NetEventsFormatter.format_msg(_1.msg)+"</td>";},_get_error:function(_4,_5){console_log("Error retrieving netevents");},constructor:function(_6,_7,_8){this.table_elem=_6;this.max_size=_7;this.filter_str=_8;this.highest_logid=0;var _9=nox.ext.apps.commonui.coreui;_9.getUpdateMgr().suspendDuringMousemoveOn(this.table_elem);var _a=function(){return "/ws.v1/networkevents?end="+this.max_size+"&after="+this.highest_logid+"&"+this.filter_str;};_9.getUpdateMgr().xhrGet({url_fn:dojo.hitch(this,_a),load:dojo.hitch(this,function(_b,_c){for(var i=0;i<_b.items.length;i++){this._new_item(_b.items[i]);}}),sort:[{attribute:"logid",descending:false}],timeout:30000,handleAs:"json",recur:true,error:this._get_error});}});}