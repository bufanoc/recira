/* Copyright (c) 2008, 2009, 2010 Nicira, Inc. */

if(!dojo._hasResource["nox.ext.apps.vmanui.role_config_layer"]){dojo._hasResource["nox.ext.apps.vmanui.role_config_layer"]=true;dojo.provide("nox.ext.apps.vmanui.role_config_layer");dojo.require("dijit._Widget");dojo.require("dojox.dtl._Templated");dojo.require("dijit.form.CheckBox");dojo.declare("nox.ext.apps.vmanui.role_config_layer",[dijit._Widget,dojox.dtl._Templated],{widgetsInTemplate:true,policy_manager:null,role_index:null,is_bottom:false,is_readonly:false,parent_layer:null,use_strikethrough:false,child_widgets:null,get_role:function(){return this.policy_manager.getRole(this.role_uid);},get_role_name:function(_1){var _2=this.role.name;if(_1){_2=_2.replace(/&/g,"&amp;");_2=_2.replace(/</g,"&lt;");_2=_2.replace(/>/g,"&gt;");}return _2;},isConfigSet:function(){return false;},_postMixInSetup:function(){},postMixInProperties:function(){while(this.role_index<this.policy_manager.role_stack.length){var _3=this.policy_manager.role_stack[this.role_index];if(dojo.isArray(_3)){if(_3.length===0){this.role_index++;continue;}this.role_uid=_3[0].uid;}else{this.role_uid=_3.uid;}break;}this.role=this.get_role();var _4=this.policy_manager.role_stack.length-1;this.is_bottom=this.role_index==_4;this.is_global=this.parent_layer===null;this._postMixInSetup();},postCreate:function(){this.child_widgets=[];var _5=this.policy_manager.role_stack[this.role_index];if(dojo.isArray(_5)&&_5.length>1){dojo.style(this.view_others,{"display":"inline"});this.view_others.innerHTML="Change Network";var _6=nox.ext.apps.vmanui.menu_creator.creator;var m=_6.create_changevisibleuid_menu(this.view_others,_5,this.policy_manager,dojo.hitch(this,this.changeVisibleUid));this.child_widgets.push(m);}if(this.off_block&&this.parent_layer===null){dojo.style(this.off_block,"display","none");}this._postCreateSetup();},uninitialize:function(){this.inherited(arguments);if(this.child){this.child.destroyRecursive();}if(this.child_widgets){dojo.forEach(this.child_widgets,function(w){w.destroyRecursive();});}},updateAllStrikeThrough:function(){var b=this.getBottomLayer();var _a=!(b.inherit.getValue());var p=b.parent_layer;while(p!==null){p.use_strikethrough=_a;p.updateStrikeThrough();_a=_a||p.isConfigSet();p=p.parent_layer;}},updateStrikeThrough:function(){if(this.use_strikethrough){dojo.addClass(this.text_desc,"invalidatedPortConfig");}else{dojo.removeClass(this.text_desc,"invalidatedPortConfig");}},changeVisibleUid:function(_c){},inputIsValid:function(){return true;},recursiveInputIsValid:function(){if(this.is_bottom){return this.inputIsValid();}else{return this.child.recursiveInputIsValid();}},getBottomLayer:function(){if(this.is_bottom){return this;}else{return this.child.getBottomLayer();}},onIsValidChange:function(_d){if(this.parent_layer!==null){this.parent_layer.onIsValidChange(_d);}}});}